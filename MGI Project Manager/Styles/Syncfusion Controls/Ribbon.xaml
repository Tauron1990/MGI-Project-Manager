<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"  
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=PresentationFramework"
                    xmlns:tools_controls="clr-namespace:Syncfusion.Windows.Tools.Controls;assembly=Syncfusion.Tools.WPF"
                    xmlns:Microsoft_Windows_Luna="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Luna"
                    xmlns:shared="clr-namespace:Syncfusion.Windows.Shared;assembly=Syncfusion.Shared.WPF"
                    xmlns:shared_windows="clr-namespace:Syncfusion.Windows;assembly=Syncfusion.Shared.Wpf"
                    xmlns:tools_resources="clr-namespace:Syncfusion.Windows.Tools.Controls.Resources;assembly=Syncfusion.Tools.WPF"
                    xmlns:Microsoft_Windows_Aero="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero">
<ResourceDictionary.MergedDictionaries>

</ResourceDictionary.MergedDictionaries>

<LinearGradientBrush x:Key="BackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FFEEEEF2" Offset="0" /><GradientStop Color="#FFEEEEF2" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="BorderBrush" Color="#FFCCCEDB" />
	<SolidColorBrush x:Key="ForegroundBrush" Color="#FF404040" />
	<SolidColorBrush x:Key="GlyphBrush" Color="#FF404040" />
<LinearGradientBrush x:Key="HeaderBackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FFEEEEF2" Offset="0" /><GradientStop Color="#FFEEEEF2" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="HeaderBorderBrush" Color="#FFCCCEDB" />
	<SolidColorBrush x:Key="HeaderForegroundBrush" Color="#FF404040" />
	<SolidColorBrush x:Key="HeaderGlyphBrush" Color="#FF404040" />
<LinearGradientBrush x:Key="HoverBackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FF7FBCE5" Offset="0" /><GradientStop Color="#FF7FBCE5" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="HoverBorderBrush" Color="#FF7FBCE5" />
	<SolidColorBrush x:Key="HoverForegroundBrush" Color="#FF404040" />
	<SolidColorBrush x:Key="HoverGlyphBrush" Color="#FF404040" />
<LinearGradientBrush x:Key="ActiveBackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FF007ACC" Offset="0" /><GradientStop Color="#FF007ACC" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="ActiveBorderBrush" Color="#FF007ACC" />
	<SolidColorBrush x:Key="ActiveForegroundBrush" Color="#FFFFFFFF" />
	<SolidColorBrush x:Key="ActiveGlyphBrush" Color="#FFFFFFFF" />
	<SolidColorBrush x:Key="ContentBackgroundBrush" Color="#FFF5F5F5" />
	<SolidColorBrush x:Key="ContentBorderBrush" Color="#FFCCCEDB" />
	<SolidColorBrush x:Key="ContentForegroundBrush" Color="#FF1E1E1E" />
	<SolidColorBrush x:Key="ContentSelectionBrush" Color="#FFA5A5A5" />
	<SolidColorBrush x:Key="SelectionInActiveBrush" Color="#FF99C9EA" />
	<SolidColorBrush x:Key="ErrorBrush" Color="#FFFF0000" />
	<SolidColorBrush x:Key="ActiveLightBackground" Color="#FF99C9EA" />
	<SolidColorBrush x:Key="ActiveDarkBackground" Color="#FF003D66" />
	<SolidColorBrush x:Key="ContentAlternativeBackground" Color="#FFDCDCDC" />
	<SolidColorBrush x:Key="TickColor" Color="#FFBCBCBC" />
	<SolidColorBrush x:Key="RangeColor1" Color="#FF61A301" />	
	<SolidColorBrush x:Key="RangeColor2" Color="#FFF2E606" />	
	<SolidColorBrush x:Key="RangeColor3" Color="#FFFF0000" />
	<SolidColorBrush x:Key="LightBackgroundBrush" Color="#FFDDDDE5" />


    <tools_resources:ResourceWrapper x:Key="ResourceWrapperKey" />
    <tools_controls:ColorToTransparentBrushConverter x:Key="colorToTransparentBrushConverter" />
    <tools_controls:ColorToBrushConverter x:Key="colorToBrushConverter" />
    <tools_controls:CorrectingBrushConverter x:Key="correctingBrushConverter" />
    <tools_controls:DoubleToGridLengthConverter x:Key="DoubleToGridLengthConverter" />
    <tools_controls:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />
    <tools_controls:TextWrappingConverter x:Key="TextWrappingConverter" />
    <tools_controls:GalleryFilterConverter x:Key="GalleryFilterConverter" />
    <shared:DisableEffect x:Key="DisableEffect" />
    <tools_controls:FilterToRibbonButtonConverter x:Key="FilterToRibbonButtonConverter" />
    <tools_controls:SizeToDoubleConverter x:Key="SizeToDoubleConverter" />

    <tools_controls:BooleanToVisibilitySeperatorConverter x:Key="BoolInvertConverter" />
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />


    <Geometry x:Key="Office2013RibbonTabArrowPath">M 0 0 L 4 4 L 8 0 Z</Geometry>
    <Geometry x:Key="Office2013DropDownPath">M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z</Geometry>
    <Path x:Key="Path1"
          Data="{StaticResource Office2013DropDownPath}"
          Fill="{StaticResource GlyphBrush}" />
   
    <!--  ScrollBar Brushes  -->


   

	<Thickness x:Key="MenuItemBorderThickness">1</Thickness>
	
    <Style x:Key="ScrollBarDownButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Background" Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Border Name="PART_Repeat"
                            Width="15"
                            Height="15"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Path Name="Arrow"
                              Width="7"
                              Height="4"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="M0,0L3.5,4 7,0z"
                              Fill="{StaticResource GlyphBrush}"
                              Stretch="Fill"
                              Stroke="{StaticResource GlyphBrush}"
                              StrokeThickness="1" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
                            <Setter Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
							<Setter Property="Fill" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="{StaticResource ActiveBackgroundBrush}" />
                            <Setter Property="BorderBrush" Value="{StaticResource ActiveBorderBrush}" />
							 <Setter Property="Fill" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6" />
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScrollBarLeftButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Background" Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Border Name="PART_Repeat"
                            Height="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Path Name="Arrow"
                              Width="4"
                              Height="7"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data=" M 7 1 L 3 5 L 7 9 z"
                              Fill="{StaticResource GlyphBrush}"
                              Stretch="Fill"
                              Stroke="{StaticResource GlyphBrush}"
                              StrokeThickness="1" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                            <Setter Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
							<Setter Property="Fill" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="{StaticResource ActiveBackgroundBrush}" />
                            <Setter Property="BorderBrush" Value="{StaticResource ActiveBorderBrush}" />
							 <Setter Property="Fill" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
                        </Trigger>


                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScrollBarRightButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Background" Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">

                    <Border Name="PART_Repeat"
                            Height="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Path Name="Arrow"
                              Width="4"
                              Height="7"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="M 3 1 L 7 5 L 3 9 z"
                              Fill="{StaticResource GlyphBrush}"
                              Stretch="Fill"
                              Stroke="{StaticResource GlyphBrush}"
                              StrokeThickness="1" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                            <Setter Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
							<Setter Property="Fill" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="{StaticResource ActiveBackgroundBrush}" />
                            <Setter Property="BorderBrush" Value="{StaticResource ActiveBorderBrush}" />
							<Setter Property="Fill" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
                        </Trigger>


                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScrollBarUpButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Background" Value="{StaticResource BackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />

        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Border Name="PART_Repeat"
                            Width="15"
                            Height="15"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Path Name="Arrow"
                              Width="7"
                              Height="4"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="M0,4 L7,4 3.5,0z"
                              Fill="{StaticResource GlyphBrush}"
                              SnapsToDevicePixels="True"
                              Stretch="Fill"
                              Stroke="{StaticResource GlyphBrush}"
                              StrokeThickness="1" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                            <Setter Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
							<Setter Property="Fill" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="{StaticResource ActiveBackgroundBrush}" />
                            <Setter Property="BorderBrush" Value="{StaticResource ActiveBorderBrush}" />
							<Setter Property="Fill" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />
							 <Setter Property="Stroke" TargetName="Arrow" Value="{StaticResource ActiveGlyphBrush}" />

                        </Trigger>


                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.6" />
                        </Trigger>

                    </ControlTemplate.Triggers>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScrollBarVerticalThumb" TargetType="{x:Type Thumb}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Width" Value="15" />
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Grid>
                        <Border Name="PART_RepeatThumb"
                                Background="{DynamicResource BackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsDragging" Value="True">
                            <Setter TargetName="PART_RepeatThumb" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
                            <Setter TargetName="PART_RepeatThumb" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_RepeatThumb" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
							<Setter TargetName="PART_RepeatThumb" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                        </Trigger>
						<MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsDragging" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_RepeatThumb" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
                            <Setter TargetName="PART_RepeatThumb" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScrollBarHorizontalThumb" TargetType="{x:Type Thumb}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="Height" Value="15" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Grid>
                        <Border Name="PART_RepeatThumb"
                                Background="{DynamicResource BackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="0" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsDragging" Value="True">
                            <Setter TargetName="PART_RepeatThumb" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
                            <Setter TargetName="PART_RepeatThumb" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_RepeatThumb" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
							<Setter TargetName="PART_RepeatThumb" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                        </Trigger>
						<MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsDragging" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_RepeatThumb" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
                            <Setter TargetName="PART_RepeatThumb" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="HorizontalScrollBarPageButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Rectangle Width="{TemplateBinding Width}"
                               Height="{TemplateBinding Height}"
                               Fill="{TemplateBinding Background}" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="VerticalScrollBarPageButton" TargetType="{x:Type RepeatButton}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Rectangle Width="{TemplateBinding Width}"
                               Height="{TemplateBinding Height}"
                               Fill="{TemplateBinding Background}" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="Office2013ScrollBarStyle" TargetType="{x:Type ScrollBar}">
        <Setter Property="Background" Value="{StaticResource LightBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="Transparent" />

        <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false" />
        <Setter Property="Stylus.IsFlicksEnabled" Value="false" />
        <Setter Property="Width" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" />
        <Setter Property="MinWidth" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ScrollBar}">
                    <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,0,1,0">
                        <Grid Name="Bg"
                              Background="{TemplateBinding Background}"
                              SnapsToDevicePixels="true">
                            <Grid.RowDefinitions>
                                <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}" />
                                <RowDefinition Height="0.00001*" />
                                <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}" />
                            </Grid.RowDefinitions>
                            <RepeatButton Name="UpButton"
                                          Command="{x:Static ScrollBar.LineUpCommand}"
                                          Style="{StaticResource ScrollBarUpButton}" />
                            <Track Name="PART_Track"
                                   Grid.Row="1"
                                   IsDirectionReversed="true"
                                   IsEnabled="{TemplateBinding IsMouseOver}">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageUpCommand}" Style="{StaticResource VerticalScrollBarPageButton}" />
                                </Track.DecreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource ScrollBarVerticalThumb}" />
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageDownCommand}" Style="{StaticResource VerticalScrollBarPageButton}" />
                                </Track.IncreaseRepeatButton>
                            </Track>
                            <RepeatButton Name="DownButton"
                                          Grid.Row="2"
                                          Command="{x:Static ScrollBar.LineDownCommand}"
                                          Style="{StaticResource ScrollBarDownButton}" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="Bg" Property="Opacity" Value="0.7" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Orientation" Value="Horizontal">
                <Setter Property="Width" Value="Auto" />
                <Setter Property="MinWidth" Value="0" />
                <Setter Property="Height" Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}" />
                <Setter Property="MinHeight" Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}" />
                <Setter Property="Background" Value="{StaticResource LightBackgroundBrush}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ScrollBar}">
                            <Grid Name="Bg"
                                  Background="{TemplateBinding Background}"
                                  SnapsToDevicePixels="true">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}" />
                                    <ColumnDefinition Width="0.00001*" />
                                    <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}" />
                                </Grid.ColumnDefinitions>
                                <RepeatButton Name="LeftButton"
                                              Command="{x:Static ScrollBar.LineLeftCommand}"
                                              IsEnabled="{TemplateBinding IsMouseOver}"
                                              Style="{StaticResource ScrollBarLeftButton}" />
                                <Track Name="PART_Track"
                                       Grid.Column="1"
                                       IsEnabled="{TemplateBinding IsMouseOver}">
                                    <Track.DecreaseRepeatButton>
                                        <RepeatButton Command="{x:Static ScrollBar.PageLeftCommand}" Style="{StaticResource HorizontalScrollBarPageButton}" />
                                    </Track.DecreaseRepeatButton>
                                    <Track.IncreaseRepeatButton>
                                        <RepeatButton Command="{x:Static ScrollBar.PageRightCommand}" Style="{StaticResource HorizontalScrollBarPageButton}" />
                                    </Track.IncreaseRepeatButton>
                                    <Track.Thumb>
                                        <Thumb Style="{StaticResource ScrollBarHorizontalThumb}" />
                                    </Track.Thumb>
                                </Track>
                                <RepeatButton Name="RightButton"
                                              Grid.Column="2"
                                              Command="{x:Static ScrollBar.LineRightCommand}"
                                              IsEnabled="{TemplateBinding IsMouseOver}"
                                              Style="{StaticResource ScrollBarRightButton}" />
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter TargetName="Bg" Property="Opacity" Value="0.7" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013ScrollBarStyle}" TargetType="{x:Type ScrollBar}" />


    <Style x:Key="Office2013ScrollViewerStyle" TargetType="{x:Type ScrollViewer}">
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ScrollViewer}">
                    <Grid x:Name="Grid" Background="{TemplateBinding Background}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <Rectangle x:Name="Corner"
                                   Grid.Row="1"
                                   Grid.Column="1"
                                   Fill="{StaticResource ContentBackgroundBrush}" />
                        <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Margin="{TemplateBinding Padding}"
                                                CanContentScroll="{TemplateBinding CanContentScroll}"
                                                CanHorizontallyScroll="False"
                                                CanVerticallyScroll="False"
                                                Content="{TemplateBinding Content}"
                                                ContentTemplate="{TemplateBinding ContentTemplate}" />
                        <ScrollBar x:Name="PART_VerticalScrollBar"
                                   Grid.Row="0"
                                   Grid.Column="1"
                                   AutomationProperties.AutomationId="VerticalScrollBar"
                                   Cursor="Arrow"
                                   Maximum="{TemplateBinding ScrollableHeight}"
                                   Minimum="0"
                                   ViewportSize="{TemplateBinding ViewportHeight}"
                                   Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                   Value="{Binding Path=VerticalOffset,
                                                   Mode=OneWay,
                                                   RelativeSource={RelativeSource TemplatedParent}}" />
                        <ScrollBar x:Name="PART_HorizontalScrollBar"
                                   Grid.Row="1"
                                   Grid.Column="0"
                                   AutomationProperties.AutomationId="HorizontalScrollBar"
                                   Cursor="Arrow"
                                   Maximum="{TemplateBinding ScrollableWidth}"
                                   Minimum="0"
                                   Orientation="Horizontal"
                                   ViewportSize="{TemplateBinding ViewportWidth}"
                                   Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                   Value="{Binding Path=HorizontalOffset,
                                                   Mode=OneWay,
                                                   RelativeSource={RelativeSource TemplatedParent}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style BasedOn="{StaticResource Office2013ScrollViewerStyle}" TargetType="{x:Type ScrollViewer}" />

    
              

    <ContentControl x:Key="Path">
        <ContentControl.Style>
            <Style>
                <Setter Property="TextBlock.Foreground" Value="{StaticResource ContentForegroundBrush}" />
                <Setter Property="Control.OverridesDefaultStyle" Value="True" />
                <Setter Property="Control.HorizontalAlignment" Value="Center" />
                <Setter Property="Control.VerticalAlignment" Value="Top" />
                <Setter Property="Control.Height" Value="14" />
                <Setter Property="Control.Margin" Value="0,-1,0,0" />
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ContentControl">
                            <Border>
                                <Path Width="5"
                                      Height="3"
                                      Margin="0,4,0,0"
                                      HorizontalAlignment="Center"
                                      Data="{StaticResource Office2013DropDownPath}"
                                      Fill="{StaticResource GlyphBrush}"
                                      Stretch="Fill" />
                            </Border>

                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ContentControl.Style>
    </ContentControl>


    <Color x:Key="Blue.TapPanel.SeparatorColor"
           B="227"
           G="178"
           R="141" />

    <!--  ResizeGripper  -->
    <SolidColorBrush x:Key="Blue.ResizeGripperForegroundDark" Color="#455D80" />
    <SolidColorBrush x:Key="Blue.ResizeGripperForegroundLight" Color="#B1C9E8" />
    


    <!--  Ribbon Normal State Template  -->
    <ControlTemplate x:Key="Normal" TargetType="{x:Type tools_controls:Ribbon}">
        <AdornerDecorator Name="PART_AdornerDecorator"
                          Margin="0,-53,0,0"
                          Panel.ZIndex="100"
                          DockPanel.Dock="Top">
            <Border>
                <Grid ClipToBounds="True">
                    <Grid.RowDefinitions>
                        <RowDefinition >
                            <RowDefinition.Style>
                                <Style>
                                    <Setter Property="RowDefinition.Height" Value="53"/>
                                    <Style.Triggers>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter Property="RowDefinition.Height" Value="73"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </RowDefinition.Style>
                        </RowDefinition>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <DockPanel Grid.Row="0" Panel.ZIndex="200">
                        <tools_controls:RibbonWindowPanel x:Name="PART_RibbonWindowPanel"
                                                 Panel.ZIndex="100"
                                                 DockPanel.Dock="Top">
                            <Border x:Name="PART_TitleBorder"
                                    Width="{TemplateBinding ActualWidth}"
                                    Height="30"
                                    Margin="0,0,0,-20"
                                    Visibility="Collapsed" />
                            <ContentPresenter Focusable="False"  Content="{TemplateBinding BackStageButton}" />
                            <ContentPresenter 
                                              Margin="30,0,0,0"
                                              HorizontalAlignment="Center"
                                              Content="{TemplateBinding QuickAccessToolBar}"
                                              shared_windows:WindowChrome.IsHitTestVisibleInChrome="True" >
                                <ContentPresenter.Style>
                                    <Style>
                                        <Setter Property="FrameworkElement.Height" Value="31"/>
                                        <Style.Triggers>
                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                <Setter Property="FrameworkElement.Height" Value="40" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ContentPresenter.Style>
                            </ContentPresenter>
                        </tools_controls:RibbonWindowPanel>
                        <Border Width="5"
                                Height="1"
                                Margin="0,-14,0,0"
                                DockPanel.Dock="Left" />
                        <Border Width="41"
                                Height="0"
                                Margin="0,-14,0,0"
                                Panel.ZIndex="11"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="0,0,0,0"
                                DockPanel.Dock="Left" />
                        <Border Width="5"
                                Height="0.02"
                                Margin="0,-14,0,0"
                                Panel.ZIndex="12"
                                DockPanel.Dock="Right" />
                        <Border                                
                                Panel.ZIndex="12"
                                BorderThickness="0"
                                DockPanel.Dock="Right">
                            <Border.Style>
                                <Style>
                                    <Setter Property="Border.Margin" Value="0,-24,0,1"/>
                                    <Setter Property="Border.Height" Value="23"/>
                                    <Style.Triggers>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter Property="Border.Margin" Value="0,-39,0,1" />
                                            <Setter Property="Border.Height" Value="40"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <ContentPresenter ContentSource="TabPanelItem" />
                        </Border>

                        <Border x:Name="ribbonTabBorder" 
                                Panel.ZIndex="10"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                DockPanel.Dock="Bottom">
                            <Border.Style>
                                <Style>
                                    <!--<Setter Property="Border.Margin" Value="17,-25,0,2"/>-->
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Visible">
                                            <Setter Property="Border.Margin" Value="17,-25,0,2"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Collapsed">
                                            <Setter Property="Border.Margin" Value="-46,-25,0,2"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>

                            <ItemsPresenter Focusable="False" KeyboardNavigation.IsTabStop="False" />
                        </Border>
                    </DockPanel>


                    <Border x:Name="ribBorder"
                            Grid.Row="1"
							Margin="0,-1,0,0"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="1"
                            Padding="0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <tools_controls:RibbonTabItemsControl DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                     Path=SelectedTabItem.DisplayMemberPath}"
                                                         Focusable="False"
                                                         ItemContainerStyle="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                      Path=SelectedTabItem.ItemContainerStyle}"
                                                         ItemContainerStyleSelector="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                              Path=SelectedTabItem.ItemContainerStyleSelector}"
                                                         ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                               Path=SelectedTabItem.Items}"
                                                         ItemStringFormat="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                    Path=SelectedTabItem.ItemStringFormat}"
                                                         ItemTemplate="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                Path=SelectedTabItem.ItemTemplate}"
                                                         ItemTemplateSelector="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                        Path=SelectedTabItem.ItemTemplateSelector}">

                                <tools_controls:RibbonTabItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <tools_controls:RibbonLayoutPanel />
                                    </ItemsPanelTemplate>
                                </tools_controls:RibbonTabItemsControl.ItemsPanel>
                            </tools_controls:RibbonTabItemsControl>
                            <Grid Grid.Column="1" HorizontalAlignment="Right">
                                <tools_controls:RibbonToggleButton x:Name="ToggleButton"
                                                          Width="29"
                                                          Height="22" tools_controls:Ribbon.IsQATItem="False"
                                                          HorizontalAlignment="Right"
                                                          VerticalAlignment="Bottom"
                                                          Panel.ZIndex="12"
                                                          Style="{DynamicResource RibbonToggleButtonStyle}"
                                                          Visibility="{TemplateBinding MinimizeButtonVisibility}" />
                            </Grid>
                        </Grid>
                    </Border>

                </Grid>
            </Border>
        </AdornerDecorator>
        <ControlTemplate.Triggers>
            <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0,-53,0,0" />
            </Trigger>
            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                <Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>
                <Setter Property="Margin" Value="0,-3,0,0" TargetName="ribBorder"/>
            </Trigger>

        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!--  ContextAdorner Style  -->
    <Style x:Key="Office2013ContextAdornerStyle" TargetType="{x:Type shared:TemplatedAdornerInternalControl}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:ContextAdorner}}, Path=ContextTabGroup.Visibility}" />
        <Setter Property="Background" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:ContextAdorner}}, Converter={StaticResource colorToTransparentBrushConverter}, Path=ContextTabGroup.BackColor}" />
        <Setter Property="Height" Value="57" />
        <Setter Property="Foreground" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:ContextAdorner}}, Converter={StaticResource colorToBrushConverter}, Path=ContextTabGroup.BackColor}" />
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:ContextAdorner}}, Converter={StaticResource colorToTransparentBrushConverter}, Path=ContextTabGroup.BackColor}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type shared:TemplatedAdornerInternalControl}">


                    <Border Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}"
                            Margin="0,5,0,0"
                            BorderBrush="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                 AncestorType={x:Type tools_controls:ContextAdorner}},
                                                  Converter={StaticResource colorToBrushConverter},
                                                  Path=ContextTabGroup.BackColor}"
                            BorderThickness="0,4,0,0" IsHitTestVisible="False">
                        <Grid>
                            <Border Background="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:ContextAdorner}}, Converter={StaticResource colorToBrushConverter}, Path=ContextTabGroup.BackColor}" Opacity="0.10" />

                            <TextBlock x:Name="PART_Label"
                                       Margin="8,3,3,0" TextTrimming="CharacterEllipsis"
                                       HorizontalAlignment="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                    AncestorType={x:Type tools_controls:Ribbon}},
                                                                     Path=TabGroupLabelAlignment}"
                                       
                                       FontSize="14"
                                       FontWeight="thin"
                                       Foreground="{TemplateBinding Foreground}"
                                       Text="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                     AncestorType={x:Type tools_controls:ContextAdorner}},
                                                      Path=ContextTabGroup.Label}"
                                       TextAlignment="Center" />

                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>


                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Normal" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="PART_Label" Property="BitmapEffect">
                                <Setter.Value>
                                    <OuterGlowBitmapEffect GlowColor="#FFFFFFFF"
                                                           GlowSize="10"
                                                           Opacity="1" />
                                </Setter.Value>
                            </Setter>
                        </MultiDataTrigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Height" Value="75"/>
                            <Setter Property="Margin" Value="0 -17 0 0"/>
                        </Trigger>


                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

   
    <!--  Ribbon style  -->
    <tools_controls:BackStageButton x:Key="BackStageOffice2013Key"                                                   
                           shared_windows:WindowChrome.IsHitTestVisibleInChrome="True" >
        <tools_controls:BackStageButton.Style>
            <Style TargetType="{x:Type tools_controls:BackStageButton}">
                <Setter Property="Width" Value="61"/>
                <Setter Property="Height" Value="25"/>
                <Setter Property="Margin" Value="-2,28,0,0"/>
                <Setter Property="Focusable" Value="False"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:BackStageButton}">
                            <Border x:Name="border2"
                            Height="25"
                            MinWidth="62"
                            Margin="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Background="{Binding Path=BackStageColor,
                                                 RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}"
                            SnapsToDevicePixels="True">
                                <Grid Margin="2,0,2,0">
                                    <TextBlock x:Name="contentPresenter"
                                       Margin="0,5"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       SnapsToDevicePixels="True"
                                       Text="{TemplateBinding Header}"
                                       TextBlock.Foreground="{StaticResource ActiveForegroundBrush}"
                                       TextTrimming="CharacterEllipsis"
                                       TextWrapping="NoWrap">
                               
                                    </TextBlock>

                                </Grid>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                        <Setter Property="Width" Value="64"/>
                        <Setter Property="Height" Value="30"/>
                        <Setter Property="Margin" Value="-2,44,0,0"/>
                    </Trigger>
                    <MultiDataTrigger >
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RibbonState,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type tools_controls:Ribbon}}}" Value="Normal"/>
                            <Condition Binding="{Binding IsQATBelow,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type tools_controls:Ribbon}}}" Value="True"/>
                            <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch),RelativeSource={RelativeSource Self}}" Value="True"/>
                        </MultiDataTrigger.Conditions>
                        <Setter Property="Margin" Value="-2,28,0,0"/>
                    </MultiDataTrigger>
                    <MultiDataTrigger >
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RibbonState,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type tools_controls:Ribbon}}}" Value="Hide"/>
                            <Condition Binding="{Binding IsQATBelow,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type tools_controls:Ribbon}}}" Value="True"/>
                            <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch),RelativeSource={RelativeSource Self}}" Value="True"/>
                        </MultiDataTrigger.Conditions>
                        <Setter Property="Margin" Value="-2,26,0,0"/>
                    </MultiDataTrigger>
                    <MultiDataTrigger >
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RibbonState,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type tools_controls:Ribbon}}}" Value="Adorner"/>
                            <Condition Binding="{Binding IsQATBelow,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type tools_controls:Ribbon}}}" Value="True"/>
                            <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch),RelativeSource={RelativeSource Self}}" Value="True"/>
                        </MultiDataTrigger.Conditions>
                        <Setter Property="Margin" Value="-2,26,0,0"/>
                    </MultiDataTrigger>
                </Style.Triggers>
            </Style>
        </tools_controls:BackStageButton.Style>

    </tools_controls:BackStageButton>
    <Style x:Key="Office2013RibbonStyle" TargetType="{x:Type tools_controls:Ribbon}">
        <Setter Property="BackStageColor" Value="{StaticResource ActiveBackgroundBrush}" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Panel.ZIndex" Value="1000" />
        <Setter Property="TabGroupLabelAlignment" Value="Center" />
        <Setter Property="RibbonBarCollapseImage" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt16.png" />
        <Setter Property="FocusManager.IsFocusScope" Value="True" />
        <Setter Property="ContextAdornerStyle" Value="{StaticResource Office2013ContextAdornerStyle}" />
        <Setter Property="BackStageButton" Value="{StaticResource BackStageOffice2013Key}" />
        <Setter Property="Height" Value="95"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <tools_controls:TabPanel Name="TabPanel" SeparatorColor="#007ACC" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />

        <Style.Triggers>

            <Trigger Property="RibbonState" Value="Normal">
                <Setter Property="Template" Value="{StaticResource Normal}" />
            </Trigger>


            <Trigger Property="RibbonState" Value="Adorner">
                <Setter Property="Height" Value="0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:Ribbon}">
                            <AdornerDecorator Name="PART_AdornerDecorator"
                                              Margin="0,-53,0,0"
                                              Panel.ZIndex="100"
                                              DockPanel.Dock="Top">
                                <Border>
                                    <Grid x:Name="LayoutGrid" ClipToBounds="True">
                                        <Grid.RowDefinitions>
                                            <RowDefinition>
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="53"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="73"/>
                                                            </Trigger>
                                                            <DataTrigger Binding="{Binding IsQATBelow,RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="53"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>

                                        </Grid.RowDefinitions>
                                        <DockPanel x:Name="dockPanel"
                                                   Grid.Row="0"
                                                   Panel.ZIndex="200">
                                            <tools_controls:RibbonWindowPanel x:Name="PART_RibbonWindowPanel"
                                                                     Panel.ZIndex="100"
                                                                     DockPanel.Dock="Top">
                                                <Border x:Name="PART_TitleBorder"
                                                        Width="{TemplateBinding ActualWidth}"
                                                        Height="30"
                                                        Margin="0,0,0,-20"
                                                        Visibility="Collapsed" />
                                                <ContentPresenter Content="{TemplateBinding BackStageButton}" />
                                                <ContentPresenter 
                                                                  Margin="30,0,0,0"
                                                                  HorizontalAlignment="Center"
                                                                  Content="{TemplateBinding QuickAccessToolBar}"
                                                                  shared_windows:WindowChrome.IsHitTestVisibleInChrome="True"
                                                                  Visibility="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                       Path=IsQATBelow,
                                                                                       Converter={StaticResource BoolInvertConverter}}" >
                                                    <ContentPresenter.Style>
                                                        <Style>
                                                            <Setter Property="FrameworkElement.Height" Value="31"/>
                                                            <Style.Triggers>
                                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                    <Setter Property="FrameworkElement.Height" Value="35" />
                                                                </Trigger>                                                                
                                                            </Style.Triggers>
                                                        </Style>
                                                    </ContentPresenter.Style>
                                                </ContentPresenter>
                                            </tools_controls:RibbonWindowPanel>
                                            <Border Width="5"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="41"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="11"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="0,0,0,1"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="5"
                                                    Height="0.02"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="12"
                                                    DockPanel.Dock="Right" />
                                            <Border 
                                                    Panel.ZIndex="12"
                                                    Background="Transparent"
                                                    DockPanel.Dock="Right">
                                                <Border.Style>
                                                    <Style>
                                                        <Setter Property="Border.Margin" Value="0,-23,0,1"/>
                                                        <Setter Property="Border.Height" Value="28"/>
                                                        <!--<Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="Border.Margin" Value="0,-39,0,1" />
                                                                <Setter Property="Border.Height" Value="40"/>
                                                            </Trigger>
                                                        </Style.Triggers>-->
                                                    </Style>
                                                </Border.Style>
                                                <ContentPresenter ContentSource="TabPanelItem" />
                                            </Border>

                                            <Border  x:Name="ribbonTabBorder"
                                                    Panel.ZIndex="10"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    DockPanel.Dock="Bottom">
                                                <Border.Style>
                                                    <Style>
                                                        <!--<Setter Property="Border.Margin" Value="17,-24,0,1"/>-->
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Visible">
                                                                <Setter Property="Border.Margin" Value="17,-25,0,2"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                <Setter Property="Border.Margin" Value="-46,-25,0,2"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <ItemsPresenter />
                                            </Border>
                                        </DockPanel>

                                        <Popup x:Name="Part_AdornerPopup"
                                               AllowsTransparency="True"
                                               ClipToBounds="True"
                                               IsOpen="False"
                                               PlacementTarget="{Binding ElementName=dockPanel}"
                                               StaysOpen="False">
                                            <Border  Margin="0,7,0,15" MinHeight="92">
                                                <Border x:Name="AdornerTabPanelBorder"
                                                        Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                       
                                                        VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                        BorderThickness="0,1,0,1"
                                                        Padding="0">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <tools_controls:RibbonTabItemsControl DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                 Path=SelectedTabItem.DisplayMemberPath}"
                                                                                     Focusable="False"
                                                                                     ItemContainerStyle="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                  Path=SelectedTabItem.ItemContainerStyle}"
                                                                                     ItemContainerStyleSelector="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                          Path=SelectedTabItem.ItemContainerStyleSelector}"
                                                                                     ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                           Path=SelectedTabItem.Items}"
                                                                                     ItemStringFormat="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                Path=SelectedTabItem.ItemStringFormat}"
                                                                                     ItemTemplate="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                            Path=SelectedTabItem.ItemTemplate}"
                                                                                     ItemTemplateSelector="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                    Path=SelectedTabItem.ItemTemplateSelector}">

                                                            <tools_controls:RibbonTabItemsControl.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <tools_controls:RibbonLayoutPanel />
                                                                </ItemsPanelTemplate>
                                                            </tools_controls:RibbonTabItemsControl.ItemsPanel>
                                                        </tools_controls:RibbonTabItemsControl>
                                                        <Grid Grid.Column="1" HorizontalAlignment="Right">
                                                            <tools_controls:RibbonToggleButton x:Name="ToggleButton"
                                                                                      Width="29"
                                                                                      Height="22" tools_controls:Ribbon.IsQATItem="False"
                                                                                      HorizontalAlignment="Right"
                                                                                      VerticalAlignment="Bottom"
                                                                                      Panel.ZIndex="12"
                                                                                      Style="{DynamicResource RibbonToggleButtonStyle}"
                                                                                      Visibility="{TemplateBinding MinimizeButtonVisibility}" />
                                                        </Grid>
                                                    </Grid>
                                                    <Border.Style>
                                                        <Style>
                                                            <Style.Triggers>
                                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                    <!--<Setter Property="Border.Margin" Value="0,-3,0,0"/>-->
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                </Border>
                                            </Border>
                                        </Popup>
                                    </Grid>

                                </Border>
                            </AdornerDecorator>
                            <ControlTemplate.Triggers>
                                <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                    <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                </Trigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=SelectedTabItem.HasContextTabGroup}" Value="True">
                                    <Setter TargetName="AdornerTabPanelBorder" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}}, Converter={StaticResource colorToBrushConverter}, Path=SelectedContextTabGroupBackColor}" />
                                    <Setter TargetName="AdornerTabPanelBorder" Property="BorderThickness" Value="0,1,0,1" />
                                    <Setter TargetName="AdornerTabPanelBorder" Property="Margin" Value="0,0,0,0" />
                                </DataTrigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="RibbonState" Value="Adorner" />
                                        <Condition Property="IsQATBelow" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                    </MultiTrigger.Conditions>
                                    <!--<Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>-->
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Normal" />
                    <Condition Property="IsQATBelow" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="125"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:Ribbon}">
                            <AdornerDecorator Name="PART_AdornerDecorator"
                                              Margin="0,-53,0,0"
                                              Panel.ZIndex="100"
                                              DockPanel.Dock="Top">
                                <Border>
                                    <Grid ClipToBounds="True">
                                        <Grid.RowDefinitions>
                                            <RowDefinition>
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="53"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="55"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>
                                            <RowDefinition >
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="95"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="125"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>
                                            <RowDefinition >
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="30"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="35"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>
                                        </Grid.RowDefinitions>
                                        <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                            <tools_controls:RibbonWindowPanel x:Name="PART_RibbonWindowPanel"
                                                                     Panel.ZIndex="100"
                                                                     DockPanel.Dock="Top">
                                                <Border x:Name="PART_TitleBorder"
                                                        Width="{TemplateBinding ActualWidth}"
                                                        Height="30"
                                                        Margin="0,0,0,-20"
                                                        Visibility="Collapsed" />
                                                <ContentPresenter Content="{TemplateBinding BackStageButton}" />
                                            </tools_controls:RibbonWindowPanel>
                                            <Border Width="5"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="41"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="11"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="0,0,0,1"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="5"
                                                    Height="0.02"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="12"
                                                    DockPanel.Dock="Right" />
                                            <Border Height="23"
                                                    Margin="0,-23,0,1"
                                                    Panel.ZIndex="12"
                                                    Background="Transparent"
                                                    DockPanel.Dock="Right">
                                                <ContentPresenter ContentSource="TabPanelItem" />
                                            </Border>

                                            <Border 
                                                    Panel.ZIndex="10"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    DockPanel.Dock="Bottom">
                                                <ItemsPresenter />
                                                <Border.Style>
                                                    <Style>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Visible">
                                                                <Setter Property="Border.Margin" Value="17,-25,0,1"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                <Setter Property="Border.Margin" Value="-46,-25,0,1"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                            </Border>
                                        </DockPanel>


                                        <Border x:Name="ribBorder"
                                                Grid.Row="1" Margin="0,-1,0,-6"
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="0,1,0,1"
                                                Padding="0">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <tools_controls:RibbonTabItemsControl DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                         Path=SelectedTabItem.DisplayMemberPath}"
                                                                             Focusable="False"
                                                                             ItemContainerStyle="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                          Path=SelectedTabItem.ItemContainerStyle}"
                                                                             ItemContainerStyleSelector="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                  Path=SelectedTabItem.ItemContainerStyleSelector}"
                                                                             ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                   Path=SelectedTabItem.Items}"
                                                                             ItemStringFormat="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                        Path=SelectedTabItem.ItemStringFormat}"
                                                                             ItemTemplate="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                    Path=SelectedTabItem.ItemTemplate}"
                                                                             ItemTemplateSelector="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                            Path=SelectedTabItem.ItemTemplateSelector}">

                                                    <tools_controls:RibbonTabItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <tools_controls:RibbonLayoutPanel />
                                                        </ItemsPanelTemplate>
                                                    </tools_controls:RibbonTabItemsControl.ItemsPanel>
                                                </tools_controls:RibbonTabItemsControl>

                                                <Grid Grid.Column="1" HorizontalAlignment="Right">
                                                    <tools_controls:RibbonToggleButton x:Name="ToggleButton"
                                                                              Width="29" tools_controls:Ribbon.IsQATItem="False"
                                                                              Height="22"
                                                                              HorizontalAlignment="Right"
                                                                              VerticalAlignment="Bottom"
                                                                              Panel.ZIndex="12"
                                                                              Style="{DynamicResource RibbonToggleButtonStyle}"
                                                                              Visibility="{TemplateBinding MinimizeButtonVisibility}" />
                                                </Grid>

                                            </Grid>
                                        </Border>




                                        <Border Name="PART_QAT" Margin="0,6,0,0"
                                                Grid.Row="2"
                                                Background="Transparent">

                                            <ContentPresenter HorizontalAlignment="Left"
                                                              Content="{TemplateBinding QuickAccessToolBar}"
                                                              DockPanel.Dock="Top" />

                                        </Border>
                                    </Grid>
                                </Border>
                            </AdornerDecorator>
                            <ControlTemplate.Triggers>
                                <Trigger Property="RibbonState" Value="Adorner">
                                    <Setter TargetName="PART_QAT" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                    <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                </Trigger>

                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized">
                                    <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0,-53,0,0" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=SelectedTabItem.HasContextTabGroup}" Value="True">



                                    <Setter TargetName="ribBorder" Property="BorderThickness" Value="0,0.6,0,0" />
                                    <Setter TargetName="ribBorder" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}}, Converter={StaticResource colorToBrushConverter}, Path=SelectedContextTabGroupBackColor}" />
                                </DataTrigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Height" Value="175"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Hide" />
                    <Condition Property="IsQATBelow" Value="False" />
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:Ribbon}">
                            <AdornerDecorator Name="PART_AdornerDecorator"
                                              Margin="0,-53,0,0"
                                              Panel.ZIndex="100"
                                              DockPanel.Dock="Top">
                                <Border>
                                    <Grid ClipToBounds="True">
                                        <Grid.RowDefinitions>
                                            <RowDefinition>
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="53"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="73"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>

                                        </Grid.RowDefinitions>
                                        <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                            <tools_controls:RibbonWindowPanel x:Name="PART_RibbonWindowPanel"
                                                                     Panel.ZIndex="100"
                                                                     DockPanel.Dock="Top">
                                                <Border x:Name="PART_TitleBorder"
                                                        Width="{TemplateBinding ActualWidth}"
                                                        Height="30"
                                                        Margin="0,0,0,-20"
                                                        Visibility="Collapsed" />
                                                <ContentPresenter Content="{TemplateBinding BackStageButton}" />
                                                <ContentPresenter
                                                                  Margin="30,0,0,0"
                                                                  HorizontalAlignment="Center"
                                                                  Content="{TemplateBinding QuickAccessToolBar}"
                                                                  shared_windows:WindowChrome.IsHitTestVisibleInChrome="True" >
                                                    <ContentPresenter.Style>
                                                        <Style>
                                                            <Setter Property="FrameworkElement.Height" Value="31"/>
                                                            <Style.Triggers>
                                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                    <Setter Property="FrameworkElement.Height" Value="35" />
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </ContentPresenter.Style>
                                                </ContentPresenter>
                                            </tools_controls:RibbonWindowPanel>
                                            <Border Width="5"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="41"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="11"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="0,0,0,1"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="5"
                                                    Height="0.02"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="12"
                                                    DockPanel.Dock="Right" />
                                            <Border 
                                                    Panel.ZIndex="12"
                                                    Background="Transparent"
                                                    DockPanel.Dock="Right">
                                                <Border.Style>
                                                    <Style>
                                                        <Setter Property="Border.Margin" Value="0,-23,0,1"/>
                                                        <Setter Property="Border.Height" Value="23"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="Border.Margin" Value="0,-39,0,1" />
                                                                <Setter Property="Border.Height" Value="40"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <ContentPresenter ContentSource="TabPanelItem" />
                                            </Border>

                                            <Border  x:Name="ribbonTabBorder"
                                                    Panel.ZIndex="10"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    DockPanel.Dock="Bottom">
                                                <ItemsPresenter />
                                                <Border.Style>
                                                    <Style>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Visible">
                                                                <Setter Property="Border.Margin" Value="17,-25,0,2"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                <Setter Property="Border.Margin" Value="-46,-25,0,2"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                            </Border>
                                        </DockPanel>


                                    </Grid>
                                </Border>
                            </AdornerDecorator>
                            <ControlTemplate.Triggers>
                                <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                    <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>
                                </Trigger>

                                <!--
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:RibbonWindow}},  Path=WindowState}" Value="Maximized">
                                    <Setter Property="Margin" TargetName="PART_AdornerDecorator" Value="0,-53,0,0"/>
                                    </DataTrigger>
                                -->

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized">
                <Setter Property="Margin" Value="0,2,0,0" />
            </DataTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Hide" />
                    <Condition Property="IsQATBelow" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="30"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:Ribbon}">
                            <AdornerDecorator Name="PART_AdornerDecorator"
                                              Margin="0,-53,0,0"
                                              Panel.ZIndex="100"
                                              DockPanel.Dock="Top">
                                <Border>
                                    <Grid ClipToBounds="True">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="53">
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="53"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="73"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>
                                            <RowDefinition Height="1" />
                                            <RowDefinition Height="1" />
                                            <RowDefinition  >
                                                <RowDefinition.Style>
                                                    <Style>
                                                        <Setter Property="RowDefinition.Height" Value="25"/>
                                                        <Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="35"/>
                                                            </Trigger>                                                           
                                                                
                                                        </Style.Triggers>
                                                    </Style>
                                                </RowDefinition.Style>
                                            </RowDefinition>
                                        </Grid.RowDefinitions>
                                        <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                            <tools_controls:RibbonWindowPanel x:Name="PART_RibbonWindowPanel"
                                                                     Panel.ZIndex="100"
                                                                     DockPanel.Dock="Top">
                                                <Border x:Name="PART_TitleBorder"
                                                        Width="{TemplateBinding ActualWidth}"
                                                        Height="30"
                                                        Margin="0,0,0,-20"
                                                        Visibility="Collapsed" />
                                                <ContentPresenter Content="{TemplateBinding BackStageButton}" />
                                            </tools_controls:RibbonWindowPanel>
                                            <Border Width="5"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="41"
                                                    Height="0"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="11"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="0,0,0,1"
                                                    DockPanel.Dock="Left" />
                                            <Border Width="5"
                                                    Height="0.02"
                                                    Margin="0,-14,0,0"
                                                    Panel.ZIndex="12"
                                                    DockPanel.Dock="Right" />
                                            <Border Height="23"
                                                    Margin="0,-23,0,1"
                                                    Panel.ZIndex="12"
                                                    Background="Transparent"
                                                    DockPanel.Dock="Right">
                                                <ContentPresenter ContentSource="TabPanelItem" />
                                            </Border>

                                            <Border x:Name="ribbonTabBorder"
                                                    Panel.ZIndex="10"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    DockPanel.Dock="Bottom">
                                                <ItemsPresenter />
                                                <Border.Style>
                                                    <Style>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Visible">
                                                                <Setter Property="Border.Margin" Value="17,-25,0,2"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}},Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                <Setter Property="Border.Margin" Value="-46,-25,0,2"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                            </Border>
                                        </DockPanel>

                                        <!--<Border Name="Test1"
                                                Grid.Row="1"
                                                Height="1"
                                                Margin="0,-3,0,0"
                                                Background="Transparent"
                                                BorderBrush="{StaticResource TransparentBrush}"
                                                BorderThickness="3,0,3,0" />
                                        <Border Name="Test2"
                                                Grid.Row="2"
                                                Height="1"
                                                Margin="3,-4,3,0"
                                                Background="Transparent" />-->
                                        <Border Name="PART_QAT"
                                                Grid.Row="3"
                                                Background="Transparent"
                                                Padding="0,1,0,0">

                                            <ContentPresenter HorizontalAlignment="Left"
                                                              Content="{TemplateBinding QuickAccessToolBar}"
                                                              DockPanel.Dock="Top" />

                                        </Border>
                                    </Grid>
                                </Border>
                            </AdornerDecorator>
                            <ControlTemplate.Triggers>
                                <Trigger Property="RibbonState" Value="Adorner">
                                    <Setter TargetName="PART_QAT" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                    <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Height" Value="35"/>
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>
                                </Trigger>


                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>
            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                <Setter Property="Height" Value="175"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Normal" />
                    <Condition Property="IsQATBelow" Value="False" />
                    <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="145"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Normal" />
                    <Condition Property="IsQATBelow" Value="True" />
                    <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="170"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Hide" />
                    <Condition Property="IsQATBelow" Value="False" />
                    <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="30"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Hide" />
                    <Condition Property="IsQATBelow" Value="True" />
                    <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="40"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Adorner" />
                    <Condition Property="IsQATBelow" Value="False" />
                    <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="30"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="RibbonState" Value="Adorner" />
                    <Condition Property="IsQATBelow" Value="True" />
                    <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="Height" Value="40"/>
            </MultiTrigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonStyle}" TargetType="{x:Type tools_controls:Ribbon}" />

    <!--  ItemsControlInternalItemStyle  -->
    <Style x:Key="ItemsControlInternalItemStyle" TargetType="shared:ItemsControlInternalItem">
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="5,4,5,4" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="shared:ItemsControlInternalItem">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <ContentPresenter Margin="-1"
                                          Content="{TemplateBinding Content}"
                                          DataContext="{Binding Path=DataContext,
                                                                RelativeSource={RelativeSource FindAncestor,
                                                                                               AncestorType={x:Type shared:ItemsControlInternal}}}" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="BorderBrush" Value="Transparent" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!--  DropDownButton style for QuickAccessToolBar  -->
    <Style x:Key="QuickAccessPopupButtonStyle" TargetType="{x:Type tools_controls:DropDownButton}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Width" Value="11" />
        <Setter Property="Height" Value="21" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True"/>
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="ButtonBase.ClickMode">
            <Setter.Value>
                <x:Static Member="ClickMode.Press" />
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:DropDownButton}">
                    <Border Name="PART_ToggleButton"
                            Width="13"
                            Height="{TemplateBinding Height}"
                            Background="{TemplateBinding Panel.Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <Grid Height="17"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="5*" />
                                    <RowDefinition Height="5*" />
                                </Grid.RowDefinitions>
                                <Rectangle x:Name="path1"
                                           Width="5"
                                           Height="1"
                                           Margin="0,4,0,0"
                                           VerticalAlignment="Center"
                                           Stroke="{StaticResource GlyphBrush}" />
                                <Path x:Name="path2"
                                      Grid.Row="1"
                                      Width="5"
                                      Height="3"
                                      Margin="0"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Top"
                                      Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                      Fill="{StaticResource GlyphBrush}"
                                      Stretch="Fill" />


                            </Grid>
                            <Popup Name="PART_Popup"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{Binding Path=IsDropDownOpen,
                                                    Mode=TwoWay,
                                                    RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                   Placement="Bottom"
                                   PopupAnimation="Fade"
                                   StaysOpen="False">
                                <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow"
                                                                                 Margin="0"
                                                                                 SnapsToDevicePixels="true">
                                    <Border Background="{StaticResource ContentBackgroundBrush}"
                                            BorderBrush="{StaticResource ContentBorderBrush}"
                                            BorderThickness="1">
                                        <ItemsPresenter />
                                    </Border>
                                </Microsoft_Windows_Luna:SystemDropShadowChrome>
                            </Popup>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                            <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                        </Trigger>

                     
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="path2" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                            <Setter TargetName="path1" Property="Stroke" Value="{StaticResource HoverGlyphBrush}" />

                        </Trigger>

                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="path2" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
                            <Setter TargetName="path1" Property="Stroke" Value="{StaticResource ActiveGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Height" Value="30"/>
                            <Setter Property="Width" Value="30"/>
                            <!--<Setter Property="Height" Value="8" TargetName="path2"/>
                            <Setter Property="Width" Value="10" TargetName="path2"/>
                            <Setter Property="Height" Value="4" TargetName="path1"/>
                            <Setter Property="Width" Value="10" TargetName="path1"/>-->
                        </Trigger>


                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="QuickAccessPopupButtonOverflowStyle" TargetType="{x:Type tools_controls:DropDownButton}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Width" Value="15" />
        <Setter Property="Height" Value="20" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="ButtonBase.ClickMode">
            <Setter.Value>
                <x:Static Member="ClickMode.Press" />
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:DropDownButton}">
                    <Border Name="PART_ToggleButton"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}"
                            Background="{TemplateBinding Panel.Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True">
                        <Grid>

                            <Path x:Name="path" Data="{TemplateBinding PathGeometry}"
                                  Fill="{StaticResource GlyphBrush}"
                                  Stroke="{StaticResource GlyphBrush}"
                                  StrokeThickness="1" />
                            <Popup Name="PART_Popup"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{Binding Path=IsDropDownOpen,
                                                    Mode=TwoWay,
                                                    RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                   Placement="Bottom"
                                   PopupAnimation="Fade"
                                   StaysOpen="False">
                                <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow"
                                                                                 Margin="0"
                                                                                 SnapsToDevicePixels="true">
                                    <Border Background="{StaticResource ContentBackgroundBrush}"
                                            BorderBrush="{StaticResource ContentBorderBrush}"
                                            BorderThickness="1">
                                        <ItemsPresenter />
                                    </Border>
                                </Microsoft_Windows_Luna:SystemDropShadowChrome>
                            </Popup>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                            <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                        </Trigger>

                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
							<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                            <Setter TargetName="path" Property="Stroke" Value="{StaticResource HoverGlyphBrush}" />

                        </Trigger>

                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
							<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
                            <Setter TargetName="path" Property="Stroke" Value="{StaticResource ActiveGlyphBrush}" />


                        </Trigger>


                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  RibbonButtonPopupItemStyle  -->
    <Style x:Key="RibbonButtonPopupItemStyle" TargetType="{x:Type tools_controls:RibbonButton}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Margin" Value="1,0,0,0" />

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                    <Border Name="OuterBorder"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}"
                            MinWidth="{TemplateBinding MinWidth}"
                            MinHeight="{TemplateBinding MinHeight}"
                            MaxWidth="{TemplateBinding MaxWidth}"
                            MaxHeight="{TemplateBinding MaxHeight}"
                            Margin="{TemplateBinding Margin}"
                            Background="{TemplateBinding Panel.Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True">
                        <Grid Margin="0,1,0,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" MinWidth="22" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <Border Name="PART_CheckBorder"
                                    Grid.Column="0"
                                    Width="19"
                                    Height="19"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Visibility="Collapsed">
                                <Path Width="8"
                                      Height="8"
                                      Data="M10.738967,0 L11.817,1.1360061 5.1774399,7.4388217 5.1789999,7.4406547 4.0474274,8.5560006 0,3.7727338 1.1959616,2.7609998 4.1605471,6.244079 z"
                                      Fill="{StaticResource GlyphBrush}"
                                      SnapsToDevicePixels="True"
                                      Stretch="Fill" />
                            </Border>
                            <TextBlock Name="label"
                                       Grid.Column="1"
                                       Margin="7,2,2,2"
                                       VerticalAlignment="Center"
                                       Foreground="{TemplateBinding Foreground}"
                                       Text="{TemplateBinding Label}" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="False"/>
                                <Condition Property="IsKeyboardFocused" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                        </MultiTrigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="PART_CheckBorder" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}"/>
                        </Trigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="FontSize" Value="13"/>
                            <Setter Property="Padding" Value="16,9,16,9"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <!--  DropDownButton style for RibbonBar  -->

    <Style x:Key="RibbonDropDownToggleButton" TargetType="{x:Type tools_controls:DropDownButton}">
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="VerticalContentAlignment" Value="Top" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:DropDownButton}">
                    <Border Name="PART_ToggleButton"
                            Background="{TemplateBinding Background}"
                            BorderBrush="Transparent"
                            BorderThickness="{TemplateBinding BorderThickness}">


                        <DockPanel Margin="0,3,0,0"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Top">

                            <Border Name="PART_ImageBorder"
                                    HorizontalAlignment="Center"
                                    Background="Transparent"
                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                    BorderThickness="1"
                                    DockPanel.Dock="Top">

                                <Grid MinWidth="31" MinHeight="31">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="7" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Image Grid.Row="0"
                                           Width="16"
                                           Height="16"
                                           Source="{Binding Path=LargeIcon,
                                                            Mode=OneWay,
                                                            RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Border Grid.Row="1" Background="Transparent" />
                                </Grid>
                            </Border>

                            <tools_controls:CustomItemsControl Margin="3,1,3,1" x:Name="label"
                                                      DockPanel.Dock="Bottom"
                                                      Focusable="False"
                                                      ItemsSource="{Binding Path=Label,
                                                                            Mode=OneWay,
                                                                            Converter={StaticResource TextWrappingConverter},
                                                                            RelativeSource={RelativeSource TemplatedParent}}"
                                                      Path="{StaticResource Path}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <tools_controls:MultilinePanel />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </tools_controls:CustomItemsControl>

                            <Popup Name="PART_Popup"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{Binding Path=IsDropDownOpen,
                                                    RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                   Placement="Bottom"
                                   PlacementTarget="{Binding ElementName=PART_ToggleButton}"
                                   PopupAnimation="Fade"
                                   StaysOpen="False">
                                <Microsoft_Windows_Luna:SystemDropShadowChrome Name="PART_Shadow"
                                                                                 Margin="0"
                                                                                 SnapsToDevicePixels="true">

                                    <ItemsPresenter />
                                </Microsoft_Windows_Luna:SystemDropShadowChrome>
                            </Popup>
                        </DockPanel>

                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                            <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,4,4" />
                            <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                        </Trigger>

                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding ElementName=PART_ToggleButton, Path=IsMouseOver}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="{StaticResource HoverBackgroundBrush}" />

                        </MultiDataTrigger>

                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>

                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsDropDownOpen}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="{StaticResource ActiveBackgroundBrush}" />
                        </MultiDataTrigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="FrameworkElement.Height" TargetName="PART_ImageBorder" Value="38" />
                            <Setter Property="FrameworkElement.Width" TargetName="PART_ImageBorder" Value="38" />
                            <Setter Property="Margin" TargetName="label" Value="3,15,3,1" />
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

    </Style>



    <!--  RibbonBarLauncherButton style  -->
    <Style x:Key="RibbonBarLauncherButton" TargetType="{x:Type tools_controls:RibbonButton}">
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Height" Value="13" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                    <Border Name="Part_OuterBorder"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True">
                        <Canvas Width="8"
                                Height="8"
                                Margin="1,0,0,0"
                                Background="Transparent "
                                SnapsToDevicePixels="True">
                            <Path x:Name="path" Stroke="{StaticResource GlyphBrush}">
                                <Path.Data>
                                    <GeometryGroup>
                                        <LineGeometry StartPoint="0.5,0" EndPoint="0.5,6" />
                                        <LineGeometry StartPoint="0,0.5" EndPoint="6,0.5" />
                                        <LineGeometry StartPoint="3,3.5" EndPoint="4,3.5" />
                                        <LineGeometry StartPoint="4,4.5" EndPoint="6,4.5" />
                                        <LineGeometry StartPoint="4,5.5" EndPoint="6,5.5" />
                                        <LineGeometry StartPoint="3,6.5" EndPoint="7,6.5" />
                                        <LineGeometry StartPoint="6.5,3" EndPoint="6.5,7" />
                                    </GeometryGroup>
                                </Path.Data>
                            </Path>
                        </Canvas>
                        <!--  </Border>  -->
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Part_OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="path" Property="Stroke" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="Part_OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="path" Property="Stroke" Value="{StaticResource ActiveGlyphBrush}" />
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!--  Ribbon Bar Brushes  -->


    <!--  RibbonBar style  -->


    <Style x:Key="Office2013RibbonBarStyle" TargetType="{x:Type tools_controls:RibbonBar}">
        <Setter Property="CollapseImage" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}, Path=RibbonBarCollapseImage}" /> 
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="FontSize" Value="11.5" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonBar}">

                    <Grid Margin="1,0,-5,0">

                        <Border>
                            <Grid x:Name="barGrid">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="5" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition>
                                        <RowDefinition.Style>
                                            <Style>
                                                <Setter Property="RowDefinition.Height" Value="74"/>
                                                <Style.Triggers>
                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                        <Setter Property="RowDefinition.Height" Value="104"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </RowDefinition.Style>
                                    </RowDefinition>
                                    <RowDefinition MinHeight="17" />
                                </Grid.RowDefinitions>


                                <Border Name="PART_RibbonBarBorder" Margin="3,0,3,0">
                                    <Border Name="PART_presenterBorder" Grid.Row="0">
                                        <ItemsPresenter />
                                    </Border>
                                </Border>

                                <Border Name="PART_headerBorder" Grid.Row="1">

                                    <DockPanel>
                                        <tools_controls:RibbonButton Name="PART_DialogLauncherButton"   Margin="0,2,0,0"
                                                            Width="15"
                                                            ToolTipService.ShowOnDisabled="{Binding Path=(ToolTipService.ShowOnDisabled),RelativeSource={RelativeSource TemplatedParent}}"
                                                            Height="13"
                                                            Command="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                              Path=LauncherCommand}"
                                                            CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                       Path=LauncherCommandParameter}"
                                                            CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                    Path=LauncherCommandTarget}"
                                                            DockPanel.Dock="Right"
                                                            SizeForm="ExtraSmall"
                                                            SmallIcon="{TemplateBinding CollapseImage}"
                                                            Style="{StaticResource RibbonBarLauncherButton}"
                                                            ToolTip="{TemplateBinding LauncherToolTip}"
                                                            Visibility="{TemplateBinding IsLauncherButtonVisible,
                                                                                         Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        <tools_controls:RibbonAutomatableTextBlock Name="header"
                                                   Margin="0,0,0,2"
                                                   VerticalAlignment="Center"
                                                   Foreground="{StaticResource ContentForegroundBrush}"
                                                   Text="{TemplateBinding Header}"
                                                   TextAlignment="Center" />
                                    </DockPanel>
                                </Border>

                                <Border Grid.RowSpan="2"
                                        Grid.Column="1"
                                        Width="1"
                                        Height="{TemplateBinding Height}"
                                        HorizontalAlignment="Left"
                                        Background="{StaticResource ContentBorderBrush}"
                                        SnapsToDevicePixels="True" />

                            </Grid>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Margin" TargetName="PART_headerBorder" Value="5,0,5,0"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <tools_controls:GroupPanel PanelState="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonBar}}, Path=PanelState, Mode=OneWay}" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>

        <Style.Triggers>
            <Trigger Property="PanelState" Value="ExtraSmall">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonBar}">

                            <tools_controls:DropDownButton Name="PART_RibbonDropDownButton"
                                                  Label="{TemplateBinding Header}"
                                                  SizeForm="ExtraSmall"
                                                  SmallIcon="{TemplateBinding CollapseImage}">



                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="5" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition >
                                            <RowDefinition.Style>
                                                <Style>
                                                    <Setter Property="RowDefinition.Height" Value="70"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                            <Setter Property="RowDefinition.Height" Value="100"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </RowDefinition.Style>
                                        </RowDefinition>
                                        <RowDefinition Height="17" />
                                    </Grid.RowDefinitions>

                                    <Border Name="PART_RibbonBarBorder" Margin="3,0,3,0" Background="Transparent">
                                        <Border Name="PART_PresenterBorder" Grid.Row="0">
                                            <ItemsPresenter />
                                        </Border>
                                    </Border>

                                    <Border Name="PART_headerBorder" Grid.Row="1">
                                        <DockPanel>
                                            <tools_controls:RibbonButton Name="PART_DialogLauncherButton"
                                                                Width="15"
                                                                ToolTipService.ShowOnDisabled="{Binding Path=(ToolTipService.ShowOnDisabled),RelativeSource={RelativeSource TemplatedParent}}"
                                                                Height="14"
                                                                Command="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                  Path=LauncherCommand}"
                                                                CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                           Path=LauncherCommandParameter}"
                                                                CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                        Path=LauncherCommandTarget}"
                                                                DockPanel.Dock="Right"
                                                                SizeForm="ExtraSmall"
                                                                SmallIcon="{TemplateBinding CollapseImage}"
                                                                Style="{StaticResource RibbonBarLauncherButton}"
                                                                ToolTip="{TemplateBinding LauncherToolTip}"
                                                                Visibility="{TemplateBinding IsLauncherButtonVisible,
                                                                                             Converter={StaticResource BooleanToVisibilityConverter}}" />
                                            <TextBlock Name="header"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource ContentForegroundBrush}"
                                                       Text="{TemplateBinding Header}"
                                                       TextAlignment="Center" />
                                        </DockPanel>
                                    </Border>


                                    <Line Grid.RowSpan="2"
                                          Grid.Column="1"
                                          Width="1"
                                          Stroke="{StaticResource BorderBrush}"
                                          X1="1"
                                          Y1="87"
                                          Y2="1" />
                                </Grid>

                            </tools_controls:DropDownButton>


                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Margin" Value="0" />
            </Trigger>

            <Trigger Property="PanelState" Value="Collapsed">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonBar}">

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="5" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" BorderThickness="{TemplateBinding BorderThickness}">

                                    <Border Name="PART_InnerBorder" BorderBrush="Transparent">
                                        <Grid>
                                            <tools_controls:DropDownButton Name="PART_RibbonDropDownButton"
                                                                  Label="{TemplateBinding Header}"
                                                                  LargeIcon="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                      Path=CollapseImage}"
                                                                  Style="{StaticResource RibbonDropDownToggleButton}"
                                                                  Visibility="Hidden">

                                                <Border Name="PART_PopupBorder"
                                                        Background="{StaticResource ContentBackgroundBrush}"
                                                        BorderBrush="{StaticResource ContentBorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}">

                                                    <Grid>

                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition>
                                                                    <RowDefinition.Style>
                                                                        <Style>
                                                                            <Setter Property="RowDefinition.Height" Value="70"/>
                                                                            <Style.Triggers>
                                                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                                    <Setter Property="RowDefinition.Height" Value="100"/>
                                                                                </Trigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </RowDefinition.Style>
                                                                </RowDefinition>
                                                                <RowDefinition Height="17" />
                                                            </Grid.RowDefinitions>

                                                            <Border Name="PART_RibbonBarBorder" Margin="3,0,3,0"
                                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                                    >
                                                                <Border Name="PART_PresenterBorder" Grid.Row="0">
                                                                    <ItemsPresenter />
                                                                </Border>
                                                            </Border>


                                                            <Border Name="PART_headerBorder"
                                                                    Grid.Row="1"
                                                                    Background="{TemplateBinding Background}">
                                                                <DockPanel>
                                                                    <tools_controls:RibbonButton Name="PART_DialogLauncherButton"
                                                                                        Width="15" 
                                                                                        ToolTipService.ShowOnDisabled="{Binding Path=(ToolTipService.ShowOnDisabled),RelativeSource={RelativeSource TemplatedParent}}"
                                                                                        Height="14"
                                                                                        Command="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                          Path=LauncherCommand}"
                                                                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                   Path=LauncherCommandParameter}"
                                                                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                                                                Path=LauncherCommandTarget}"
                                                                                        DockPanel.Dock="Right"
                                                                                        SizeForm="ExtraSmall"
                                                                                        SmallIcon="{TemplateBinding CollapseImage}"
                                                                                        Style="{StaticResource RibbonBarLauncherButton}"
                                                                                        ToolTip="{TemplateBinding LauncherToolTip}"
                                                                                        Visibility="{TemplateBinding IsLauncherButtonVisible,
                                                                                                                     Converter={StaticResource BooleanToVisibilityConverter}}" />
                                                                    <TextBlock VerticalAlignment="Center"
                                                                               Foreground="{DynamicResource ContentForegroundBrush}"
                                                                               Text="{TemplateBinding Header}"
                                                                               TextAlignment="Center" />
                                                                </DockPanel>
                                                            </Border>
                                                        </Grid>
                                                    </Grid>
                                                </Border>
                                            </tools_controls:DropDownButton>
                                        </Grid>
                                    </Border>
                                </Border>

                                <Line Grid.Column="1" x:Name="barLine"
                                      Width="1"
                                      Stroke="{StaticResource BorderBrush}"
                                      X1="1"
                                      Y1="87"
                                      Y2="1" >

                                </Line>
                            </Grid>
                            <ControlTemplate.Triggers>

                                <Trigger Property="PanelState" Value="Collapsed">
                                    <Setter TargetName="PART_RibbonDropDownButton" Property="Visibility" Value="Visible" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Y1" Value="120" TargetName="barLine"/>
                                </Trigger>



                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="IsLargeButtonPanel" Value="true">
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate>
                            <tools_controls:LargeButtonPanel />
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonBarStyle}" TargetType="{x:Type tools_controls:RibbonBar}" />



    <!--  EmptyCheckBoxFocusVisual  -->
    <Style x:Key="EmptyCheckBoxFocusVisual">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle Margin="1"
                               SnapsToDevicePixels="true"
                               Stroke="{StaticResource GlyphBrush}"
                               StrokeDashArray="1 2"
                               StrokeThickness="1" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  CheckRadioFocusVisual  -->
    <Style x:Key="CheckRadioFocusVisual">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle Margin="14,0,0,0"
                               SnapsToDevicePixels="true"
                               Stroke="{StaticResource GlyphBrush}"
                               StrokeDashArray="1 2"
                               StrokeThickness="1" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>











    <!--  ComboBoxEditableTextBox Style  -->
    <Style x:Key="ComboBoxEditableTextBox" TargetType="{x:Type TextBox}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="AllowDrop" Value="true" />
        <Setter Property="MinWidth" Value="0" />
        <Setter Property="MinHeight" Value="0" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <ScrollViewer x:Name="PART_ContentHost"
                                  Background="{TemplateBinding Background}"
                                  Focusable="False"
                                  HorizontalScrollBarVisibility="Hidden"
                                  VerticalScrollBarVisibility="Hidden" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <Style x:Key="Office2013RibbonComboBoxItemStyle" TargetType="{x:Type tools_controls:RibbonComboBoxItem}">
        <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
        <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
        <Setter Property="Padding" Value="2,2,2,2" />
        <Setter Property="BorderThickness" Value="1" />

        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonComboBoxItem}">
                    <Border Name="Bd"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="0"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
                        <ContentPresenter x:Name="content"
                                          Grid.Column="1"
                                          Margin="{TemplateBinding Padding}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsHighlighted" Value="true">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
							<Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource ActiveBorderBrush}" />
                            <Setter TargetName="Bd" Property="BorderThickness" Value="{StaticResource MenuItemBorderThickness}"/>
							<Setter Property="Foreground" Value="{StaticResource ActiveForegroundBrush}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Opacity" Value="0.5" />
                        </Trigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Padding" Value="3" />
                            <Setter Property="FontSize" Value="16" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonComboBoxItemStyle}" TargetType="{x:Type tools_controls:RibbonComboBoxItem}" />

    <Style x:Key="Office2013ComboBoxEditableTextBox" TargetType="{x:Type TextBox}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="AllowDrop" Value="true" />
        <Setter Property="MinWidth" Value="0" />
        <Setter Property="MinHeight" Value="0" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <ScrollViewer x:Name="PART_ContentHost"
                                  Background="Transparent"
                                  Focusable="false"
                                  HorizontalScrollBarVisibility="Hidden"
                                  VerticalScrollBarVisibility="Hidden" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
   
    <Style x:Key="Office2013ComboBoxReadonlyToggleButton" TargetType="{x:Type ToggleButton}">
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="IsTabStop" Value="false" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Background" Value="{DynamicResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="ClickMode" Value="Press" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">

                    <Border Name="Chrome1"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="true">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" SharedSizeGroup="ComboBoxButton" />
                            </Grid.ColumnDefinitions>

                            <Border Name="Chrome"
                                    Grid.Column="1"
                                    Width="14"
                                    Margin="0"
                                    BorderBrush="Transparent"
                                    BorderThickness="1,0,0,0">

                                <Path Name="Arrow"
                                      Width="5"
                                      Height="3"
                                      Margin="0,1,0,0"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Data="{StaticResource Office2013DropDownPath}"
                                      Fill="{StaticResource GlyphBrush}"
                                      Opacity="1"
                                      Stretch="Fill" />

                            </Border>
                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>

                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                            <Setter TargetName="Chrome" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
                        </Trigger>

                        <Trigger SourceName="Chrome1" Property="IsMouseOver" Value="True">

                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                            <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger SourceName="Chrome" Property="IsMouseOver" Value="True">

                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                            <Setter TargetName="Chrome" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                            <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <Trigger SourceName="Chrome1" Property="IsKeyboardFocusWithin" Value="True">
                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                            <Setter TargetName="Chrome" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                        </Trigger>

                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsChecked" Value="True" />
                                <Condition Property="IsMouseOver" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                            <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                        </MultiTrigger>

                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Opacity" Value="0.5" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ComboBoxFocusVisual">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle Margin="4,4,21,4"
                               SnapsToDevicePixels="true"
                               Stroke="{StaticResource GlyphBrush}"
                               StrokeDashArray="1 2"
                               StrokeThickness="1" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="Office2013RibbonComboBoxStyle" TargetType="{x:Type tools_controls:RibbonComboBox}">
        <Setter Property="FocusVisualStyle" Value="{StaticResource ComboBoxFocusVisual}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />

        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="Padding" Value="2,3" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonComboBox}">
                    <Grid>
                        <ToggleButton x:Name="ToggleButton"
                                      Grid.Column="2"
                                      ClickMode="Press"
                                      Focusable="false"
                                      IsChecked="{Binding Path=IsDropDownOpen,
                                                          Mode=TwoWay,
                                                          RelativeSource={RelativeSource TemplatedParent}}"
                                      Style="{StaticResource Office2013ComboBoxReadonlyToggleButton}" />
                        <ContentPresenter x:Name="ContentSite"
                                          Margin="3,3,23,3"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Center"
                                          Content="{TemplateBinding SelectionBoxItem}"
                                          ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                          IsHitTestVisible="False" />

                        <TextBox x:Name="PART_EditableTextBox"
                                 Margin="1,3,23,3"
                                 HorizontalAlignment="Left"
                                 VerticalAlignment="Center"
                                 Background="Transparent"
                                 Focusable="True"
                                 IsReadOnly="{TemplateBinding IsReadOnly}"
                                 Style="{StaticResource Office2013ComboBoxEditableTextBox}"
                                 Visibility="Hidden" />

                        <Popup x:Name="Popup"
                               AllowsTransparency="True"
                               Focusable="False"
                               IsOpen="{TemplateBinding IsDropDownOpen}"
                               Placement="Bottom"
                               PopupAnimation="Slide">
                            <Microsoft_Windows_Aero:SystemDropShadowChrome Name="Shdw" Color="Transparent">
                                <Border x:Name="DropDownBorder"
                                        Background="{StaticResource ContentBackgroundBrush}"
                                        BorderBrush="{StaticResource ContentBorderBrush}"
                                        BorderThickness="1">
                                    <Grid x:Name="DropDown"
                                          MinWidth="{TemplateBinding ActualWidth}"
                                          MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                          SnapsToDevicePixels="True">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <ScrollViewer Margin="1,2,1,2" x:Name="PART_ScrollViewer"
                                                      CanContentScroll="True"
                                                      HorizontalScrollBarVisibility="Auto"
                                                      SnapsToDevicePixels="True"
                                                      VerticalScrollBarVisibility="Auto">
                                            <ItemsPresenter x:Name="ItemsPresenter"
                                                            KeyboardNavigation.DirectionalNavigation="Contained"
                                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                        </ScrollViewer>
                                    </Grid>
                                </Border>
                            </Microsoft_Windows_Aero:SystemDropShadowChrome>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasItems" Value="false">
                            <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                        <Trigger Property="IsGrouping" Value="true">
                            <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
                        </Trigger>
                        <Trigger SourceName="Popup" Property="AllowsTransparency" Value="true">
                            <Setter TargetName="DropDownBorder" Property="Margin" Value="0,0,0,0" />
                        </Trigger>
                        <Trigger Property="IsEditable" Value="true">
                            <Setter Property="IsTabStop" Value="false" />
                            <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible" />
                            <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden" />
                        </Trigger>
                        <Trigger SourceName="Popup" Property="Popup.HasDropShadow" Value="true">
                            <Setter TargetName="Shdw" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="Shdw" Property="Color" Value="#BCBCBC" />
                        </Trigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Height" Value="28"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEditable" Value="true">
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
                <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
                <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
                <Setter Property="IsTabStop" Value="false" />
                <Setter Property="Padding" Value="3" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ComboBox}">
                            <Grid>
                                <ToggleButton x:Name="ToggleButton"
                                              Grid.Column="2"
                                              ClickMode="Press"
                                              Focusable="false"
                                              IsChecked="{Binding Path=IsDropDownOpen,
                                                                  Mode=TwoWay,
                                                                  RelativeSource={RelativeSource TemplatedParent}}"
                                              Style="{StaticResource Office2013ComboBoxReadonlyToggleButton}" />
                                <ContentPresenter x:Name="ContentSite"
                                                  Margin="3,3,23,3"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Center"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                  ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                  IsHitTestVisible="False" />

                                <TextBox x:Name="PART_EditableTextBox"
                                         Margin="1,3,23,3"
                                         HorizontalAlignment="Left"
                                         VerticalAlignment="Center"
                                         Background="Transparent"
                                         Focusable="True"
                                         IsReadOnly="{TemplateBinding IsReadOnly}"
                                         Style="{StaticResource Office2013ComboBoxEditableTextBox}"
                                         Visibility="Hidden" />

                                <Popup x:Name="Popup"
                                       AllowsTransparency="True"
                                       Focusable="False"
                                       IsOpen="{TemplateBinding IsDropDownOpen}"
                                       Placement="Bottom"
                                       PopupAnimation="Slide">
                                    <Microsoft_Windows_Aero:SystemDropShadowChrome Name="Shdw" Color="Transparent">
                                        <Grid x:Name="DropDown"
                                              MinWidth="{TemplateBinding ActualWidth}"
                                              MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                              SnapsToDevicePixels="True">
                                            <Border x:Name="DropDownBorder"
                                                    Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1" />
                                            <ScrollViewer Margin="1,2,1,2" x:Name="PART_ScrollViewer"
                                                          CanContentScroll="True"
                                                          HorizontalScrollBarVisibility="Auto"
                                                          SnapsToDevicePixels="True"
                                                          VerticalScrollBarVisibility="Auto">
                                                <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                            </ScrollViewer>
                                        </Grid>
                                    </Microsoft_Windows_Aero:SystemDropShadowChrome>
                                </Popup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="HasItems" Value="false">
                                    <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                </Trigger>
                                <Trigger Property="IsGrouping" Value="true">
                                    <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
                                </Trigger>
                                <Trigger SourceName="Popup" Property="AllowsTransparency" Value="true">
                                    <Setter TargetName="DropDownBorder" Property="Margin" Value="0,0,0,0" />
                                </Trigger>
                                <Trigger Property="IsEditable" Value="true">
                                    <Setter Property="IsTabStop" Value="false" />
                                    <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible" />
                                    <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden" />
                                </Trigger>
                                <Trigger SourceName="Popup" Property="Popup.HasDropShadow" Value="true">
                                    <Setter TargetName="Shdw" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="Shdw" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Height"  Value="28"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonComboBoxStyle}" TargetType="{x:Type tools_controls:RibbonComboBox}" />


    <!--  SeparatorStyle  -->
    <Style x:Key="SeparatorStyle" TargetType="Separator">
        <Setter Property="Border.BorderThickness" Value="0,0,0,1" />
        <Setter Property="FrameworkElement.MinHeight" Value="2" />
        <Setter Property="UIElement.SnapsToDevicePixels" Value="True" />
        <Setter Property="Margin" Value="30,0,0,0" />
        <Setter Property="Background" Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="Separator">
                    <Border Margin="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True" />
                    <ControlTemplate.Triggers>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            
                            <Setter Property="Padding" Value="14,0,0,0"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <!--  RibbonContextMenuItems  -->
    <ItemsControl x:Key="RibbonContextMenuItems">
        <tools_controls:RibbonMenuItem Command="tools_controls:RibbonCommands.RemoveItemFromQAT"
                              CommandTarget="{Binding Path=PlacementTarget,
                                                      RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonContextMenu}}}"
                              Header="{Binding Source={StaticResource ResourceWrapperKey},
                                               Path=RemoveFromQAT}"
                              Tag="Remove"
                              Visibility="Collapsed" />
        <tools_controls:RibbonMenuItem Command="tools:RibbonCommands.AddItemToQAT"
                              CommandTarget="{Binding Path=PlacementTarget,
                                                      RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonContextMenu}}}"
                              Header="{Binding Source={StaticResource ResourceWrapperKey},
                                               Path=AddToQAT}"
                              Tag="Item_One"
                              Visibility="Collapsed" />
        <Separator Style="{StaticResource SeparatorStyle}" Tag="Item_Two" />
        <tools_controls:RibbonMenuItem Command="tools_controls:RibbonCommands.QATMoreCommands"
                              CommandTarget="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}"
                              Header="{Binding Source={StaticResource ResourceWrapperKey},
                                               Path=CustomizeQATContextMenu}"
                              Tag="Item_Three"
                              Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}},
                                                   Path=EnableMoreCommands,
                                                   Converter={StaticResource BooleanToVisibilityConverter}}" />
        <tools_controls:RibbonMenuItem Command="tools_controls:RibbonCommands.PlaceQATAbove"
                              CommandTarget="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}"
                              Header="{Binding Source={StaticResource ResourceWrapperKey},
                                               Path=QATShowAbove}"
                              Tag="Item_Four"
                              Visibility="Collapsed" />
        <tools_controls:RibbonMenuItem Command="tools_controls:RibbonCommands.PlaceQATBelow"
                              CommandTarget="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}"
                              Header="{Binding Source={StaticResource ResourceWrapperKey},
                                               Path=QATShowBelow}"
                              Tag="Item_Five" />
        <Separator Style="{StaticResource SeparatorStyle}" Tag="Item_Six" />
        <tools_controls:RibbonMenuItem Margin="0,0,0,0"
                              Command="tools_controls:RibbonCommands.MinimizeRibbon"
                              CommandTarget="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}"
                              Header="{Binding Source={StaticResource ResourceWrapperKey},
                                               Path=MinimizeRibbon}"
                              Tag="Item_Seven">
            <tools_controls:RibbonMenuItem.Icon>
                <Path Stroke="{StaticResource GlyphBrush}" StrokeThickness="1.4">
                    <Path.Data>
                        <GeometryGroup>
                            <LineGeometry StartPoint="6 9" EndPoint="9 16" />
                            <LineGeometry StartPoint="9 16" EndPoint="13 3" />
                        </GeometryGroup>
                    </Path.Data>
                </Path>
            </tools_controls:RibbonMenuItem.Icon>
        </tools_controls:RibbonMenuItem>
    </ItemsControl>


    <!--  RibbonContextMenu Style  -->
    <Style x:Key="Office2013RibbonContextMenuStyle" TargetType="{x:Type tools_controls:RibbonContextMenu}">
        <Setter Property="Panel.Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="TextElement.FontFamily" Value="Tahoma" />
        <Setter Property="TextElement.FontSize" Value="18" />
        <Setter Property="TextElement.FontStyle" Value="Normal" />
        <Setter Property="TextElement.FontWeight" Value="Normal" />
        <Setter Property="StaysOpen" Value="False" />
        <Setter Property="MenuItem.Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Control.VerticalContentAlignment" Value="Center" />
        <Setter Property="Border.BorderThickness" Value="1,1,1,1" />
        <Setter Property="Border.BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Control.Padding" Value="1,1,1,1" />
        <Setter Property="Grid.IsSharedSizeScope" Value="True" />
        <Setter Property="ContextMenuService.HasDropShadow" Value="True" />
        <Setter Property="UIElement.SnapsToDevicePixels" Value="True" />
        <Setter Property="ItemContainerStyle" Value="{DynamicResource Office2013RibbonMenuItemStyle}"/>
        <Setter Property="ItemsSource" Value="{Binding Source={StaticResource RibbonContextMenuItems}, Path=Items}" />
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonContextMenu}">
                    <Microsoft_Windows_Luna:SystemDropShadowChrome Name="Shdw"
                                                                     SnapsToDevicePixels="True"
                                                                     Color="#00FFFFFF">
                        <Border Background="{TemplateBinding Panel.Background}"
                                BorderBrush="{TemplateBinding Border.BorderBrush}"
                                BorderThickness="{TemplateBinding Border.BorderThickness}">
                            <Border.Effect>
                                <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                            </Border.Effect>
                            <Grid>

                                <ScrollViewer Grid.ColumnSpan="2"
                                              Margin="0"
                                              CanContentScroll="True"
                                              Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer,
                                                                                            TypeInTargetAssembly=FrameworkElement}}">
                                    <ItemsPresenter Margin="{TemplateBinding Control.Padding}"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
                                </ScrollViewer>
                            </Grid>
                        </Border>
                    </Microsoft_Windows_Luna:SystemDropShadowChrome>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ContextMenuService.HasDropShadow" Value="True">
                            <Setter TargetName="Shdw" Property="FrameworkElement.Margin" Value="0,0,5,5" />
                            <Setter TargetName="Shdw" Property="Microsoft_Windows_Luna:SystemDropShadowChrome.Color" Value="#BCBCBC" />
                        </Trigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="MenuItem.FontSize" Value="18"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonContextMenuStyle}" TargetType="{x:Type tools_controls:RibbonContextMenu}" />

    <!--  GalleryFilterSelector Style  -->
    <Style x:Key="{x:Type tools_controls:GalleryFilterSelector}" TargetType="{x:Type tools_controls:GalleryFilterSelector}">
        <Setter Property="Visibility" Value="Collapsed" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:GalleryFilterSelector}">
                    <Grid>
                        <Border Name="PART_DropDownButton"
                                Height="15"
                                Background="{StaticResource ContentBackgroundBrush}"
                                BorderBrush="{StaticResource ContentBorderBrush}"
                                BorderThickness="0,0,0,1">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Margin="10,0,0,0"
                                           VerticalAlignment="Center"
                                           FontSize="12"
                                           FontStyle="Normal"
                                           Text="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                         AncestorType={x:Type tools_controls:GalleryFilterSelector}},
                                                          Path=SelectedFilter.Label}" />
                                <Path Margin="1"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Data="M 0 0 L 4 4 L 8 0 Z"
                                      Fill="{StaticResource GlyphBrush}" />
                            </StackPanel>
                        </Border>
                        <Popup Name="PART_Popup"
                               AllowsTransparency="True"
                               Focusable="False"
                               IsOpen="{Binding Path=IsDropDownOpen,
                                                Mode=TwoWay,
                                                RelativeSource={RelativeSource AncestorType={x:Type tools_controls:GalleryFilterSelector}}}"
                               Placement="Bottom"
                               PopupAnimation="Fade"
                               StaysOpen="False">
                            <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow" SnapsToDevicePixels="True">
                                <tools_controls:RibbonButtonChecker CheckedButton="{Binding Mode=TwoWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:GalleryFilterSelector}}, Converter={StaticResource FilterToRibbonButtonConverter}, Path=SelectedFilter}" ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:GalleryFilterSelector}}, Converter={StaticResource GalleryFilterConverter}, ConverterParameter={StaticResource RibbonButtonPopupItemStyle}, Path=Filters}" />
                            </Microsoft_Windows_Luna:SystemDropShadowChrome>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                            <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=HasFilters}" Value="True">
                <Setter Property="Filters" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=GalleryFilters}" />
                <Setter Property="SelectedFilter" Value="{Binding Mode=TwoWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=CurrentFilter}" />
                <Setter Property="Visibility" Value="Visible" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!--  RibbonButtonChecker Style  -->
    <Style x:Key="{x:Type tools_controls:RibbonButtonChecker}" TargetType="{x:Type tools_controls:RibbonButtonChecker}">
        <Setter Property="MinWidth" Value="120" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonButtonChecker}">
                    <Border Background="{StaticResource ContentBackgroundBrush}"
                            BorderBrush="{StaticResource ContentBorderBrush}"
                            BorderThickness="1">
                        <ItemsPresenter />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  PopupResizeThumb Style  -->
    <ControlTemplate TargetType="{x:Type tools_controls:PopupResizeThumb}" x:Key="VerticalPopupResizeThumbTemplate">
        <Border Width="20"
				Height="10"
				HorizontalAlignment="Center"
				VerticalAlignment="Center"
				Background="Transparent">
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                <Path Margin="1,1,0,0"
					  HorizontalAlignment="Center"
					  VerticalAlignment="Center"
					  Data="M0,0L2,0 2,2 0,2z M5,0L7,0 7,2 5,2z M10,0L12,0 12,2 10,2z M15,0L17,0 17,2 15,2z"
					  Fill="{StaticResource GlyphBrush}" />
                <Path Margin="0,0,1,1"
					  HorizontalAlignment="Center"
					  VerticalAlignment="Center"
					  Data="M0,0L2,0 2,2 0,2z M5,0L7,0 7,2 5,2z M10,0L12,0 12,2 10,2z M15,0L17,0 17,2 15,2z"
					  Fill="{StaticResource GlyphBrush}" />
            </Grid>
        </Border>

        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Cursor" Value="SizeNS" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>
    <Style x:Key="{x:Type tools_controls:PopupResizeThumb}" TargetType="{x:Type tools_controls:PopupResizeThumb}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:PopupResizeThumb}">
                    <Border Width="10"
                            Height="10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Background="Transparent">
                        <Grid Width="6" Height="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.5*" />
                                <ColumnDefinition Width="0.5*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0.5*" />
                                <RowDefinition Height="0.5*" />

                            </Grid.RowDefinitions>
                            <Border Grid.Row="1"
                                    Grid.Column="1"
                                    Width="2"
                                    Height="2"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Background="#FFA7A7A7" />
                            <Border Grid.Row="1"
                                    Grid.Column="0"
                                    Width="2"
                                    Height="2"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom"
                                    Background="#FFA7A7A7" />
                            <Border Grid.Row="0"
                                    Grid.Column="1"
                                    Width="2"
                                    Height="2"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Background="#FFA7A7A7" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Cursor" Value="SizeNWSE" />
                        </Trigger>
                        <Trigger Property="FlowDirection" Value="RightToLeft">
                            <Setter Property="Cursor" Value="SizeNESW" />
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="HorizontalAlignment" Value="Right" />

    </Style>

    <!--  LabelTextBlock Style  -->
    <Style x:Key="{x:Type tools_controls:LabelTextBlock}" TargetType="{x:Type tools_controls:LabelTextBlock}">
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="Margin" Value="0,-2,0,0" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Style.Triggers>

            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
        </Style.Triggers>
    </Style>


    <!--  GalleryRepeatButtonStyle  -->
    <Style x:Key="GalleryDownRepeatButtonStyle" TargetType="Button">
        <Setter Property="ClickMode" Value="Press" />
        <Setter Property="Width" Value="16" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Name="OuterBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Opacity="{TemplateBinding Opacity}">
                        <Grid>
                            <Path Width="5"
                                  Height="3"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z "
                                  Fill="{StaticResource GlyphBrush}"
                                  Stretch="Fill" />
                        </Grid>

                    </Border>
                    <ControlTemplate.Triggers>


                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />

                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="GalleryUpRepeatButtonStyle" TargetType="Button">
        <Setter Property="ClickMode" Value="Press" />
        <Setter Property="Width" Value="16" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Name="OuterBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Opacity="{TemplateBinding Opacity}">
                        <Grid>
                            <Path Width="5"
                                  Height="3"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                  Fill="{StaticResource GlyphBrush}"
                                  RenderTransformOrigin="0.5,0.5"
                                  Stretch="Fill">

                                <Path.RenderTransform>
                                    <RotateTransform Angle="180" />
                                </Path.RenderTransform>

                            </Path>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>

                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />

                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5" />
            </Trigger>
        </Style.Triggers>
    </Style>


    <!--  GalleryItem template  -->
    <Style x:Key="Office2013GalleryItemStyle" TargetType="{x:Type tools_controls:RibbonGalleryItem}">
        <Setter Property="ClickMode" Value="Release" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonGalleryItem}">
                    <Border Name="PART_TrippleBorder"
                            MinWidth="0"
                            Background="Transparent"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="1"
                            SnapsToDevicePixels="True">
                        <Grid>
                            <ContentPresenter MinWidth="0"
                                              Margin="1,0,1,0"
                                              HorizontalAlignment="Stretch"
                                              VerticalAlignment="Stretch"
                                              ContentSource="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="true">


                            <Setter TargetName="PART_TrippleBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="true">


                            <Setter TargetName="PART_TrippleBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsFocused" Value="true">
                            <Setter TargetName="PART_TrippleBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsChecked" Value="True" />
                            </MultiTrigger.Conditions>

                            <Setter TargetName="PART_TrippleBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                        </MultiTrigger>
                        <Trigger Property="IsPressed" Value="true">

                            <Setter TargetName="PART_TrippleBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style BasedOn="{StaticResource Office2013GalleryItemStyle}" TargetType="{x:Type tools_controls:RibbonGalleryItem}" />
 

    <!--  RibbonStatusBar Style  -->
    <Style x:Key="Office2013RibbonStatusBarStyle" TargetType="{x:Type tools_controls:RibbonStatusBar}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonStatusBar}">
                    <Border Height="{TemplateBinding Height}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            ClipToBounds="True">
                        <Border>
                            <ItemsPresenter x:Name="PART_Presenter" />
                        </Border>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Background" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}},
                                                 Path=BackStageColor}"/>

        <Setter Property="Height" Value="22" />
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonStatusBarStyle}" TargetType="{x:Type tools_controls:RibbonStatusBar}" />



    <!--  RibbonGallery Style  -->
    <Style x:Key="Office2013GalleryStyle" TargetType="{x:Type tools_controls:RibbonGallery}">
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="ItemMouseOverBorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Margin" Value="1" />
        <Setter Property="Height" Value="62" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonGallery}">
                    <Border Height="{TemplateBinding Height}"
                            MaxHeight="62"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="16" />
                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <Button Name="PART_ScrollUpButton"
                                        Grid.Row="0"
                                        Margin="0,-1,-2,0"
                                        BorderThickness="1"
                                        Style="{StaticResource GalleryUpRepeatButtonStyle}" />

                                <Button Name="PART_ScrollDownButton"
                                        Grid.Row="1"
                                        Margin="0,-1,-2,-1"
                                        BorderThickness="1"
                                        Style="{StaticResource GalleryDownRepeatButtonStyle}" />

                                <Border Name="PART_ToggleButton"
                                        Grid.Row="2"
                                        Width="16"
                                        Height="20.5"
                                        Margin="0,0,-2,-1"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="{StaticResource ContentBackgroundBrush}"
                                        BorderBrush="{StaticResource ContentBorderBrush}"
                                        BorderThickness="1">
                                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Path Margin="0,0,0,2"
                                              HorizontalAlignment="Center"
                                              Data="M0,0.5L7,0.5"
                                              Stroke="{StaticResource GlyphBrush}" />
                                        <Path Width="5"
                                              Height="3"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                              Fill="{StaticResource GlyphBrush}"
                                              Stretch="Fill" />
                                    </StackPanel>
                                </Border>
                            </Grid>
                            <tools_controls:InRibbonItemsPresenter Name="PART_ScrollPresenter"
                                                          Margin="1"
                                                          ClipToBounds="True" />
                            <Popup Name="PART_Popup"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{Binding Path=IsDropDownOpen,
                                                    Mode=TwoWay,
                                                    RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonGallery}}}"
                                   Placement="Custom"
                                   PopupAnimation="Fade"
                                   StaysOpen="False">
                                <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow" SnapsToDevicePixels="True">
                                    <Border Background="{DynamicResource ContentBackgroundBrush}"
                                            BorderBrush="{DynamicResource ContentBorderBrush}"
                                            BorderThickness="1">
                                        <DockPanel SnapsToDevicePixels="True">
                                            <Border Name="PART_ThumbBorder"
                                                    Background="Transparent"
                                                    DockPanel.Dock="Bottom">
                                                <tools_controls:PopupResizeThumb IsTabStop="False" Name="PART_ResizeThumb" HorizontalAlignment="Right" />
                                            </Border>
                                            <tools_controls:GalleryFilterSelector DockPanel.Dock="Top" />
                                            <Grid DockPanel.Dock="Top">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition MinHeight="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=ItemHeight}" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <ScrollViewer Name="PART_ScrollViewer" Grid.Row="0">
                                                    <StackPanel>
                                                        <ItemsControl Name="PART_PopupItemsControl">
                                                            <ItemsControl.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <WrapPanel IsItemsHost="True"
                                                                               ItemHeight="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                                   AncestorType={x:Type tools_controls:RibbonGallery}},
                                                                                                    Path=ItemHeight}"
                                                                               ItemWidth="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                                  AncestorType={x:Type tools_controls:RibbonGallery}},
                                                                                                   Path=ItemWidth}" />
                                                                </ItemsPanelTemplate>
                                                            </ItemsControl.ItemsPanel>
                                                        </ItemsControl>
                                                    </StackPanel>
                                                </ScrollViewer>
                                                <tools_controls:RibbonMenuGroup Grid.Row="1"
                                                                       IconBarEnabled="{TemplateBinding MenuIconBarEnabled}"
                                                                       ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                            AncestorType={x:Type tools_controls:RibbonGallery}},
                                                                                             Path=MenuItems}"
                                                                       Visibility="{TemplateBinding MenuItems,
                                                                                                    Converter={StaticResource CountToVisibilityConverter}}" />
                                            </Grid>
                                        </DockPanel>
                                    </Border>
                                </Microsoft_Windows_Luna:SystemDropShadowChrome>
                            </Popup>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                            <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                        </Trigger>
                        <Trigger SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True">

                            <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                        </Trigger>

                        <Trigger Property="HasGroups" Value="True">
                            <Setter TargetName="PART_PopupItemsControl" Property="ItemsPanel">
                                <Setter.Value>
                                    <ItemsPanelTemplate>
                                        <tools_controls:GalleryGroupPanel KeyboardNavigation.AcceptsReturn="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                    </ItemsPanelTemplate>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="ResizeDirection" Value="HorizontalAndVertical">
                            <Setter TargetName="PART_Popup" Property="Width" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=HorizontalOffset}" />
                            <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                        </Trigger>
                        <Trigger Property="ResizeDirection" Value="VerticalOnly">
                            <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                            <Setter TargetName="PART_ResizeThumb" Property="Template" Value="{StaticResource VerticalPopupResizeThumbTemplate}" />
                            <Setter TargetName="PART_ResizeThumb" Property="HorizontalAlignment" Value="Center" />
                        </Trigger>
                        <Trigger Property="PopupPosition" Value="Above">
                            <Setter TargetName="PART_ThumbBorder" Property="DockPanel.Dock" Value="Top" />
                            <Setter TargetName="PART_ScrollViewer" Property="DockPanel.Dock" Value="Bottom" />
                            <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                <Setter.Value>
                                    <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Cursor" Value="SizeNESW" TargetName="PART_ResizeThumb" />
                        </Trigger>
                        <Trigger Property="ResizeDirection" Value="NoResize">
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ResizeThumb"/>
                        </Trigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=PopupPosition}" Value="Above"/>
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=FlowDirection}" Value="RightToLeft"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                <Setter.Value>
                                    <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Cursor" Value="SizeNWSE" TargetName="PART_ResizeThumb" />
                        </MultiDataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <WrapPanel Background="Transparent"
                               ClipToBounds="True"
                               ItemHeight="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                   AncestorType={x:Type tools_controls:RibbonGallery}},
                                                    Path=ItemHeight}"
                               ItemWidth="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                  AncestorType={x:Type tools_controls:RibbonGallery}},
                                                   Path=ItemWidth}" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="SizeForm" Value="Large" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonGallery}">
                            <Border Name="PART_OuterBorder"
                                    BorderBrush="Transparent"
                                    BorderThickness="0">
                                <StackPanel>
                                    <Border Name="PART_ToggleButton"
                                            Height="{TemplateBinding Height}"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1">
                                        <StackPanel>
                                            <Image Width="32"
                                                   Height="32"
                                                   Margin="0,1,0,0"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Top"
                                                   Source="{Binding Path=LargeIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                            <tools_controls:CustomItemsControl ItemsSource="{Binding Path=Label, Mode=OneWay, Converter={StaticResource TextWrappingConverter}, RelativeSource={RelativeSource TemplatedParent}}" Path="{StaticResource Path}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <tools_controls:MultilinePanel />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                            </tools_controls:CustomItemsControl>
                                        </StackPanel>
                                    </Border>

                                    <Popup Name="PART_Popup"
                                           MinWidth="{TemplateBinding ExpandWidth}"
                                           MinHeight="{TemplateBinding ExpandHeight}"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            Mode=TwoWay,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonGallery}}}"
                                           Placement="Custom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">

                                        <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow"
                                                                    ClipToBounds="True"
                                                                    SnapsToDevicePixels="True">

                                            <Border Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">

                                                <DockPanel LastChildFill="True" SnapsToDevicePixels="True">

                                                    <Border Name="PART_ThumbBorder"
                                                            Background="Transparent"
                                                            DockPanel.Dock="Bottom">
                                                        <tools_controls:PopupResizeThumb Name="PART_ResizeThumb" HorizontalAlignment="Right" />
                                                    </Border>

                                                    <tools_controls:GalleryFilterSelector DockPanel.Dock="Top" />

                                                    <Grid DockPanel.Dock="Top">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition MinHeight="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=ItemHeight}" />
                                                            <RowDefinition Height="Auto" MinHeight="0" />
                                                        </Grid.RowDefinitions>
                                                        <ScrollViewer Grid.Row="0">
                                                            <ItemsPresenter VerticalAlignment="Top" />
                                                        </ScrollViewer>

                                                        <tools_controls:RibbonMenuGroup Grid.Row="1"
                                                                               IconBarEnabled="{TemplateBinding MenuIconBarEnabled}"
                                                                               ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                                    AncestorType={x:Type tools_controls:RibbonGallery}},
                                                                                                     Path=MenuItems}"
                                                                               Visibility="{TemplateBinding MenuItems,
                                                                                                            Converter={StaticResource CountToVisibilityConverter}}" />
                                                    </Grid>
                                                </DockPanel>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>

                                <Trigger Property="ResizeDirection" Value="HorizontalAndVertical">
                                    <Setter TargetName="PART_Popup" Property="Width" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=HorizontalOffset}" />
                                    <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                                </Trigger>

                                <Trigger Property="ResizeDirection" Value="VerticalOnly">
                                    <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                                    <Setter TargetName="PART_ResizeThumb" Property="Template" Value="{StaticResource VerticalPopupResizeThumbTemplate}" />
                                    <Setter TargetName="PART_ResizeThumb" Property="HorizontalAlignment" Value="Center" />
                                </Trigger>

                                <Trigger Property="PopupPosition" Value="Above">
                                    <Setter TargetName="PART_ThumbBorder" Property="DockPanel.Dock" Value="Top" />
                                    <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                        <Setter.Value>
                                            <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Cursor" Value="SizeNESW" TargetName="PART_ResizeThumb" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PART_OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="ResizeDirection" Value="NoResize">
                                    <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ResizeThumb"/>
                                </Trigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=PopupPosition}" Value="Above"/>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=FlowDirection}" Value="RightToLeft"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                        <Setter.Value>
                                            <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Cursor" Value="SizeNWSE" TargetName="PART_ResizeThumb" />
                                </MultiDataTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="SizeForm" Value="Small" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonGallery}">
                            <Border Name="PART_OuterBorder"
                                    BorderBrush="Transparent"
                                    BorderThickness="0"
                                    IsEnabled="{TemplateBinding IsEnabled}"
                                    Opacity="{TemplateBinding Opacity}">
                                <Border Name="PART_ToggleButton"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        IsEnabled="{TemplateBinding IsEnabled}"
                                        Opacity="{TemplateBinding Opacity}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Column="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center">
                                            <Image Width="16"
                                                   Height="16"
                                                   Margin="2"
                                                   Source="{Binding Path=SmallIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Border>
                                        <TextBlock Grid.Column="1"
                                                   Margin="2,0,2,0"
                                                   VerticalAlignment="Center"
                                                   Foreground="{TemplateBinding Foreground}"
                                                   Text="{TemplateBinding Label}" />
                                        <Path Grid.Column="2"
                                              Width="5"
                                              Height="3"
                                              Margin="1"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Data="{StaticResource Office2013DropDownPath}"
                                              Fill="{StaticResource GlyphBrush}"
                                              Stretch="Fill" />
                                        <Popup Name="PART_Popup"
                                               MinWidth="{TemplateBinding ExpandWidth}"
                                               MinHeight="{TemplateBinding ExpandHeight}"
                                               AllowsTransparency="True"
                                               Focusable="False"
                                               IsOpen="{Binding Path=IsDropDownOpen,
                                                                Mode=TwoWay,
                                                                RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonGallery}}}"
                                               Placement="Custom"
                                               PopupAnimation="Fade"
                                               StaysOpen="False">

                                            <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow"
                                                                        ClipToBounds="True"
                                                                        SnapsToDevicePixels="True">

                                                <Border Background="{StaticResource ContentBackgroundBrush}"
                                                        BorderBrush="{StaticResource ContentBorderBrush}"
                                                        BorderThickness="1">

                                                    <DockPanel LastChildFill="True" SnapsToDevicePixels="True">

                                                        <Border Name="PART_ThumbBorder"
                                                                Background="Transparent"
                                                                DockPanel.Dock="Bottom">
                                                            <tools_controls:PopupResizeThumb Name="PART_ResizeThumb" HorizontalAlignment="Right" />
                                                        </Border>

                                                        <tools_controls:GalleryFilterSelector DockPanel.Dock="Top" />

                                                        <Grid DockPanel.Dock="Top">
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition MinHeight="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=ItemHeight}" />
                                                                <RowDefinition Height="Auto" MinHeight="0" />
                                                            </Grid.RowDefinitions>
                                                            <ScrollViewer Grid.Row="0">
                                                                <ItemsPresenter VerticalAlignment="Top" />
                                                            </ScrollViewer>

                                                            <tools_controls:RibbonMenuGroup Grid.Row="1"
                                                                                   IconBarEnabled="{TemplateBinding MenuIconBarEnabled}"
                                                                                   ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                                        AncestorType={x:Type tools_controls:RibbonGallery}},
                                                                                                         Path=MenuItems}"
                                                                                   Visibility="{TemplateBinding MenuItems,
                                                                                                                Converter={StaticResource CountToVisibilityConverter}}" />
                                                        </Grid>
                                                    </DockPanel>
                                                </Border>
                                            </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                        </Popup>
                                    </Grid>
                                </Border>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>

                                <Trigger Property="ResizeDirection" Value="HorizontalAndVertical">
                                    <Setter TargetName="PART_Popup" Property="Width" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=HorizontalOffset}" />
                                    <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                                </Trigger>

                                <Trigger Property="ResizeDirection" Value="VerticalOnly">
                                    <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                                    <Setter TargetName="PART_ResizeThumb" Property="Template" Value="{StaticResource VerticalPopupResizeThumbTemplate}" />
                                    <Setter TargetName="PART_ResizeThumb" Property="HorizontalAlignment" Value="Center" />
                                </Trigger>

                                <Trigger Property="PopupPosition" Value="Above">
                                    <Setter TargetName="PART_ThumbBorder" Property="DockPanel.Dock" Value="Top" />
                                    <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                        <Setter.Value>
                                            <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Cursor" Value="SizeNESW" TargetName="PART_ResizeThumb" />

                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PART_OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="ResizeDirection" Value="NoResize">
                                    <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ResizeThumb"/>
                                </Trigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=PopupPosition}" Value="Above"/>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=FlowDirection}" Value="RightToLeft"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                        <Setter.Value>
                                            <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Cursor" Value="SizeNWSE" TargetName="PART_ResizeThumb" />
                                </MultiDataTrigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="SizeForm" Value="ExtraSmall" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonGallery}">
                            <Border Name="PART_OuterBorder"
                                    Width="33"
                                    Height="23"
                                    BorderBrush="Transparent"
                                    BorderThickness="0">
                                <Border Name="PART_ToggleButton"
                                        Width="33"
                                        Height="23" Margin="0,-1,0,0"
                                        Background="{TemplateBinding Panel.Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Column="0" Width="18"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center">
                                            <Image Width="16"
                                                   Height="16"
                                                   Margin="1"
                                                   Source="{Binding Path=SmallIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Border>
                                        <Path Grid.Column="1"
                                              Width="5"
                                              Height="3"
                                              Margin="1"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Data="{StaticResource Office2013DropDownPath}"
                                              Fill="{StaticResource GlyphBrush}"
                                              Stretch="Fill" />
                                        <Popup Name="PART_Popup"
                                               MinWidth="{TemplateBinding ExpandWidth}"
                                               MinHeight="{TemplateBinding ExpandHeight}"
                                               AllowsTransparency="True"
                                               Focusable="False"
                                               IsOpen="{Binding Path=IsDropDownOpen,
                                                                Mode=TwoWay,
                                                                RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonGallery}}}"
                                               Placement="Bottom"
                                               PopupAnimation="Fade"
                                               StaysOpen="False">

                                            <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow"
                                                                        ClipToBounds="True"
                                                                        SnapsToDevicePixels="True">

                                                <Border VerticalAlignment="Stretch"
                                                        Background="{StaticResource ContentBackgroundBrush}"
                                                        BorderBrush="{StaticResource ContentBorderBrush}"
                                                        BorderThickness="1">

                                                    <DockPanel VerticalAlignment="Stretch" SnapsToDevicePixels="True">

                                                        <Border Name="PART_ThumbBorder"
                                                                Background="Transparent"
                                                                DockPanel.Dock="Bottom">
                                                            <tools_controls:PopupResizeThumb Name="PART_ResizeThumb" HorizontalAlignment="Right" />
                                                        </Border>

                                                        <tools_controls:GalleryFilterSelector DockPanel.Dock="Top" />

                                                        <Grid DockPanel.Dock="Top">
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition MinHeight="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonGallery}}, Path=ItemHeight}" />
                                                                <RowDefinition Height="Auto" MinHeight="0" />
                                                            </Grid.RowDefinitions>
                                                            <ScrollViewer Grid.Row="0">
                                                                <ItemsPresenter VerticalAlignment="Top" />
                                                            </ScrollViewer>
                                                            <tools_controls:RibbonMenuGroup Grid.Row="1"
                                                                                   IconBarEnabled="{TemplateBinding MenuIconBarEnabled}"
                                                                                   ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                                        AncestorType={x:Type tools_controls:RibbonGallery}},
                                                                                                         Path=MenuItems}"
                                                                                   Visibility="{TemplateBinding MenuItems,
                                                                                                                Converter={StaticResource CountToVisibilityConverter}}" />
                                                        </Grid>
                                                    </DockPanel>
                                                </Border>
                                            </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                        </Popup>
                                    </Grid>
                                </Border>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PART_OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="ResizeDirection" Value="HorizontalAndVertical">
                                    <Setter TargetName="PART_Popup" Property="Width" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=HorizontalOffset}" />
                                    <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                                </Trigger>
                                <Trigger Property="ResizeDirection" Value="VerticalOnly">
                                    <Setter TargetName="PART_Popup" Property="Height" Value="{Binding ElementName=PART_ResizeThumb, Mode=TwoWay, Path=VerticalOffset}" />
                                    <Setter TargetName="PART_ResizeThumb" Property="Template" Value="{StaticResource VerticalPopupResizeThumbTemplate}" />
                                    <Setter TargetName="PART_ResizeThumb" Property="HorizontalAlignment" Value="Center" />
                                </Trigger>
                                <Trigger Property="PopupPosition" Value="Above">
                                    <Setter TargetName="PART_ThumbBorder" Property="DockPanel.Dock" Value="Top" />
                                    <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                        <Setter.Value>
                                            <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Cursor" Value="SizeNESW" TargetName="PART_ResizeThumb" />

                                </Trigger>
                                <Trigger Property="ResizeDirection" Value="NoResize">
                                    <Setter Property="Visibility" Value="Collapsed" TargetName="PART_ResizeThumb"/>
                                </Trigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=PopupPosition}" Value="Above"/>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource Self},Path=FlowDirection}" Value="RightToLeft"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="RenderTransform" TargetName="PART_ResizeThumb">
                                        <Setter.Value>
                                            <RotateTransform Angle="270" CenterX="5" CenterY="5"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="Cursor" Value="SizeNWSE" TargetName="PART_ResizeThumb" />
                                </MultiDataTrigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="IsMouseOver" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="IsDropDownOpen" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                <Setter Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="HasGroups" Value="True" />
                </MultiTrigger.Conditions>
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate>
                            <tools_controls:GalleryGroupPanel KeyboardNavigation.AcceptsReturn="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="VisualMode" Value="DropDown" />
                    <Condition Property="IsEnabled" Value="False" />
                </MultiTrigger.Conditions>
                <Setter Property="Opacity" Value="0.65" />

            </MultiTrigger>

        </Style.Triggers>
    </Style>
    <Style BasedOn="{StaticResource Office2013GalleryStyle}" TargetType="{x:Type tools_controls:RibbonGallery}" />


    <!--  RibbonListBox Style  -->
    <Style x:Key="Office2013RibbonListBoxStyle" TargetType="{x:Type tools_controls:RibbonListBox}">
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="3,7,3,0" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBox}">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="1"
                            SnapsToDevicePixels="true">
                        <ScrollViewer Focusable="false" Padding="{TemplateBinding Padding}">
                            <ScrollViewer.Style>
                                <Style TargetType="{x:Type ScrollViewer}">
                                    <Setter Property="OverridesDefaultStyle" Value="True" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="*" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Rectangle x:Name="Corner"
                                                               Grid.Row="1"
                                                               Grid.Column="1"
                                                               Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                                    <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                                            Grid.Row="0"
                                                                            Grid.Column="0"
                                                                            Margin="{TemplateBinding Padding}"
                                                                            CanContentScroll="{TemplateBinding CanContentScroll}"
                                                                            CanHorizontallyScroll="False"
                                                                            CanVerticallyScroll="False"
                                                                            Content="{TemplateBinding Content}"
                                                                            ContentTemplate="{TemplateBinding ContentTemplate}" />
                                                    <ScrollBar x:Name="PART_VerticalScrollBar"
                                                               Grid.Row="0"
                                                               Grid.Column="1"
                                                               AutomationProperties.AutomationId="VerticalScrollBar"
                                                               Cursor="Arrow"
                                                               Maximum="{TemplateBinding ScrollableHeight}"
                                                               Minimum="0"
                                                               ViewportSize="{TemplateBinding ViewportHeight}"
                                                               Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                                               Value="{Binding Path=VerticalOffset,
                                                                               Mode=OneWay,
                                                                               RelativeSource={RelativeSource TemplatedParent}}" />
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ScrollViewer.Style>
                            <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </ScrollViewer>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                        </Trigger>
                        <Trigger Property="IsGrouping" Value="true">
                            <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonListBoxStyle}" TargetType="{x:Type tools_controls:RibbonListBox}" />

    <!--  ApplicationMenuGroup Style  -->

    <Style x:Key="{x:Type tools_controls:ApplicationMenuGroup}" TargetType="{x:Type tools_controls:ApplicationMenuGroup}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:ApplicationMenuGroup}">
                    <tools_controls:LayoutPanel x:Name="PART_LayoutPanel" Width="{TemplateBinding ActualWidth}">
                        <StackPanel Margin="1,0,1,1" HorizontalAlignment="Stretch">
                            <Border Name="PART_Header"
                                    Height="21"
                                    Margin="0,0,0,2"
                                    HorizontalAlignment="Stretch"
                                    Background="{StaticResource HeaderBackgroundBrush}"
                                    Padding="7,0,5,0"
                                    SnapsToDevicePixels="True">
                                <TextBlock VerticalAlignment="Center"
                                           FontSize="{TemplateBinding FontSize}"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource HeaderForegroundBrush}"
                                           Text="{TemplateBinding Header}" />
                            </Border>
                            <ItemsPresenter x:Name="PART_Presenter"
                                            Margin="0,0,0,1"
                                            KeyboardNavigation.DirectionalNavigation="Contained"
                                            KeyboardNavigation.TabNavigation="Contained"
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </StackPanel>
                        <Border Width="22"
                                Height="{TemplateBinding ActualHeight}"
                                Margin="1,1,1,1"
                                HorizontalAlignment="Left"
                                Panel.ZIndex="-1"
                                Background="Transparent"
                                Visibility="{TemplateBinding IconBarEnabled,
                                                             Converter={StaticResource BooleanToVisibilityConverter}}" />
                    </tools_controls:LayoutPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasHeader" Value="False">
                            <Setter TargetName="PART_Header" Property="Height" Value="1" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  RibbonMenuGroup Style  -->
    <Style x:Key="Office2013RibbonMenuGroupStyle" TargetType="{x:Type tools_controls:RibbonMenuGroup}">
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonMenuGroup}">
                    <tools_controls:LayoutPanel x:Name="PART_LayoutPanel" >
                        <StackPanel Margin="1,0,1,1" HorizontalAlignment="Stretch">
                            <Border Name="PART_Header"
                                    Height="21"
                                    Margin="0,0,0,2"
                                    HorizontalAlignment="Stretch"
                                    Background="{StaticResource ContentBackgroundBrush}"
                                    Padding="7,0,5,0"
                                    SnapsToDevicePixels="True">
                                <TextBlock VerticalAlignment="Center"
                                           FontSize="{TemplateBinding FontSize}"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource ContentForegroundBrush}"
                                           Text="{TemplateBinding Header}" />
                            </Border>
                            <ItemsPresenter x:Name="PART_Presenter"
                                            Margin="0,0,0,1"
                                            KeyboardNavigation.DirectionalNavigation="Contained"
                                            KeyboardNavigation.TabNavigation="Contained"
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </StackPanel>
                        <!--  <Border BorderThickness="0,0,1,0"  Visibility="{TemplateBinding IconBarEnabled, Converter={StaticResource BooleanToVisibilityConverter}}"  Margin="1,1,1,1" Background="Transparent" BorderBrush="{DynamicResource IconBarSeperatorBrush}" Height="{TemplateBinding ActualHeight}" Width="22" Panel.ZIndex="-1" HorizontalAlignment="Left"/>  -->
                    </tools_controls:LayoutPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasHeader" Value="False">
                            <Setter TargetName="PART_Header" Property="Height" Value="1" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonMenuGroupStyle}" TargetType="{x:Type tools_controls:RibbonMenuGroup}" />

    <Style x:Key="Office2013RibbonGalleryGroupStyle" TargetType="{x:Type tools_controls:RibbonGalleryGroup}">

        <Setter Property="Background" Value="{DynamicResource ContentBackgroundBrush}" />

        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Height" Value="21" />
        <Setter Property="IsTabStop" Value="False"/>
        <!--
            <Setter Property="FontSize" Value="11.5"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        -->
        <Setter Property="FontStyle" Value="Normal" />
        <Setter Property="FontWeight" Value="Bold" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonGalleryGroup}">
                    <Border Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="7,0,0,0">
                        <TextBlock HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                   VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                   FlowDirection="{TemplateBinding FlowDirection}"
                                   FontFamily="{TemplateBinding FontFamily}"
                                   FontSize="{TemplateBinding FontSize}"
                                   FontStyle="{TemplateBinding FontStyle}"
                                   FontWeight="{TemplateBinding FontWeight}"
                                   Foreground="{TemplateBinding Foreground}"
                                   Text="{TemplateBinding Label}" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonGalleryGroupStyle}" TargetType="{x:Type tools_controls:RibbonGalleryGroup}" />
    <!--  RibbonPage Style  -->
    <Style TargetType="{x:Type tools_controls:RibbonPage}">
        <Setter Property="Margin" Value="0,25,0,0" />
        <Setter Property="FontSize" Value="11.5" />
        <Setter Property="FontFamily" Value="Segoe UI" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonPage}">
                    <AdornerDecorator x:Name="PART_Adorner">
                        <Grid>
                            <Border Name="PART_MainBorder"
                                    Background="{TemplateBinding Background}"
                                    BorderThickness="1">
                                <DockPanel HorizontalAlignment="Stretch"
                                           VerticalAlignment="Stretch"
                                           Background="Transparent">
                                    <ContentPresenter Content="{TemplateBinding StatusBar}" DockPanel.Dock="Bottom" />
                                    <AdornerDecorator Panel.ZIndex="100" DockPanel.Dock="Top">
                                        <ContentPresenter Content="{TemplateBinding Ribbon}" />
                                    </AdornerDecorator>
                                    <ContentPresenter Content="{TemplateBinding Content}" DockPanel.Dock="Bottom" />
                                </DockPanel>
                            </Border>
                        </Grid>
                    </AdornerDecorator>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  RibbonRadioButton Style  -->



    <Style x:Key="Office2013RibbonCheckBoxStyle" TargetType="{x:Type tools_controls:RibbonCheckBox}">
        <Setter Property="Foreground" Value="{DynamicResource ContentForegroundBrush}" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Padding" Value="2,1,1,1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonCheckBox}">

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="15" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Border x:Name="border1"
                                Width="13"
                                Height="13"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                            <Path x:Name="Path"
                                  Width="8"
                                  Height="8"
                                  Margin="1,1,0,0"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  Data="M10.738967,0 L11.817,1.1360061 5.1774399,7.4388217 5.1789999,7.4406547 4.0474274,8.5560006 0,3.7727338 1.1959616,2.7609998 4.1605471,6.244079 z"
                                  Fill="{StaticResource GlyphBrush}"
                                  Opacity="0"
                                  SnapsToDevicePixels="True"
                                  Stretch="Fill" />
                        </Border>

                        <ContentPresenter Grid.Column="1"
                                          Margin="{TemplateBinding Padding}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="HasContent" Value="true">
                            <Setter Property="FocusVisualStyle" Value="{StaticResource CheckRadioFocusVisual}" />
                            <Setter Property="Padding" Value="2,1,0,0" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="Path" Property="Opacity" Value="1" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsEnabled" Value="True" />
                                <Condition Property="IsMouseOver" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="border1" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                            <Setter TargetName="border1" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="Path" Property="Fill" Value="#FF858585" />
                        </MultiTrigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border1" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                            <Setter TargetName="border1" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonCheckBoxStyle}" TargetType="{x:Type tools_controls:RibbonCheckBox}" />

    <!--  RadioButton Brushes  -->

    <Style x:Key="Office2013RibbonRadioButtonStyle" TargetType="{x:Type tools_controls:RibbonRadioButton}">
        <Setter Property="Foreground" Value="{DynamicResource ContentForegroundBrush}" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="BorderThickness" Value="1.3" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonRadioButton}">
                    <BulletDecorator Background="Transparent">
                        <BulletDecorator.Bullet>
                            <Grid>
                                <Ellipse x:Name="border1"
                                         Width="13"
                                         Height="13"
                                         HorizontalAlignment="Center"
                                         VerticalAlignment="Center"
                                         Fill="{TemplateBinding Background}"
                                         SnapsToDevicePixels="True"
                                         Stroke="{TemplateBinding BorderBrush}"
                                         StrokeThickness="{TemplateBinding BorderThickness}" />
                                <Ellipse x:Name="ellipse"
                                         Width="5"
                                         Height="5"
                                         HorizontalAlignment="Center"
                                         VerticalAlignment="Center"
                                         Fill="{StaticResource GlyphBrush}"
                                         Opacity="0"
                                         SnapsToDevicePixels="True" />
                            </Grid>
                        </BulletDecorator.Bullet>
                        <ContentPresenter Margin="{TemplateBinding Padding}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True" />
                    </BulletDecorator>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasContent" Value="true">
                            <Setter Property="FocusVisualStyle" Value="{StaticResource CheckRadioFocusVisual}" />
                            <Setter Property="Padding" Value="2,1,0,0" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="ellipse" Property="Opacity" Value="1" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsEnabled" Value="True" />
                                <Condition Property="IsMouseOver" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="border1" Property="Stroke" Value="{DynamicResource HoverGlyphBrush}" />
                            <Setter TargetName="border1" Property="Fill" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="ellipse" Property="Fill" Value="#FF3A3E42" />
                        </MultiTrigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border1" Property="Stroke" Value="{DynamicResource ActiveGlyphBrush}" />
                            <Setter TargetName="border1" Property="Fill" Value="{DynamicResource ActiveBackgroundBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonRadioButtonStyle}" TargetType="{x:Type tools_controls:RibbonRadioButton}" />

    <!--  RibbonScrollingButton style  -->
    <Style x:Key="RibbonScrollingButton" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="PART_Border"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Stretch"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            IsEnabled="{TemplateBinding IsEnabled}"
                            Opacity="{TemplateBinding Opacity}"
                            SnapsToDevicePixels="True">

                        <Path x:Name="PART_Path"
                              Margin="3,16,-2,0"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="{StaticResource Office2013RibbonTabArrowPath}"
                              Fill="{StaticResource GlyphBrush}"
                              Stroke="{StaticResource GlyphBrush}"
                              StrokeThickness="2">
                            <Path.RenderTransform>
                                <RotateTransform Angle="-90" />
                            </Path.RenderTransform>
                        </Path>

                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Tag" Value="Left">
                            <Setter TargetName="PART_Path" Property="Margin" Value="6,0,-5,0" />
                            <Setter TargetName="PART_Path" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="90" />
                                </Setter.Value>
                            </Setter>


                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="PART_Border" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="PART_Border" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5" />
            </Trigger>
        </Style.Triggers>
    </Style>


   
    <!--  RibbonSeparator Style  -->
    <Style TargetType="{x:Type tools_controls:RibbonSeparator}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Width" Value="4" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonSeparator}">
                    <Rectangle Width="1"
                               Height="55"
                               Fill="{StaticResource GlyphBrush}" />

                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Margin" Value="3,5,3,0" />
        <!--
            <Style.Triggers>
            <Trigger Property="Parent" Value="tools"
            </Style.Triggers>
        -->
    </Style>
    <SolidColorBrush x:Key="Office2013TexBoxBackground" Color="#FFFFFFFF" />
    <SolidColorBrush x:Key="Office2013TextBoxBorderBrush" Color="#FFABABAB" />
    <!--  RibbonTextBox Style  -->
    <Style TargetType="{x:Type tools_controls:RibbonTextBox}">
        <Setter Property="Background" Value="{DynamicResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{DynamicResource ContentBorderBrush}" />
        <Setter Property="Foreground" Value="{DynamicResource ContentForegroundBrush}" />

        <Setter Property="KeyboardNavigation.TabNavigation" Value="None" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="2,3,2,2" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="AllowDrop" Value="true" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonTextBox}">
                    <Border x:Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="0"
                            SnapsToDevicePixels="true">
                        <ScrollViewer x:Name="PART_ContentHost" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="1" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">
                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Content="{TemplateBinding Content}"
                                          RecognizesAccessKey="False"
                                          SnapsToDevicePixels="True" />
                    </Border>
                    <ControlTemplate.Triggers>

                        <!--
                            <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBrush}"/>
                            
                            
                            </Trigger>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:TitleButtonAdorner}}, Path=IsPressed}" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource PressedBrush}"/>
                            
                            </DataTrigger>
                        -->
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="CloseButtonStyle" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">
                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Path x:Name="closepath"
                              Width="8"
                              Height="8"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="F1 M 531.513,330.307L 531.513,328.635L 533.185,328.635L 533.185,325.293L 529.842,325.293L 529.842,326.964L 528.171,326.964L 528.171,328.598L 524.828,328.598L 524.828,326.964L 523.157,326.964L 523.157,325.293L 519.814,325.293L 519.814,328.635L 521.485,328.635L 521.485,330.307L 523.157,330.307L 523.157,333.612L 521.485,333.612L 521.485,335.284L 519.814,335.284L 519.814,338.626L 523.157,338.626L 523.157,336.955L 524.828,336.955L 524.828,335.284L 528.171,335.284L 528.171,336.955L 529.842,336.955L 529.842,338.626L 533.185,338.626L 533.185,335.284L 531.513,335.284L 531.513,333.612L 529.842,333.612L 529.842,330.307L 531.513,330.307 Z "
                              Fill="{StaticResource GlyphBrush}"
                              Stretch="Fill" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsActive}" Value="False">
                            <Setter TargetName="closepath" Property="Fill" Value="#FFB1B1B1" />
                        </DataTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="closepath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="closepath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="MinimizeButtonStyle" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">
                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Path x:Name="minpath"
                              Width="9"
                              Height="2"
                              Margin="2,0,0,0"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Data="M0.5,0.5 L8.5,0.5 L8.5,2.5 L0.5,2.5 z"
                              Fill="{StaticResource GlyphBrush}"
                              SnapsToDevicePixels="True"
                              Stretch="Fill"
                              Stroke="{StaticResource GlyphBrush}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsActive}" Value="False">
                            <Setter TargetName="minpath" Property="Fill" Value="#FFB1B1B1" />
                            <Setter TargetName="minpath" Property="Stroke" Value="#FFB1B1B1" />
                        </DataTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="minpath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="minpath" Property="Stroke" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="minpath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="minpath" Property="Stroke" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="FullScreenButtonStyle" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">
                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid Width="12" Height="10">
                            <Border x:Name="border1"
                                    Width="8"
                                    Height="6"
                                    Background="Transparent" 
                                    BorderBrush="#FF7C7C7C"
                                    BorderThickness="1">
                                <Border x:Name="innerborder"
                                        BorderBrush="#FFC8C8C8"
                                        BorderThickness="1" />
                            </Border>
                            <Border x:Name="topleft"
                                    Width="3"
                                    Height="3"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Background="Transparent"
                                    BorderBrush="#FF7C7C7C"
                                    BorderThickness="1,1,0,0" />
                            <Border x:Name="topright"
                                    Width="3"
                                    Height="3"
                                    HorizontalAlignment="right"
                                    VerticalAlignment="Top"
                                    Background="Transparent"
                                    BorderBrush="#FF7C7C7C"
                                    BorderThickness="0,1,1,0" />
                            <Border x:Name="bottomright"
                                    Width="3"
                                    Height="3"
                                    HorizontalAlignment="right"
                                    VerticalAlignment="Bottom"
                                    Background="Transparent"
                                    BorderBrush="#FF7C7C7C"
                                    BorderThickness="0,0,1,1" />
                            <Border x:Name="bottomleft"
                                    Width="3"
                                    Height="3"
                                    HorizontalAlignment="left"
                                    VerticalAlignment="Bottom"
                                    Background="Transparent"
                                    BorderBrush="#FF7C7C7C"
                                    BorderThickness="1,0,0,1" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="innerborder" Property="BorderBrush" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                            <Setter TargetName="topleft" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="topright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="bottomright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="bottomleft" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="innerborder" Property="BorderBrush" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                            <Setter TargetName="topleft" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="topright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="bottomright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="bottomright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="HelpButtonStyle" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">
                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid Width="12" Height="15">
                            <Path x:Name="helppath"
                                  Width="7" FlowDirection="LeftToRight"
                                  Height="10"
                                  VerticalAlignment="Center"
                                  Data="M2.665,10.712 L6.5560003,10.712 6.5560003,13.333 2.665,13.333 z M1.3892639,0 L7.9436465,0 7.9436465,1.2838589 9.3330002,1.2838589 9.3330002,5.2447653 8.0557032,5.2447653 8.0557032,6.5832839 6.6664386,6.5832839 6.6664386,9.3170004 2.7232096,9.3170004 2.7232096,6.694613 3.9998672,6.694613 3.9998672,5.3000946 5.3331332,5.3000946 5.3331332,2.5670581 2.6665716,2.5670581 2.6665716,3.9615762 0,3.9615762 0,1.2838589 1.3332658,1.2838589 z"
                                  Fill="{StaticResource GlyphBrush}"
                                  Stretch="Fill" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsActive}" Value="False">
                            <Setter TargetName="helppath" Property="Fill" Value="#FFB1B1B1" />
                        </DataTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="helppath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="helppath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="NormalButtonStyle" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">

                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">

                        <Grid Width="10" Height="10">

                            <Border x:Name="border1"
                                    Width="8"
                                    Height="7"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Background="Transparent"
                                    BorderBrush="{StaticResource GlyphBrush}"
                                    BorderThickness="1,2,1,1" />
                            <Border x:Name="border2"
                                    Width="8"
                                    Height="7"
                                    Margin="0,3,2,0"
                                    Background="{StaticResource ContentBackgroundBrush}"
                                    BorderBrush="{StaticResource GlyphBrush}"
                                    BorderThickness="1,2,1,1" />


                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsActive}" Value="False">
                            <Setter TargetName="border1" Property="BorderBrush" Value="#FFB1B1B1" />
                            <Setter TargetName="border2" Property="BorderBrush" Value="#FFB1B1B1" />
                        </DataTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                        </Trigger>
                        <!--<DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:TitleButtonAdorner}}, Path=IsMouseOver}" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                            <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                        </DataTrigger>-->
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="MaximizeButtonStyle" TargetType="{x:Type tools_controls:WindowTitleBarButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="false" />
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:WindowTitleBarButton}">

                    <Border x:Name="PART_Border"
                            Panel.ZIndex="100"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">

                        <Border x:Name="maxpath"
                                Width="10"
                                Height="10"
                                BorderBrush="{StaticResource GlyphBrush}"
                                BorderThickness="1,3,1,1"
                                SnapsToDevicePixels="True" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsActive}" Value="False">
                            <Setter TargetName="maxpath" Property="BorderBrush" Value="#FFB1B1B1" />
                        </DataTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            <Setter TargetName="maxpath" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                        <!--<DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:TitleButtonAdorner}}, Path=IsMouseOver}" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                            <Setter TargetName="maxpath" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonWindow}}, Path=BackStageColor}" />

                        </DataTrigger>-->
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter TargetName="maxpath" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
	
<Style TargetType="{x:Type shared:TemplatedAdornerInternalControl}">
        <Setter Property="Height" Value="0" />
        <Setter Property="Width" Value="0" />
    </Style>



    <!--<Style x:Key="{x:Type tools:TitleButtonAdorner}" TargetType="{x:Type shared:TemplatedAdornerInternalControl}">
        <Setter Property="Height" Value="29" />
        <Setter Property="Width" Value="22" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type shared:TemplatedAdornerInternalControl}">
                    <Border Background="White">
                        <Border Name="PART_Border"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}"
                                CornerRadius="3">
                            <ContentPresenter Content="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:TitleButtonAdorner}}, Path=Content}" IsHitTestVisible="False" />
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                          <Trigger Property="IsMouseOver" Value="True"/>  




                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>-->

  
    <!--  TitleBar Style  -->
    <Style x:Key="TitleBarStyleKey" TargetType="{x:Type tools_controls:TitleBar}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="ClipToBounds" Value="False" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:TitleBar}">

                    <Border Margin="0,0,0,0"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <Border HorizontalAlignment="Stretch">
                                <Grid HorizontalAlignment="Right">


                                    <Image Grid.Column="1"
                                           Width="500"
                                           HorizontalAlignment="Right"
                                           Opacity="0.2"
                                           Source="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}},
                                                            Path=TitleBarPatternImage}"
                                           Stretch="fill" />
                                </Grid>
                            </Border>
                            <Grid Name="GlassActive" Height="{TemplateBinding Height}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="15" />
                                    <ColumnDefinition Width="{Binding Path=QATColumnWidth, Converter={StaticResource DoubleToGridLengthConverter}, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="{Binding Path=SysButtonsColumnWidth, Converter={StaticResource DoubleToGridLengthConverter}, RelativeSource={RelativeSource TemplatedParent}}" />
                                </Grid.ColumnDefinitions>

                                <Grid Grid.Column="2" Margin="10,0,10,10">

                                    <TextBlock Name="PART_Title"
                                               Grid.Column="2"
                                               MaxWidth="{TemplateBinding TitleMaxWidth}"
                                               Margin="0,5,0,0"
                                               HorizontalAlignment="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                            AncestorType={x:Type tools_controls:RibbonWindow}},
                                                                             Path=TitleTextAlignment}"
                                               VerticalAlignment="Top"
                                               FontFamily="{TemplateBinding FontFamily}"
                                               FontSize="{TemplateBinding FontSize}"
                                               Foreground="{DynamicResource ContentForegroundBrush}"
                                               Text="{TemplateBinding Title}" />
                                </Grid>
                                <Image x:Name="Part_SysIcon"
                                       Width="16"
                                       Height="16"
                                       Margin="8,5,-9,0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Top"
                                       shared_windows:WindowChrome.IsHitTestVisibleInChrome="True"
                                       Source="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                       AncestorType={x:Type tools_controls:RibbonWindow}},
                                                        Path=Office2010Icon}"
                                       Stretch="Fill" >
                                    
                                </Image>

                                <StackPanel x:Name="stack"
                                            Grid.Column="3"
                                            Margin="0,3,0,0"
                                            VerticalAlignment="Top" HorizontalAlignment="Right" 
                                            Orientation="Horizontal">
                                    <tools_controls:WindowTitleBarButton x:Name="HelpButton"
                                                                Width="29"
                                                                Height="22"
                                                                Style="{StaticResource HelpButtonStyle}"
                                                               
                                                                Visibility="{Binding RelativeSource={RelativeSource FindAncestor,
                                                                                                                    AncestorType={x:Type tools_controls:RibbonWindow}},
                                                                                     Path=ShowHelpButton,
                                                                                     Converter={StaticResource BooleanToVisibilityConverter}}">

                                    </tools_controls:WindowTitleBarButton>
                                    <!-- <tools:WindowTitleBarButton x:Name="FullScreenButton"
                                                                Width="29"
                                                                Height="22"
                                                                Style="{StaticResource FullScreenButtonStyle}"
                                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=FullScreenTooltip}"> 
                                       
                                    </tools:WindowTitleBarButton> -->
                                    <tools_controls:WindowTitleBarButton x:Name="MinButton"
                                                                Width="29"
                                                                Height="22"
                                                                Style="{StaticResource MinimizeButtonStyle}"
                                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=MinimizeTooltip}">

                                    </tools_controls:WindowTitleBarButton>
                                    <tools_controls:WindowTitleBarButton x:Name="MaxButton"
                                                                Width="29"
                                                                Height="22"
                                                                Style="{StaticResource MaximizeButtonStyle}"
                                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=MaximizeTooltip}"
                                                                Visibility="Collapsed">


                                    </tools_controls:WindowTitleBarButton>
                                    <tools_controls:WindowTitleBarButton x:Name="NormalButton"
                                                                Width="29"
                                                                Height="22"
                                                                Style="{StaticResource NormalButtonStyle}"
                                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=RestoreTooltip}">


                                    </tools_controls:WindowTitleBarButton>
                                    <tools_controls:WindowTitleBarButton x:Name="CloseButton"
                                                                Width="29"
                                                                Height="22"
                                                                Command="Close"
                                                                Style="{StaticResource CloseButtonStyle}"
                                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=CloseTooltip}">

                                    </tools_controls:WindowTitleBarButton>
                                </StackPanel>

                            </Grid>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=Office2010Icon}" Value="{x:Null}">
                            <Setter TargetName="Part_SysIcon" Property="Visibility" Value="Collapsed" />

                        </DataTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsActive}" Value="False">
                            <Setter TargetName="PART_Title" Property="Foreground" Value="#FFB1B1B1" />
                        </DataTrigger>


                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="Part_SysIcon" Property="Margin" Value="5,5,-5,0" />
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="False" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="Part_SysIcon" Property="Margin" Value="5,8,-5,0" />
                            <Setter TargetName="stack" Property="Margin" Value="1,1,0,0" />
                        </MultiDataTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Normal">
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Visible" />

                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized">
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Visible" />

                        </DataTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Minimized">
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Visible" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=ResizeMode}" Value="CanMinimize">
                            <Setter TargetName="MaxButton" Property="IsEnabled" Value="False" />
                        </DataTrigger>
                        <!--
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:RibbonWindow}},  Path=ResizeMode}" Value="NoResize">
                            <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed"/>
                            <Setter Property="SysButtonsColumnWidth" Value="58"/>
                            </DataTrigger>
                            
                            
                            
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:RibbonWindow}},  Path=IsGlassActive}" Value="True">
                            <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="CloseButton" Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Normal" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="PART_Title" Property="BitmapEffect">
                                <Setter.Value>
                                    <OuterGlowBitmapEffect GlowColor="#FFFFFFFF"
                                                           GlowSize="14"
                                                           Opacity="1" />
                                </Setter.Value>
                            </Setter>
                        </MultiDataTrigger>

                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>

                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowStyle}" Value="ToolWindow" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="CloseButton" Property="Visibility" Value="Visible" />
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=MaximizedMode}" Value="KioskStyle" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowStyle}" Value="None" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="CloseButton" Property="Visibility" Value="Collapsed" />
                        </MultiDataTrigger>


                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowStyle}" Value="None" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="GlassActive" Property="Visibility" Value="Collapsed" />
                        </MultiDataTrigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Margin" TargetName="Part_SysIcon" Value="8,13,-9,0"/>
                        </Trigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch),RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}" Value="True"/>
                                <Condition Binding="{Binding IsQATBelow,RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}" Value="True"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Margin" TargetName="Part_SysIcon" Value="8,5,-9,0"/>
                        </MultiDataTrigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="False">
                <Setter Property="SysButtonsColumnWidth" Value="116" />
            </DataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="False" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=ShowHelpButton}" Value="false" />
                </MultiDataTrigger.Conditions>
                <Setter Property="SysButtonsColumnWidth" Value="116" />
            </MultiDataTrigger>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=ResizeMode}" Value="NoResize">
                <Setter Property="SysButtonsColumnWidth" Value="26" />
            </DataTrigger>

            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="False" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowStyle}" Value="ToolWindow" />
                </MultiDataTrigger.Conditions>
                <Setter Property="SysButtonsColumnWidth" Value="26" />
            </MultiDataTrigger>

            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=ResizeMode}" Value="CanResize" />
                </MultiDataTrigger.Conditions>
                <Setter Property="SysButtonsColumnWidth" Value="116" />
            </MultiDataTrigger>

            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=ResizeMode}" Value="CanResizeWithGrip" />
                </MultiDataTrigger.Conditions>
                <Setter Property="SysButtonsColumnWidth" Value="116" />
            </MultiDataTrigger>

            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowStyle}" Value="ToolWindow" />
                </MultiDataTrigger.Conditions>
                <Setter Property="SysButtonsColumnWidth" Value="20" />
            </MultiDataTrigger>

            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=WindowStyle}" Value="None" />
                </MultiDataTrigger.Conditions>
                <Setter Property="SysButtonsColumnWidth" Value="0" />
            </MultiDataTrigger>
        </Style.Triggers>
    </Style>


    <!--  RibbonWindow style  -->
    <Style x:Key="Office2013RibbonBackStageSeparatorStyle" TargetType="{x:Type tools_controls:BackStageSeparator}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:BackStageSeparator}">
                    <Grid MinHeight="24">
                        <Border Height="1"
                                Margin="21,0"
                                Background="{DynamicResource HoverBackgroundBrush}"
                                SnapsToDevicePixels="True" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style BasedOn="{StaticResource Office2013RibbonBackStageSeparatorStyle}" TargetType="{x:Type tools_controls:BackStageSeparator}" />

    <Style x:Key="Office2013RibbonWindowStyle" TargetType="{x:Type tools_controls:RibbonWindow}">
        <Setter Property="RibbonStatusBarStyle" Value="{StaticResource Office2013RibbonStatusBarStyle}" />
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="MinWidth" Value="150" />
        <Setter Property="MinHeight" Value="150" />
        <Setter Property="FontSize" Value="12" />
        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="ShowHelpButton" Value="True" />
        <Setter Property="Background" Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="TitleTextAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonWindow}">

                    <AdornerDecorator x:Name="PART_Adorner">

                        <Grid >
                            <Grid.LayoutTransform>
                                <ScaleTransform CenterX="0" CenterY="0" ScaleX="{Binding Path=ScaleX, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}" ScaleY="{Binding Path=ScaleY, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}" />
                            </Grid.LayoutTransform>
                            <Border Name="PART_MainBorder"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Padding="{TemplateBinding Padding}">
                                <Border x:Name="PART_Border">

                                    <DockPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <tools_controls:TitleBar x:Name="PART_TitleBar"
                                                        Title="{TemplateBinding Title}"
                                                        Height="52"
                                                        Margin="2,0,0,0"
                                                        DockPanel.Dock="Top"
                                                        Style="{StaticResource TitleBarStyleKey}" />
                                        <Grid>
                                            <DockPanel Background="{TemplateBinding Background}">
                                                <ContentPresenter Content="{TemplateBinding StatusBar}" DockPanel.Dock="Bottom" />

                                                <Grid DockPanel.Dock="Bottom">
                                                    <ContentPresenter Content="{TemplateBinding Content}" />
                                                    <ContentControl x:Name="BackStageContent"
                                                                    Content="{TemplateBinding BackStage}"
                                                                    Visibility="Collapsed">
                                                        <ContentControl.RenderTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform />
                                                                <TranslateTransform />
                                                            </TransformGroup>
                                                        </ContentControl.RenderTransform>
                                                    </ContentControl>
                                                </Grid>
                                            </DockPanel>

                                            <Label x:Name="PART_ResizeGrip"
                                                   HorizontalAlignment="Right"
                                                   VerticalAlignment="Bottom"
                                                   Cursor="SizeNWSE"
                                                   IsTabStop="False"
                                                   Visibility="Collapsed">
                                                <Grid Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                                                    <Path Data="M 9,1 L 11,1 L 11,3 L 9,3 Z M 5,5 L 7,5 L 7,7 L 5,7 Z M 9,5 L 11,5 L 11,7 L 9,7 Z M 1,9 L 3,9 L 3,11 L 1,11 Z M 5,9 L 7,9 L 7,11 L 5,11 Z M 9,9 L 11,9 L 11,11 L 9,11 Z" Fill="{StaticResource Blue.ResizeGripperForegroundLight}" />

                                                    <Path Data="M 8,0 L 10,0 L 10,2 L 8,2 Z M 4,4 L 6,4 L 6,6 L 4,6 Z M 8,4 L 10,4 L 10,6 L 8,6 Z M 0,8 L 2,8 L 2,10 L 0,10 Z M 4,8 L 6,8 L 6,10 L 4,10 Z M 8,8 L 10,8 L 10,10 L 8,10 Z" Fill="{StaticResource Blue.ResizeGripperForegroundDark}" />
                                                </Grid>
                                            </Label>
                                        </Grid>
                                    </DockPanel>
                                </Border>
                            </Border>
                        </Grid>
                    </AdornerDecorator>
                    <ControlTemplate.Triggers>

                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="ResizeMode" Value="CanResizeWithGrip" />
                                <Condition Property="WindowState" Value="Normal" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_ResizeGrip" Property="Visibility" Value="Visible" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="MaximizedMode" Value="KioskStyle" />
                                <Condition Property="WindowState" Value="Maximized" />
                                <Condition Property="WindowStyle" Value="None" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_TitleBar" Property="Visibility" Value="Collapsed" />
                            <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                        </MultiTrigger>
                        <Trigger Property="WindowState" Value="Maximized">
                            <Setter TargetName="PART_Border" Property="Margin">
                                <Setter.Value>
                                    <Thickness Bottom="{x:Static SystemParameters.ResizeFrameHorizontalBorderHeight}"
                                               Left="{x:Static SystemParameters.ResizeFrameVerticalBorderWidth}"
                                               Right="{x:Static SystemParameters.ResizeFrameVerticalBorderWidth}"
                                               Top="4" />
                                </Setter.Value>
                            </Setter>

                        </Trigger>
                       </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>


    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonWindowStyle}" TargetType="{x:Type tools_controls:RibbonWindow}" />

    <!--  ScreenTip Style  -->

    <Style x:Key="Office2013ScreenTipStyle" TargetType="{x:Type tools_controls:ScreenTip}">
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />

        <Setter Property="Padding" Value="1,1,3,1" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="HasDropShadow" Value="True" />
        <Setter Property="Template">
            <Setter.Value>


                <ControlTemplate TargetType="{x:Type tools_controls:ScreenTip}">
                    <Microsoft_Windows_Luna:SystemDropShadowChrome Name="Shdw"
                                                                     SnapsToDevicePixels="true"
                                                                     Color="Transparent">
                        <Border MinHeight="20"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="1.5*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                    <RowDefinition Height="Auto" />

                                </Grid.RowDefinitions>

                                <TextBlock Name="Desc"
                                           Grid.Row="0"
                                           Grid.ColumnSpan="2"
                                           Margin="4,4,1,4"
                                           FontFamily="Calibri"
                                           FontSize="12"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource ContentForegroundBrush}"
                                           Text="{TemplateBinding Description}" />
                                <StackPanel Grid.Row="1" Orientation="Horizontal">
                                    <Border Name="Image"
                                            Margin="6"
                                            VerticalAlignment="Center">
                                        <Image Source="{Binding Path=ImageSource, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Border>
                                    <ContentPresenter Name="Text"
                                                      Grid.Row="1"
                                                      Margin="2,1,4,6"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      TextBlock.Foreground="{StaticResource ContentForegroundBrush}" />
                                </StackPanel>
                                <Border Name="PART_Seperator"
                                        Grid.Row="2"
                                        Grid.ColumnSpan="2"
                                        Height="1"
                                        Margin="4,1,4,0"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Top"
                                        Background="{StaticResource ContentBorderBrush}"
                                        SnapsToDevicePixels="True" />
                                <Grid Grid.Row="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="20" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Border x:Name="HelpImage"
                                            Grid.Column="0"
                                            Margin="4,4,0,4"
                                            HorizontalAlignment="Left">
                                        <Image x:Name="helpImage"
                                               Width="16"
                                               Height="16"
                                               Source="{Binding Path=HelpIcon,
                                                                Mode=OneWay,
                                                                RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Border>
                                    <TextBlock Name="PART_HelpText"
                                               Grid.Column="0"
                                               Grid.ColumnSpan="2"
                                               Margin="28,4,1,4"
                                               HorizontalAlignment="Left"
                                               FontFamily="Calibri"
                                               FontSize="12"
                                               FontWeight="Bold"
                                               Foreground="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}},
                                                                    Path=BackStageColor}"
                                               Text="{TemplateBinding HelpText}" />
                                </Grid>
                            </Grid>
                        </Border>
                    </Microsoft_Windows_Luna:SystemDropShadowChrome>

                    <ControlTemplate.Triggers>
                        <Trigger Property="HasDropShadow" Value="true">
                            <Setter TargetName="Shdw" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="Shdw" Property="Color" Value="#BCBCBC" />
                        </Trigger>
                        <Trigger Property="HelpIcon" Value="{x:Null}">
                            <Setter TargetName="helpImage" Property="Source" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/HelpSmall.png" />
                        </Trigger>
                        <Trigger Property="Description" Value="">
                            <Setter TargetName="Desc" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="Text" Property="Margin" Value="4,1,4,1" />
                        </Trigger>
                        <Trigger Property="HelpText" Value="">

                            <Setter TargetName="HelpImage" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="PART_Seperator" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="PART_HelpText" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013ScreenTipStyle}" TargetType="{x:Type tools_controls:ScreenTip}" />
    <Style x:Key="Office2013ToolTipStyle"
           TargetType="{x:Type ToolTip}">
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />

        <Setter Property="Padding" Value="1,1,3,1" />



        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToolTip}">
                    <Microsoft_Windows_Aero:SystemDropShadowChrome Name="Shdw"
                                                  SnapsToDevicePixels="true"
                                                  Color="Transparent">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter Margin="2"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Border>
                    </Microsoft_Windows_Aero:SystemDropShadowChrome>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasDropShadow" Value="true">
                            <Setter TargetName="Shdw" Property="Margin" Value="0,0,3,3" />
                            <Setter TargetName="Shdw" Property="Color" Value="#BCBCBC" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013ToolTipStyle}" TargetType="{x:Type ToolTip}" />

   
    <!--  TabButton Style  -->
    <Style x:Key="Office2013TabButtonStyle" TargetType="{x:Type tools_controls:TabButton}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
        <Setter Property="FontFamily" Value="Calibri" />
        <Setter Property="FontSize" Value="14" />
        <Setter Property="Padding" Value="0,1,0,2" />
        <Setter Property="FontWeight" Value="Normal" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:TabButton}">
                    <Border x:Name="border"
                            Height="25"
                            Margin="0,0,0,0"
                            Background="{TemplateBinding Background}">
                        <Grid ClipToBounds="True">



                            <Border Name="center_Path"
                                    Height="25"
                                    Margin="0"
                                    Panel.ZIndex="100"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="1,1,1,0">


                                <Grid>
                                    <ContentPresenter x:Name="PART_CaptionContent"
                                                      Content="{TemplateBinding Content}"
                                                      ContentTemplate="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}},
                                                                                Path=ItemTemplate}"
                                                      ContentTemplateSelector="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}},
                                                                                        Path=ItemTemplateSelector}" />
                                    <TextBlock Name="PART_Caption"
                                               Margin="{TemplateBinding Padding}"
                                               VerticalAlignment="Center"
                                               FontSize="{TemplateBinding FontSize}"
                                               Foreground="{TemplateBinding Foreground}"
                                               SnapsToDevicePixels="True"
                                               Text="{TemplateBinding Caption}"
                                               TextAlignment="Center" />
                                </Grid>

                            </Border>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>

                        <!--  Context  Tab Group Checked  -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonTab}}, Path=HasContextTabGroup}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsChecked}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter TargetName="PART_Caption" Property="Foreground" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonTab}}, Path=ContextColor, Converter={StaticResource colorToBrushConverter}}" />
                            <!--<Setter Property="FontWeight" Value="Normal" />-->
                            <Setter TargetName="center_Path" Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
                            <Setter TargetName="border" Property="Margin" Value="0,0,0,-3" />
                            <Setter TargetName="center_Path" Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
                            <!--<Setter Property="Margin" TargetName="border" Value="0,0,0,-1"/>-->
                        </MultiDataTrigger>

                        <!--  Tab Checked  -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonTab}}, Path=HasContextTabGroup}" Value="False" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsChecked}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
                            <!--<Setter Property="FontWeight" Value="SemiBold" />-->
                            <Setter TargetName="center_Path" Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
                            <Setter TargetName="border" Property="Margin" Value="0,0,0,-3" />
                            <Setter TargetName="center_Path" Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
                            <!--<Setter Property="Margin" TargetName="border" Value="0,0,0,-1"/>-->




                        </MultiDataTrigger>

                        <!--  Context Tab Group Checked MouseOver  -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonTab}}, Path=HasContextTabGroup}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsChecked}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}" Value="True" />
                            </MultiDataTrigger.Conditions>


                        </MultiDataTrigger>

                        <!--  Tab Mouse Over  -->
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}" Value="True" />
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsChecked}" Value="False" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Foreground" Value="{StaticResource ActiveBackgroundBrush}" />

                        </MultiDataTrigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <!--<Setter Property="FontSize" Value="18" />-->
                            <!--<Setter Property="Padding" Value="4" />-->
                            <!--<Setter Property="Height" Value="30" TargetName="border"/>-->
                            <!--<Setter Property="FontWeight" Value="Normal" />-->
                        </Trigger>


                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <!--<Trigger Property="IsChecked" Value="True">
                        <Setter Property="Margin" Value="0,0,0,-4"></Setter>
              </Trigger>-->
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013TabButtonStyle}" TargetType="{x:Type tools_controls:TabButton}" />


    <!--  QuickAccessToolBar style  -->
    <Style TargetType="{x:Type tools_controls:QuickAccessToolBar}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="GeometryBackground" Value="Transparent" />
        <Setter Property="GeometryStroke" Value="Transparent" />
        <Setter Property="Control.Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Height" Value="22" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="shared_windows:WindowChrome.IsHitTestVisibleInChrome" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:QuickAccessToolBar}">
                    <Grid>



                        <Border Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <tools_controls:TwoItemsLayoutPanelEx Name="PART_PanelEx" shared_windows:WindowChrome.IsHitTestVisibleInChrome="True"
                                                         MaxRightWidth="30"
                                                         MinRightWidth="30" MinHeight="25">
                                <ItemsControl Name="PART_Main" Focusable="False">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <tools_controls:QuickAccessToolBarPanel HorizontalAlignment="Left"
                                                                           Background="Transparent"
                                                                           ClipToBounds="True"
                                                                           GeometryBackground="{Binding Path=GeometryBackground,
                                                                                                        Mode=TwoWay,
                                                                                                        RelativeSource={RelativeSource AncestorType={x:Type tools_controls:QuickAccessToolBar}}}"
                                                                           GeometryStroke="{Binding Path=GeometryStroke,
                                                                                                    Mode=TwoWay,
                                                                                                    RelativeSource={RelativeSource AncestorType={x:Type tools_controls:QuickAccessToolBar}}}"
                                                                           GeometryStrokeThickness="{Binding Path=GeometryStrokeThickness, Mode=TwoWay, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:QuickAccessToolBar}}}"
                                                                           HasGeometry="{Binding Path=HasGeometry,
                                                                                                 Mode=TwoWay,
                                                                                                 RelativeSource={RelativeSource AncestorType={x:Type tools_controls:QuickAccessToolBar}}}" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                                <Grid>


                                    <tools_controls:DropDownButton Name="PART_PopupButton"
                                                          Width="23"
                                                          Style="{StaticResource QuickAccessPopupButtonStyle}">
                                        <Border Width="Auto" x:Name="_QATDropDownPopUp"
                                                BorderBrush="{StaticResource ContentBorderBrush}"
                                                BorderThickness="0.5">
                                            <Grid>

                                                <StackPanel>
                                                    <Border Width="Auto"
                                                            Height="22"
                                                            Margin="1,1,0,1"
                                                            Background="{StaticResource HeaderBackgroundBrush}">
                                                        <TextBlock Width="Auto"
                                                                   Margin="6,0,3,0"
                                                                   HorizontalAlignment="Left"
                                                                   VerticalAlignment="Center"
                                                                   FontWeight="Bold"
                                                                   Foreground="{StaticResource HeaderForegroundBrush}"
                                                                   Text="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=CustomizeQAT}"
                                                                   x:Uid="CustomizeQATTextBlock" />
                                                    </Border>
                                                    <ItemsControl Name="PART_QATMenu" KeyboardNavigation.IsTabStop="False" FocusManager.IsFocusScope="False">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel HorizontalAlignment="Stretch" Orientation="Vertical">
                                                                    <StackPanel.Resources>
                                                                        <Style TargetType="{x:Type tools_controls:RibbonButton}">
                                                                            <Setter Property="OverridesDefaultStyle" Value="true" />
                                                                            <Setter Property="Background" Value="Transparent" />
                                                                            <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
                                                                            <Setter Property="BorderThickness" Value="1" />
                                                                            <Setter Property="Margin" Value="1,0,0,0" />
                                                                            <Setter Property="Template">
                                                                                <Setter.Value>
                                                                                    <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                                                                                        <Border Name="OuterBorder" Padding="{TemplateBinding Padding}"
                                                                                                Width="{TemplateBinding Width}"
                                                                                                Height="{TemplateBinding Height}"
                                                                                                MinWidth="{TemplateBinding MinWidth}"
                                                                                                MinHeight="{TemplateBinding MinHeight}"
                                                                                                MaxWidth="{TemplateBinding MaxWidth}"
                                                                                                MaxHeight="{TemplateBinding MaxHeight}"
                                                                                                Margin="{TemplateBinding Margin}"
                                                                                                Background="{TemplateBinding Panel.Background}"
                                                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                                                SnapsToDevicePixels="True">
                                                                                            <Grid Margin="0,1,0,1">
                                                                                                <Grid.ColumnDefinitions>
                                                                                                    <ColumnDefinition Width="Auto" MinWidth="22" />
                                                                                                    <ColumnDefinition Width="Auto" />
                                                                                                </Grid.ColumnDefinitions>

                                                                                                <Border Name="PART_CheckBorder"
                                                                                                        Grid.Column="0"
                                                                                                        Width="19"
                                                                                                        Height="19"
                                                                                                        HorizontalAlignment="Center"
                                                                                                        VerticalAlignment="Center"
                                                                                                        Background="Transparent"
                                                                                                        Visibility="Collapsed">
                                                                                                    <Path x:Name="path" Width="8"
                                                                                                          Height="8"
                                                                                                          Data="M10.738967,0 L11.817,1.1360061 5.1774399,7.4388217 5.1789999,7.4406547 4.0474274,8.5560006 0,3.7727338 1.1959616,2.7609998 4.1605471,6.244079 z"
                                                                                                          Fill="{StaticResource GlyphBrush}"
                                                                                                          SnapsToDevicePixels="True"
                                                                                                          Stretch="Fill" />
                                                                                                </Border>
                                                                                                <TextBlock Name="label"
                                                                                                           Grid.Column="1"
                                                                                                           Margin="7,2,2,2"
                                                                                                           VerticalAlignment="Center"
                                                                                                           Foreground="{TemplateBinding Foreground}"
                                                                                                           Text="{TemplateBinding Label}" />
                                                                                            </Grid>
                                                                                        </Border>
                                                                                        <ControlTemplate.Triggers>
                                                                                            <MultiTrigger>
                                                                                                <MultiTrigger.Conditions>
                                                                                                    <Condition Property="IsMouseOver" Value="False"/>
                                                                                                    <Condition Property="IsKeyboardFocused" Value="True"/>
                                                                                                </MultiTrigger.Conditions>
                                                                                                <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
																								<Setter TargetName="path" Property="Fill" Value="{DynamicResource HoverGlyphBrush}" />
                                                                                            </MultiTrigger>
                                                                                            <Trigger Property="IsSelected" Value="True">
                                                                                                <Setter TargetName="PART_CheckBorder" Property="Visibility" Value="Visible" />
                                                                                            </Trigger>
                                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                                <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
																								<Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                                                                                                <Setter TargetName="OuterBorder" Property="BorderThickness" Value="{StaticResource MenuItemBorderThickness}" />
																								<Setter TargetName="path" Property="Fill" Value="{DynamicResource HoverGlyphBrush}" />
                                                                                                <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}"/>
                                                                                            </Trigger>
                                                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                                                <Setter Property="FontSize" Value="13"/>
                                                                                                <Setter Property="Padding" Value="16,9,16,9"/>
                                                                                            </Trigger>
                                                                                        </ControlTemplate.Triggers>	
                                                                                    </ControlTemplate>
                                                                                </Setter.Value>
                                                                            </Setter>
                                                                        </Style>
                                                                    </StackPanel.Resources>
                                                                </StackPanel>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                    </ItemsControl>
                                                    <Rectangle Name="TopSeperator"
                                                               Height="1"
                                                               Margin="30,0,0,0"
                                                               
                                                               Fill="{StaticResource ContentBorderBrush}"
                                                               StrokeThickness="1"
                                                               Visibility="Collapsed" />
                                                    <tools_controls:RibbonButton Name="PART_MoreCommands"
                                                                        Width="auto"
                                                                        Margin="0,1"
                                                                        Command="tools_controls:RibbonCommands.QATMoreCommands"
                                                                        Foreground="{StaticResource ContentForegroundBrush}"
                                                                        Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                        Path=QATMoreCommands}"
                                                                        Style="{StaticResource RibbonButtonPopupItemStyle}"
                                                                        Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}},
                                                                                             Path=EnableMoreCommands,
                                                                                             Converter={StaticResource BooleanToVisibilityConverter}}" />
                                                    <tools_controls:RibbonButton Name="PART_AboveButton"
                                                                        Width="auto"
                                                                        Margin="0,1"
                                                                        Command="tools_controls:RibbonCommands.PlaceQATAbove"
                                                                        Foreground="{StaticResource ContentForegroundBrush}"
                                                                        Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                        Path=QATShowAbove}"
                                                                        Style="{StaticResource RibbonButtonPopupItemStyle}"
                                                                        Visibility="Collapsed" />
                                                    <tools_controls:RibbonButton Name="PART_BelowButton"
                                                                        Width="auto"
                                                                        Margin="0,1"
                                                                        Command="tools_controls:RibbonCommands.PlaceQATBelow"
                                                                        Foreground="{StaticResource ContentForegroundBrush}"
                                                                        Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                        Path=QATShowBelow}"
                                                                        Style="{StaticResource RibbonButtonPopupItemStyle}" />
                                                    <Rectangle Height="1"
                                                               Margin="30,1,0,1"
                                                               Fill="{StaticResource ContentBorderBrush}"
                                                               StrokeThickness="1" />
                                                    <tools_controls:RibbonButton Name="PART_MinimizeButton"
                                                                        Width="auto"
                                                                        Margin="0,1"
                                                                        Command="tools_controls:RibbonCommands.MinimizeRibbon"
                                                                        Foreground="{StaticResource ContentForegroundBrush}"
                                                                        IsToggle="True"
                                                                        Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                        Path=MinimizeRibbon}"
                                                                        Style="{StaticResource RibbonButtonPopupItemStyle}" />
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </tools_controls:DropDownButton>
                                    <tools_controls:DropDownButton x:Name="PART_OverflowButton"
                                                          DockPanel.Dock="Right"
                                                          Style="{StaticResource QuickAccessPopupButtonOverflowStyle}"
                                                          Visibility="Collapsed">
                                        <tools_controls:DropDownButton.PathGeometry>
                                            <GeometryGroup>
                                                <PathGeometry>
                                                    <PathFigure IsClosed="True"
                                                                IsFilled="True"
                                                                StartPoint="3.5,8">
                                                        <LineSegment Point="4.5,9" />
                                                        <LineSegment Point="3.5,10" />
                                                    </PathFigure>
                                                </PathGeometry>
                                                <PathGeometry>
                                                    <PathFigure IsClosed="True"
                                                                IsFilled="True"
                                                                StartPoint="7.5,8">
                                                        <LineSegment Point="8.5,9" />
                                                        <LineSegment Point="7.5,10" />
                                                    </PathFigure>
                                                </PathGeometry>
                                            </GeometryGroup>
                                        </tools_controls:DropDownButton.PathGeometry>
                                        <StackPanel MaxHeight="21"
                                                    Background="{TemplateBinding Background}"
                                                    Orientation="Horizontal">
                                            <ItemsControl Name="PART_PopupItemsControl">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel HorizontalAlignment="Right"
                                                                    VerticalAlignment="Center"
                                                                    Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                            </ItemsControl>

                                            <tools_controls:DropDownButton Name="PART_PopupButtonOverflowed" Style="{StaticResource QuickAccessPopupButtonStyle}"
																Visibility="{TemplateBinding QATDropDownVisiblity}">
                                                <tools_controls:DropDownButton.PathGeometry>
                                                    <GeometryGroup>
                                                        <LineGeometry StartPoint="4,7" EndPoint="9,7" />
                                                        <PathGeometry>
                                                            <PathFigure IsClosed="True"
                                                                        IsFilled="True"
                                                                        StartPoint="5,10">
                                                                <LineSegment Point="8,10" />
                                                                <LineSegment Point="6.5,12.5" />
                                                            </PathFigure>
                                                        </PathGeometry>
                                                    </GeometryGroup>
                                                </tools_controls:DropDownButton.PathGeometry>
                                                <Border Width="220"
                                                        BorderBrush="Gray"
                                                        BorderThickness="0.5"
                                                        Padding="2">
                                                    <Grid>
                                                        <DockPanel>
                                                            <Border Width="25"
                                                                    HorizontalAlignment="Left"
                                                                    Background="Transparent"
                                                                    DockPanel.Dock="Left" />
                                                        </DockPanel>
                                                        <StackPanel>
                                                            <Border Height="22"
                                                                    Margin="0,0,0,1"
                                                                    Background="{DynamicResource HeaderBackgroundBrush}">
                                                                <TextBlock Margin="3,0,0,0"
                                                                           VerticalAlignment="Center"
                                                                           FontWeight="Bold"
                                                                           Foreground="{StaticResource ContentForegroundBrush}"
                                                                           Text="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                          Path=CustomizeQAT}"
                                                                           x:Uid="CustomizeQATTextBlock" />
                                                            </Border>
                                                            <ItemsControl Name="PART_QATMenuOverFlow" ItemContainerStyle="{StaticResource RibbonButtonPopupItemStyle}">
                                                                <ItemsControl.ItemsPanel>
                                                                    <ItemsPanelTemplate>
                                                                        <StackPanel HorizontalAlignment="Stretch" Orientation="Vertical" />
                                                                    </ItemsPanelTemplate>
                                                                </ItemsControl.ItemsPanel>
                                                            </ItemsControl>
                                                            <Separator Name="TopSeperatorOverFlow"
                                                                       Height="2"
                                                                       Margin="30,0,0,0"
                                                                       Background="#FFE0E3E6"
                                                                       Visibility="Collapsed" />
                                                            <tools_controls:RibbonButton Command="tools_controls:RibbonCommands.QATMoreCommands"
                                                                                Foreground="{StaticResource ContentForegroundBrush}"
                                                                                Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                                Path=QATMoreCommands}"
                                                                                Style="{StaticResource RibbonButtonPopupItemStyle}"
                                                                                Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}},
                                                                                                     Path=EnableMoreCommands,
                                                                                                     Converter={StaticResource BooleanToVisibilityConverter}}" />
                                                            <tools_controls:RibbonButton Command="tools_controls:RibbonCommands.PlaceQATAbove"
                                                                                Foreground="{StaticResource ContentForegroundBrush}"
                                                                                Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                                Path=QATShowAbove}"
                                                                                Style="{StaticResource RibbonButtonPopupItemStyle}"
                                                                                Visibility="{Binding ElementName=PART_AboveButton,
                                                                                                     Path=Visibility,
                                                                                                     Mode=TwoWay}" />
                                                            <tools_controls:RibbonButton Command="tools_controls:RibbonCommands.PlaceQATBelow"
                                                                                Foreground="{StaticResource ContentForegroundBrush}"
                                                                                Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                                Path=QATShowBelow}"
                                                                                Style="{StaticResource RibbonButtonPopupItemStyle}"
                                                                                Visibility="{Binding ElementName=PART_BelowButton,
                                                                                                     Path=Visibility,
                                                                                                     Mode=TwoWay}" />
                                                            <Separator Height="2"
                                                                       Margin="30,0,0,0"
                                                                       Background="{DynamicResource BackgroundBrush}" />
                                                            <tools_controls:RibbonButton Command="tools_controls:RibbonCommands.MinimizeRibbon"
                                                                                Foreground="{StaticResource ContentForegroundBrush}"
                                                                                IsSelected="{Binding ElementName=PART_MinimizeButton,
                                                                                                     Path=IsSelected,
                                                                                                     Mode=TwoWay}"
                                                                                IsToggle="True"
                                                                                Label="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                                Path=MinimizeRibbon}"
                                                                                Style="{StaticResource RibbonButtonPopupItemStyle}" />
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>
                                            </tools_controls:DropDownButton>
                                        </StackPanel>
                                    </tools_controls:DropDownButton>
                                </Grid>
                            </tools_controls:TwoItemsLayoutPanelEx>

                        </Border>

                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasOverflowChildren" Value="True">
                            <Setter TargetName="PART_PopupButton" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="PART_OverflowButton" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger SourceName="PART_QATMenu" Property="HasItems" Value="True">
                            <Setter TargetName="TopSeperator" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger SourceName="PART_QATMenuOverFlow" Property="HasItems" Value="True">
                            <Setter TargetName="TopSeperatorOverFlow" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger Property="HasGeometry" Value="False">
                            <Setter TargetName="PART_AboveButton" Property="Visibility" Value="Visible" />
                            <Setter TargetName="PART_BelowButton" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="FrameworkElement.Height" Value="40" />
                            <Setter Property="Margin" Value="0,5,0,0"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:RibbonWindow}}, Path=IsGlassActive}" Value="True">
                <Setter Property="GeometryBackground" Value="Transparent" />
            </DataTrigger>
        </Style.Triggers>
    </Style>




    <!--  ButtonPanel  -->

    <Style TargetType="{x:Type tools_controls:ButtonPanel}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:ButtonPanel}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="5" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0"
                                Height="{TemplateBinding Height}"
                                Background="Transparent"
                                BorderThickness="0"
                                ClipToBounds="True">
                            <ItemsPresenter />
                        </Border>
                        <Rectangle Grid.Column="1"
                                   Width="1"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Stretch"
                                   Stroke="{DynamicResource BackgroundBrush}"
                                   Visibility="{TemplateBinding SeparatorVisibility}" />

                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="Height"  Value="42"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <tools_controls:ButtonLayoutPanel ClipToBounds="True" SeparatorBrush="Transparent" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  RibbonButton style  -->
    <Style x:Key="Office2013RibbonButtonStyle" TargetType="{x:Type tools_controls:RibbonButton}">
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <!--<Setter Property="Label" Value="New Button" />-->
        <Setter Property="CornerRadius" Value="0" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch"  />
        <Setter Property="LargeIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt32.png" />
        <Setter Property="SmallIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt16.png" />
        <Style.Triggers>

            <Trigger Property="SizeForm" Value="ExtraSmall">
                <Setter Property="Padding" Value="3" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                            <Border Name="OuterBorder"
                                    MinHeight="22"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="{TemplateBinding CornerRadius}"
                                    IsEnabled="{TemplateBinding IsEnabled}"
                                    Opacity="{TemplateBinding Opacity}">
                                <Image x:Name="PART_Image"
                                       Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                       Width="16"
                                       Height="16"
                                       Margin="{TemplateBinding Padding}"
                                       HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                       VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                       Source="{Binding Path=SmallIcon,
                                                        Mode=OneWay,
                                                        RelativeSource={RelativeSource TemplatedParent}}" />
                            </Border>
                            <ControlTemplate.Triggers>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsSelected" Value="True" />
                                    </MultiTrigger.Conditions>

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </MultiTrigger>

                                <Trigger Property="IsPressed" Value="True">

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>

                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter Property="Height" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="OuterBorder" Value="47"/>
                                    <Setter Property="Height" TargetName="OuterBorder" Value="30"/>
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="SizeForm" Value="Small">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                            <Grid VerticalAlignment="{TemplateBinding VerticalAlignment}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}">
                                <Border Name="OuterBorder"
                                        MinHeight="22" Padding="{TemplateBinding Padding}"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="{TemplateBinding CornerRadius}"
                                        IsEnabled="{TemplateBinding IsEnabled}"
                                        Opacity="{TemplateBinding Opacity}">
                                    <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Border Name="PART_ImageBorder"
                                                Grid.Column="0"
                                                Margin="1">
                                            <Image x:Name="PART_Image"
                                                   Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Width="16"
                                                   Height="16"
                                                   Source="{Binding Path=SmallIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Border>
                                        <tools_controls:RibbonAutomatableTextBlock x:Name="label"
                                                   Grid.Column="1"
                                                   Margin="2,2,4,0" HorizontalAlignment="Left"
                                                   FontFamily="{TemplateBinding FontFamily}"
                                                   FontSize="{TemplateBinding FontSize}"
                                                   Foreground="{TemplateBinding Foreground}"
                                                   Text="{TemplateBinding Label}" />
                                    </Grid>
                                </Border>
                            </Grid>
 <ControlTemplate.Triggers>
                                <Trigger Property="IsSmallImageVisible" Value="False">
                                    <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                </Trigger>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsSelected" Value="True" />
                                    </MultiTrigger.Conditions>

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                </MultiTrigger>

                                <Trigger Property="IsPressed" Value="True">

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                </Trigger>

                            </ControlTemplate.Triggers>
                                                   
						   </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="SizeForm" Value="Large">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                            <Border Name="OuterBorder" Padding="{TemplateBinding Padding}"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="{TemplateBinding CornerRadius}"
                                    Opacity="{TemplateBinding Opacity}">
                                <Grid HorizontalAlignment="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonButton}}}" VerticalAlignment="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonButton}}}">
                                    <StackPanel Orientation="Vertical">
                                        <Border Name="PART_ImageBorder"
                                                Margin="3"
                                                SnapsToDevicePixels="True">
                                            <Image x:Name="PART_Image"
                                                   Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Width="32"
                                                   Height="32"
                                                   Source="{Binding Path=LargeIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Border>
                                        <ItemsControl x:Name="PART_Label"
                                                      Margin="0,3,0,2"
                                                      Focusable="False"
                                                      Foreground="{TemplateBinding Foreground}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <tools_controls:MultilinePanel />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemContainerStyle>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="Foreground" Value="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ItemsControl}}}" />
                                                </Style>
                                            </ItemsControl.ItemContainerStyle>
                                        </ItemsControl>
                                    </StackPanel>

                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsLargeImageVisible" Value="False">
                                    <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter TargetName="PART_Label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="PART_Label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsSelected" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_Label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </MultiTrigger>

                                <Trigger Property="IsPressed" Value="True">

                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="PART_Label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="PART_Image" Property="Height" Value="48" />
                                    <Setter TargetName="PART_Image" Property="Width" Value="48" />
                                    <Setter Property="Margin" Value="0,10,0,2" TargetName="PART_Label"/>
                                    <Setter Property="Height" TargetName="OuterBorder" Value="100"/>
                                    <Setter Property="Width" TargetName="OuterBorder" Value="60"/>
                                </Trigger>

                            </ControlTemplate.Triggers>
                        
						   </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonButtonStyle}" TargetType="{x:Type tools_controls:RibbonButton}" />


    <!--  DropDown Button Style  -->
    <Style x:Key="Office2013DropDownButtonStyle" TargetType="{x:Type tools_controls:DropDownButton}">
        
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Label" Value="New Button" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="LargeIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt32.png" />
        <Setter Property="SmallIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt16.png" />
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="SizeForm" Value="ExtraSmall">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:DropDownButton}">
                            <Border Name="PART_ToggleButton"
                                    MinHeight="22"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    SnapsToDevicePixels="True">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0"
                                            Margin="1"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            SnapsToDevicePixels="True">
                                        <Image x:Name="PART_Image"
                                               Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                               Width="16"
                                               Height="16"
                                               RenderOptions.BitmapScalingMode="NearestNeighbor"
                                               Source="{Binding Path=SmallIcon,
                                                                Mode=OneWay,
                                                                RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Border>

                                    <Path x:Name="path"
                                          Grid.Column="1"
                                          Width="5"
                                          Height="3"
                                          Margin="3,5"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Data="{StaticResource Office2013DropDownPath}"
                                          Fill="{StaticResource GlyphBrush}"
                                          Focusable="False"
                                          SnapsToDevicePixels="True"
                                          Stretch="Fill" />

                                    <Popup Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                           Placement="Bottom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">
                                        <Microsoft_Windows_Luna:SystemDropShadowChrome Name="PART_Shadow"
                                                                                         Margin="0"
                                                                                         SnapsToDevicePixels="true">
                                            <Border MinWidth="28"
                                                    MinHeight="14"
                                                    Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly=FrameworkElement}}">
                                                    <ItemsPresenter Name="Presenter"
                                                                    Margin="0"
                                                                    Grid.IsSharedSizeScope="true"
                                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">

                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />

                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">

                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />

                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter Property="Height" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_ToggleButton" Value="47"/>
                                    <Setter Property="Height" TargetName="PART_ToggleButton" Value="30"/>
                                </Trigger>

                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="SizeForm" Value="Small">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:DropDownButton}">
                            <Border Name="PART_ToggleButton"
                                    MinHeight="22"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border Name="PART_ImageBorder"
                                            Grid.Column="0"
                                            Margin="2,3">
                                        <Image x:Name="PART_Image"
                                               Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                               Width="16"
                                               Height="16"
                                               RenderOptions.BitmapScalingMode="NearestNeighbor"
                                               Source="{Binding Path=SmallIcon,
                                                                Mode=OneWay,
                                                                RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Border>
                                    <tools_controls:RibbonAutomatableTextBlock x:Name="label"
                                               Grid.Column="1"
                                               Margin="2,3,4,0"
                                               HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                               VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                               FontFamily="Calibri"
                                               Foreground="{TemplateBinding Foreground}"
                                               Text="{TemplateBinding Label}" />

                                    <Path x:Name="path"
                                          Grid.Column="2"
                                          Width="5"
                                          Height="3"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Data="{StaticResource Office2013DropDownPath}"
                                          Fill="{StaticResource GlyphBrush}"
                                          Focusable="False"
                                          Stretch="Fill" />

                                    <Popup Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                           Placement="Bottom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">
                                        <Microsoft_Windows_Luna:SystemDropShadowChrome Name="PART_Shadow"
                                                                                         Margin="0"
                                                                                         SnapsToDevicePixels="true">
                                            <Border MinWidth="28"
                                                    MinHeight="14"
                                                    Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly=FrameworkElement}}">
                                                    <ItemsPresenter Name="Presenter"
                                                                    Margin="0"
                                                                    Grid.IsSharedSizeScope="true"
                                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                            </Border>
                          <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="IsSmallImageVisible" Value="False">
                                    <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
									<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
								<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter Property="Height" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Height" TargetName="PART_ToggleButton" Value="30"/>
                                    <Setter Property="Width" TargetName="PART_ToggleButton" Value="47"/>
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="SizeForm" Value="Large">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:DropDownButton}">
                            <Border Name="PART_ToggleButton"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Opacity="{TemplateBinding Opacity}"
                                    SnapsToDevicePixels="True">
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <Border Name="PART_ImageBorder"
                                                Margin="3"
                                                SnapsToDevicePixels="True">
                                            <Image x:Name="PART_Image"
                                                   Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Width="32"
                                                   Height="32"
                                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                   Source="{Binding Path=LargeIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Border>
                                        <tools_controls:CustomItemsControl x:Name="label"
                                                                  Margin="2,3,2,2"
                                                                  Focusable="False"
                                                                  Path="{StaticResource Path}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <tools_controls:MultilinePanel HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </tools_controls:CustomItemsControl>
                                        <Popup Name="PART_Popup"
                                               AllowsTransparency="True"
                                               Focusable="False"
                                               IsOpen="{Binding Path=IsDropDownOpen,
                                                                RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                               Placement="Bottom"
                                               PopupAnimation="Fade"
                                               StaysOpen="False"
                                               VerticalOffset="-2">
                                            <Popup.Effect>
                                                <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                            </Popup.Effect>
                                            <Microsoft_Windows_Luna:SystemDropShadowChrome Name="PART_Shadow"
                                                                                             Margin="0"
                                                                                             SnapsToDevicePixels="true">
                                                <Border MinWidth="28"
                                                        MinHeight="14"
                                                        Background="{StaticResource ContentBackgroundBrush}"
                                                        BorderBrush="{StaticResource ContentBorderBrush}"
                                                        BorderThickness="1">
                                                    <Border.Effect>
                                                        <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                    </Border.Effect>
                                                    <ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly=FrameworkElement}}">
                                                        <ItemsPresenter Name="Presenter"
                                                                        Margin="0"
                                                                        Grid.IsSharedSizeScope="true"
                                                                        KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                        KeyboardNavigation.TabNavigation="Cycle"
                                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                    </ScrollViewer>
                                                </Border>
                                            </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                        </Popup>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="IsLargeImageVisible" Value="False">
                                    <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">

                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">

                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="PART_Image" Property="Height" Value="48" />
                                    <Setter TargetName="PART_Image" Property="Width" Value="48" />
                                    <Setter TargetName="PART_Image" Property="RenderOptions.BitmapScalingMode" Value="LowQuality" />
                                    <Setter Property="Margin" Value="2,10,2,2" TargetName="label"/>
                                    <Setter Property="Height" TargetName="PART_ToggleButton" Value="100"/>
                                    <Setter Property="Width" TargetName="PART_ToggleButton" Value="60"/>
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent" />
            </Trigger>

        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013DropDownButtonStyle}" TargetType="{x:Type tools_controls:DropDownButton}" />


    <!--  Split Button Style  -->
    <Style x:Key="Office2013SplitButtonStyle" TargetType="{x:Type tools_controls:SplitButton}">
        <Setter Property="Label" Value="New Button" />
        <Setter Property="LargeIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt32.png" />
        <Setter Property="SmallIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt16.png" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>

            <Trigger Property="SizeForm" Value="ExtraSmall">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:SplitButton}">
                            <Border Name="OuterBorder"
                                    MinHeight="22"
                                    BorderThickness="1"
                                    Opacity="{TemplateBinding Opacity}"
                                    SnapsToDevicePixels="True">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="12" />
                                    </Grid.ColumnDefinitions>
                                    <Border Name="PART_Button"
                                            Grid.Column="0"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="0"
                                            SnapsToDevicePixels="True">
                                        <Image x:Name="PART_Image"
                                               Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                               Width="16"
                                               Height="16"
                                               Margin="3,1"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               RenderOptions.BitmapScalingMode="NearestNeighbor"
                                               Source="{Binding Path=SmallIcon,
                                                                Mode=OneWay,
                                                                RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Border>

                                    <tools_controls:RibbonUIBorder Name="PART_ToggleButton"
                                            Grid.Column="1"
                                            Background="Transparent"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1,0,0,0"
                                            SnapsToDevicePixels="True"
                                            ToolTip="{TemplateBinding ToggleButtonToolTip}">

                                        <Path x:Name="PathData"
                                              Width="5"
                                              Height="3"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Data="{StaticResource Office2013DropDownPath}"
                                              Fill="{StaticResource GlyphBrush}"
                                              Focusable="False"
                                              Stretch="fill"
                                              StrokeThickness="1" />

                                    </tools_controls:RibbonUIBorder>
                                    <Popup Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            Mode=TwoWay,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                           Placement="Bottom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">
                                        <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow" SnapsToDevicePixels="true">
                                            <Border MinWidth="28"
                                                    MinHeight="14"
                                                    Background="{DynamicResource ContentBackgroundBrush}"
                                                    BorderBrush="{DynamicResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly=FrameworkElement}}">
                                                    <ItemsPresenter Name="Presenter"
                                                                    Margin="0"
                                                                    Grid.IsSharedSizeScope="true"
                                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="PathData" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
								<Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBackgroundBrush}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="PathData" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
									<Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="PathData" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
									<Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
								<Setter TargetName="PathData" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
								    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="PathData" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
									<Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />

                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="PathData" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
									<Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />

                                </MultiTrigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter Property="Height" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="OuterBorder" Value="47"/>
                                    <Setter Property="Height" TargetName="OuterBorder" Value="30"/>
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="SizeForm" Value="Small" />
                    <Condition Property="HitTestArea" Value="LabelAndImage" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:SplitButton}">
                            <Border Name="OuterBorder"
                                    MinHeight="22"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="14" />
                                    </Grid.ColumnDefinitions>

                                    <Border Name="PART_Button"
                                            Grid.Column="0"
                                            Background="Transparent"
                                            BorderBrush="Transparent"
                                            BorderThickness="0"
                                            SnapsToDevicePixels="True">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <!--  <Rectangle Name="InnerPath" Fill="{TemplateBinding Background}" Grid.ColumnSpan="2" RadiusX="2" RadiusY="2"/>  -->
                                            <Image Name="PART_Image"
                                                   Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Grid.Column="0"
                                                   Width="16"
                                                   Height="16"
                                                   Margin="2"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                   Source="{Binding Path=SmallIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}"
                                                   Visibility="Collapsed" />
                                            <tools_controls:RibbonAutomatableTextBlock Name="label"
                                                       Grid.Column="1"
                                                       Margin="2,3,4,0"
                                                       HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                                       VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                       Foreground="{TemplateBinding Foreground}"
                                                       Text="{TemplateBinding Label}" />
                                        </Grid>
                                    </Border>

                                    <tools_controls:RibbonUIBorder AutomationProperties.Name="DropDownButton" Name="PART_ToggleButton"
                                            Grid.Column="2"
                                            Background="Transparent"
                                            BorderBrush="Transparent"
                                            BorderThickness="1,0,0,0"
                                            ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid AutomationProperties.Name="DropDownButton">
                                            <!--  <Rectangle Name="InnerPathToggle" Fill="{TemplateBinding Background}" RadiusX="2" RadiusY="2"/>  -->

                                            <Path x:Name="path" Width="5"
                                                  Height="3"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"
                                                  Data="{StaticResource Office2013DropDownPath}"
                                                  Fill="{StaticResource GlyphBrush}"
                                                  Focusable="False"
                                                  Stretch="Fill" />

                                        </Grid>
                                    </tools_controls:RibbonUIBorder>
                                    <Popup Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                           Placement="Bottom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">
                                        <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow" SnapsToDevicePixels="true">
                                            <Border MinWidth="28"
                                                    MinHeight="14"
                                                    Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <ScrollViewer Margin="1"
                                                              CanContentScroll="True"
                                                              Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer,
                                                                                                            TypeInTargetAssembly=FrameworkElement}}">
                                                    <ItemsPresenter Name="Presenter"
                                                                    Grid.IsSharedSizeScope="true"
                                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>

                                <Trigger Property="IsSmallImageVisible" Value="True">
                                    <Setter TargetName="PART_Image" Property="Visibility" Value="Visible" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
								<Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBackgroundBrush}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
<Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
<Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
								<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
								<Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
									<Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />

                                    <Setter TargetName="PART_ToggleButton" Property="BorderThickness" Value="0,1,1,1" />
                                </MultiTrigger>



                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Height" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="OuterBorder" Value="47"/>
                                    <Setter Property="Height" TargetName="OuterBorder" Value="30"/>
                                </Trigger>


                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="SizeForm" Value="Small" />
                    <Condition Property="HitTestArea" Value="ImageOnly" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:SplitButton}">
                            <Border Name="OuterBorder"
                                    MinHeight="22"
                                    BorderBrush="Transparent"
                                    BorderThickness="1"
                                    Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <Border Name="PART_Button"
                                            Grid.Column="0"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Background="Transparent"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="0"
                                            CornerRadius="3,0,0,3">
                                        <Grid>
                                            <!--  <Rectangle Name="InnerPath" Fill="{TemplateBinding Background}"  RadiusX="2" RadiusY="2"/>  -->
                                            <Image x:Name="PART_Image"
                                                   Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Width="16"
                                                   Height="16"
                                                   Margin="1"
                                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                   Source="{Binding Path=SmallIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Grid>
                                    </Border>

                                    <tools_controls:RibbonUIBorder AutomationProperties.Name="DropDownButton" Name="PART_ToggleButton"
                                            Grid.Column="1"
                                            BorderThickness="1,0,0,0"
                                            ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid>
                                            <!--  <Rectangle Name="InnerPathToggle" Fill="{TemplateBinding Background}" RadiusX="2" RadiusY="2"/>  -->
                                            <DockPanel>
                                                <tools_controls:RibbonAutomatableTextBlock Name="label"
                                                           Margin="2,0,2,0"
                                                           VerticalAlignment="Center"
                                                           DockPanel.Dock="Left"
                                                           Foreground="{TemplateBinding Foreground}"
                                                           Text="{TemplateBinding Label}" />

                                                <Path x:Name="path" Width="5"
                                                      Height="3"
                                                      Margin="2"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Data="{StaticResource Office2013DropDownPath}"
                                                      Fill="{StaticResource GlyphBrush}"
                                                      Stretch="Fill" />

                                            </DockPanel>
                                        </Grid>
                                    </tools_controls:RibbonUIBorder>
                                    <Popup Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                           Placement="Bottom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">
                                        <Microsoft_Windows_Luna:SystemDropShadowChrome x:Name="PART_Shadow" SnapsToDevicePixels="true">
                                            <Border MinWidth="28"
                                                    MinHeight="14"
                                                    Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly=FrameworkElement}}">
                                                    <ItemsPresenter Name="Presenter"
                                                                    Margin="0"
                                                                    Grid.IsSharedSizeScope="true"
                                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                    <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
								<Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
<Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="path" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
<Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
								<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
								<Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />


                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
									<Setter TargetName="path" Property="Fill" Value="{StaticResource ActiveGlyphBrush}" />
<Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />

                                    <Setter TargetName="PART_ToggleButton" Property="BorderThickness" Value="0,1,1,1" />
                                </MultiTrigger>



                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Height" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="PART_Image" Value="20"/>
                                    <Setter Property="Width" TargetName="OuterBorder" Value="47"/>
                                    <Setter Property="Height" TargetName="OuterBorder" Value="30"/>
                                </Trigger>


                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent" />
            </MultiTrigger>

            <Trigger Property="SizeForm" Value="Large">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:SplitButton}">
                            <Border Name="OuterBorder"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    IsEnabled="{TemplateBinding IsEnabled}"
                                    Opacity="{TemplateBinding Opacity}">
                                <StackPanel Orientation="Vertical">
                                    <Border Name="PART_Button"
                                            Background="Transparent"
                                            BorderBrush="Transparent"
                                            BorderThickness="0"
                                            Visibility="Collapsed">
                                        <Grid>
                                            <Image x:Name="PART_Image"
                                                   Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                   Width="31"
                                                   Height="31"
                                                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                                                   Source="{Binding Path=LargeIcon,
                                                                    Mode=OneWay,
                                                                    RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Grid>
                                    </Border>

                                    <tools_controls:RibbonUIBorder Name="PART_ToggleButton" AutomationProperties.Name="DropDownButton"
                                            BorderThickness="0,1,0,0" Background="{TemplateBinding Background}"
                                            ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid>
                                            <tools_controls:CustomItemsControl x:Name="label"
                                                                      Margin="0,2,0,2"
                                                                      Focusable="False"
                                                                      ItemsSource="{Binding Path=Label,
                                                                                            Mode=OneWay,
                                                                                            Converter={StaticResource TextWrappingConverter},
                                                                                            RelativeSource={RelativeSource TemplatedParent}}"
                                                                      Path="{StaticResource Path}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <tools_controls:MultilinePanel HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                            </tools_controls:CustomItemsControl>
                                        </Grid>
                                    </tools_controls:RibbonUIBorder>

                                    <Popup Name="PART_Popup"
                                           AllowsTransparency="True"
                                           Focusable="False"
                                           IsOpen="{Binding Path=IsDropDownOpen,
                                                            Mode=TwoWay,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:DropDownButton}}}"
                                           Placement="Bottom"
                                           PopupAnimation="Fade"
                                           StaysOpen="False">
                                        <Border x:Name="PART_Shadow" SnapsToDevicePixels="true">
                                            <Border MinWidth="28"
                                                    MinHeight="14"
                                                    Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly=FrameworkElement}}">
                                                    <ItemsPresenter Name="Presenter"
                                                                    Margin="0"
                                                                    Grid.IsSharedSizeScope="true"
                                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Border>
                                    </Popup>
                                </StackPanel>
                            </Border>

                                   <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                                </Trigger>
                                <Trigger Property="IsLargeImageVisible" Value="True">
                                    <Setter TargetName="PART_Button" Property="Visibility" Value="Visible" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource HoverForegroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource HoverBorderBrush}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{DynamicResource ActiveBorderBrush}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />
                                </MultiTrigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                    <Setter Property="Opacity" Value="0.7" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter TargetName="PART_Image" Property="Height" Value="60" />
                                    <Setter TargetName="PART_Image" Property="Width" Value="48" />
                                    <Setter Property="Margin" Value="0,11,0,2" TargetName="label"/>
                                    <Setter Property="Width" TargetName="OuterBorder" Value="60"/>
                                    <Setter Property="Height" TargetName="OuterBorder" Value="100"/>
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent" />
            </Trigger>



        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013SplitButtonStyle}" TargetType="{x:Type tools_controls:SplitButton}" />

    <!--  RibbonMenuItem style  -->
    <Style x:Key="Office2013RibbonMenuItemStyle" TargetType="{x:Type tools_controls:RibbonMenuItem}">
        <Setter Property="Padding" Value="0" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonMenuItem}">
                    <Border Name="Bd">
                        <Grid Grid.ColumnSpan="3">




                            <Border Name="Border"
                                    Margin="1"
                                    Background="{TemplateBinding Panel.Background}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Padding="{TemplateBinding Padding}"
                                    SnapsToDevicePixels="True">
                                <Grid Margin="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="17" />
                                    </Grid.ColumnDefinitions>

                                    <Rectangle Name="InnerPath"
                                               Grid.ColumnSpan="4"
                                               SnapsToDevicePixels="True" />

                                    <Border Name="IconBorder"
                                            Grid.Column="0"
                                            BorderThickness="1">
                                        <ContentPresenter Width="{Binding Path=IconSize,
                                                                          Converter={StaticResource SizeToDoubleConverter},
                                                                          ConverterParameter=width,
                                                                          RelativeSource={RelativeSource TemplatedParent}}"
                                                          Height="{Binding Path=IconSize,
                                                                           Converter={StaticResource SizeToDoubleConverter},
                                                                           ConverterParameter=height,
                                                                           RelativeSource={RelativeSource TemplatedParent}}"
                                                          Margin="1"
                                                          HorizontalAlignment="Stretch"
                                                          VerticalAlignment="Stretch"
                                                          Content="{TemplateBinding Icon}"
                                                          RenderOptions.BitmapScalingMode="NearestNeighbor" />
                                    </Border>

                                    <Border Name="PART_CheckBorder"
                                            Grid.Column="0"
                                            Width="20"
                                            Height="20"
                                            Background="Transparent"
                                            BorderThickness="1"
                                            CornerRadius="0"
                                            Visibility="{Binding RelativeSource={RelativeSource TemplatedParent},
                                                                 Path=IsChecked,
                                                                 Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <Path x:Name="Glyph"
                                              Width="8"
                                              Height="8"
                                              Data="M10.738967,0 L11.817,1.1360061 5.1774399,7.4388217 5.1789999,7.4406547 4.0474274,8.5560006 0,3.7727338 1.1959616,2.7609998 4.1605471,6.244079 z"
                                              Fill="#FF7F7F7F"
                                              FlowDirection="LeftToRight"
                                              Stretch="Fill" />
                                    </Border>

                                    <ContentPresenter  Grid.Column="1" 
                                                      Margin="11,0,10,0"
                                                      VerticalAlignment="Center"
                                                      ContentSource="Header">
                                        <ContentPresenter.Style>
                                            <Style>
                                                <Style.Triggers>
                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                        <Setter Property="TextElement.FontSize" Value="13"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ContentPresenter.Style>
                                    </ContentPresenter>
                                    <Path Grid.Column="2"
                                          Width="17"
                                          Margin="4,0,0,0"
                                          VerticalAlignment="Center"
                                          Data="M0,0L4,3.5 0,7z"
                                          Fill="{TemplateBinding Foreground}"
                                          Visibility="{TemplateBinding HasItems,
                                                                       Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    <Popup Name="PART_Popup"
                                           MinWidth="10"
                                           MinHeight="10"
                                           AllowsTransparency="true"
                                           Focusable="false"
                                           HorizontalOffset="1"
                                           IsOpen="{Binding Path=IsSubmenuOpen,
                                                            RelativeSource={RelativeSource TemplatedParent}}"
                                           Placement="Right"
                                           PopupAnimation="Fade"
                                           StaysOpen="False"
                                           VerticalOffset="0">
                                        <Microsoft_Windows_Luna:SystemDropShadowChrome Name="PART_Shadow" SnapsToDevicePixels="true">
                                            <Border Background="{StaticResource ContentBackgroundBrush}"
                                                    BorderBrush="{StaticResource ContentBorderBrush}"
                                                    BorderThickness="1">
                                                <Border.Effect>
                                                    <DropShadowEffect Opacity="0.25" ShadowDepth="4" />
                                                </Border.Effect>
                                                <Grid>
                                                    <Rectangle Width="25"
                                                               Margin="0"
                                                               HorizontalAlignment="Left"
                                                               Fill="White"
                                                               RadiusX="2"
                                                               Visibility="{TemplateBinding IconBarEnabled,
                                                                                            Converter={StaticResource BooleanToVisibilityConverter}}" />

                                                    <ScrollViewer Grid.ColumnSpan="2"
                                                                  Margin="0,0,1,0"
                                                                  CanContentScroll="True"
                                                                  Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer,
                                                                                                                TypeInTargetAssembly=FrameworkElement}}">
                                                        <ItemsPresenter Name="Presenter"
                                                                        Grid.IsSharedSizeScope="true"
                                                                        KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                        KeyboardNavigation.TabNavigation="Cycle"
                                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                    </ScrollViewer>
                                                </Grid>
                                            </Border>
                                        </Microsoft_Windows_Luna:SystemDropShadowChrome>
                                    </Popup>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                            <Setter TargetName="PART_Shadow" Property="Margin" Value="0,0,5,5" />
                            <Setter TargetName="PART_Shadow" Property="Color" Value="#BCBCBC" />
                        </Trigger>
                        <Trigger Property="MenuItem.IsChecked" Value="True">
                            <Setter TargetName="IconBorder" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource HoverBackgroundBrush}" />
							<Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource HoverBorderBrush}" />
                            <Setter TargetName="Border" Property="BorderThickness" Value="{StaticResource MenuItemBorderThickness}" />
                      
                        </Trigger>
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                        </Trigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter Property="TextElement.FontSize" Value="13"/>
                            <Setter Property="Padding" Value="14,9,14,9"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonMenuItemStyle}" TargetType="{x:Type tools_controls:RibbonMenuItem}" />

    <Style x:Key="BackstageButtonStyle" TargetType="{x:Type tools_controls:RibbonButton}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonButton}">
                    <Grid Background="{StaticResource ActiveBackgroundBrush}">
                        <Ellipse x:Name="ellipse1"
                                 Width="35"
                                 Height="35"
                                 Fill="Transparent"
                                 Stroke="White"
                                 StrokeThickness="2" />
                        <Path x:Name="path1"
                              Width="18"
                              Height="13"
                              Data="F1 M 536.526,366.592L 528.898,358.964L 536.526,351.335L 540.988,351.327L 535.016,357.3L 553.101,357.3L 553.101,360.588L 534.974,360.588L 540.979,366.592L 536.526,366.592 Z "
                              Fill="White"
                              Stretch="Fill" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="path1" Property="Fill" Value="{DynamicResource HoverBackgroundBrush}" />

                            <Setter TargetName="ellipse1" Property="Stroke" Value="{DynamicResource HoverBackgroundBrush}" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  BackStage Style  -->
    <Style TargetType="{x:Type tools_controls:Backstage}">
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Margin" Value="0,0,0,0" />
        <Setter Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />

        <Setter Property="SelectedTabItemForeground" Value="{StaticResource ActiveForegroundBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:Backstage}">
                    <ControlTemplate.Resources />
                    <Grid Background="Transparent">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" MinWidth="125" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!--  Column 2  -->
                        <Grid Grid.Column="1"
                              Height="Auto"
                              Margin="-1 0 0 0">
                            <Border Width="343"
                                    Height="181"
                                    Margin="-100,0,0,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Background="{Binding Path=BackStageColor,
                                                         RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}"
                                    BorderThickness="0"
                                    SnapsToDevicePixels="True"
                                    Visibility="{Binding Path=BackStageCornerImageVisibility,
                                                         RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}">
                                <Image x:Name="image"
                                       Width="343"
                                       Height="181"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Bottom"
                                       FlowDirection="{Binding Path=FlowDirection,
                                                               RelativeSource={RelativeSource TemplatedParent}}"
                                       RenderTransformOrigin="0.5,0.5"
                                       SnapsToDevicePixels="True"
                                       Source="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/BackstageCorner.png"
                                       Stretch="None"
                                       Visibility="{Binding Path=BackStageCornerImageVisibility,
                                                            RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}">
                                    <Image.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform />
                                            <SkewTransform />
                                            <RotateTransform />
                                            <TranslateTransform />
                                        </TransformGroup>
                                    </Image.RenderTransform>
                                </Image>
                            </Border>
                            <Border Background="{TemplateBinding Background}">
                                <ContentPresenter Grid.Column="1"
                                                  Height="Auto" TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Backstage}},Path=Foreground}"
                                                  HorizontalAlignment="Stretch"
                                                  VerticalAlignment="Stretch"
                                                  ContentSource="SelectedTabContent"
                                                  ContentTemplate="{TemplateBinding ItemTemplate}" />
                            </Border>
                        </Grid>


                        <!--  Column 1  -->
                        <Grid Margin="0,-52,0,0"
                              VerticalAlignment="Stretch"
                              Background="{Binding Path=BackStageColor,
                                                   RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}">


                            <Grid.RowDefinitions>
                                <RowDefinition Height="73" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid>
                                <tools_controls:RibbonButton x:Name="BackstageBackButton"
                                                    Width="35"
                                                    Height="35"
                                                    Margin="22,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    shared_windows:WindowChrome.IsHitTestVisibleInChrome="True"
                                                    Style="{StaticResource BackstageButtonStyle}" />

                            </Grid>

                            <ItemsPresenter Grid.Row="1" />

                        </Grid>



                        <!--  Top Row  -->

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!--  BackStage Button Style  -->
    <Style TargetType="{x:Type tools_controls:BackStageButton}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:BackStageButton}">
                    <Border x:Name="border2"
                            Height="25"
                            MinWidth="62"
                            Margin="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Background="{Binding Path=BackStageColor,
                                                 RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Ribbon}}}"
                            SnapsToDevicePixels="True">
                        <Grid>
                            <TextBlock x:Name="contentPresenter"
                                       Margin="0,5"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       SnapsToDevicePixels="True"
                                       Text="{TemplateBinding Header}"
                                       TextBlock.Foreground="{StaticResource ActiveForegroundBrush}"
                                       TextTrimming="CharacterEllipsis"
                                       TextWrapping="NoWrap">
                                <TextBlock.Effect>
                                    <DropShadowEffect BlurRadius="4"
                                                      Opacity="0.605"
                                                      ShadowDepth="0" />
                                </TextBlock.Effect>
                            </TextBlock>

                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!--  BackStage TabItem Style  -->
    <Style TargetType="{x:Type tools_controls:BackstageTabItem}">
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="MinHeight" Value="38" />
        <Setter Property="MinWidth" Value="125" />
        <Setter Property="Margin" Value="0,2,0,1" />

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:BackstageTabItem}">
                    <Grid x:Name="layoutRoot" Background="{StaticResource ActiveBackgroundBrush}">

                        <Border x:Name="hoverBorder"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}"
                                Margin="0,0,1,0"
                                Background="{Binding Path=BackStageColor,
                                                     RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                Visibility="Collapsed">
                            <Border Background="{StaticResource ActiveDarkBackground}" />
                        </Border>
                        <Border x:Name="selectedBorder"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}"
                                Background="{DynamicResource ActiveLightBackground}"
                                Visibility="Collapsed" />
                        <ContentPresenter x:Name="controlLabel"
                                          Margin="19,0"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Center"
                                          ContentSource="Header"
                                          ContentTemplate="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Backstage}},
                                                                    Path=TabHeaderTemplate}"
                                          ContentTemplateSelector="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Backstage}}, Path=ItemTemplateSelector}"
                                          TextElement.Foreground="{TemplateBinding Foreground}" />

                    </Grid>
                    <ControlTemplate.Triggers>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsEnabled" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="hoverBorder" Property="Visibility" Value="Visible" />

                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="hoverBorder" Property="Visibility" Value="Hidden" />
                            <Setter TargetName="controlLabel" Property="Opacity" Value="0.5" />
                        </Trigger>

                        <Trigger Property="Selector.IsSelected" Value="True">
                            <Setter TargetName="selectedBorder" Property="Visibility" Value="Visible" />
                            <Setter TargetName="controlLabel" Property="TextElement.Foreground"  Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:Backstage}},Path=SelectedTabItemForeground}" />


                        </Trigger>
                        <Trigger Property="Selector.IsSelected" Value="false">
                            <Setter TargetName="selectedBorder" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="controlLabel" Property="TextElement.Foreground"  Value="{StaticResource ActiveForegroundBrush}" />


                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" SourceName="layoutRoot" />
                                <Condition Property="Selector.IsSelected" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="hoverBorder" Property="Visibility" Value="Visible" />
                            <Setter TargetName="selectedBorder" Property="Visibility" Value="Collapsed" />

                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  BackStage CommandButton Style  -->
    <Style TargetType="{x:Type tools_controls:BackStageCommandButton}">
        <Setter Property="Foreground" Value="{StaticResource ActiveForegroundBrush}" />

        <Setter Property="MinHeight" Value="38" />
        <Setter Property="MinWidth" Value="125" />
        <Setter Property="Margin" Value="0,2,0,2" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:BackStageCommandButton}">
                    <Grid Background="Transparent">
                        <Border x:Name="border"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}"
                                Background="{Binding Path=BackStageColor,
                                                     RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}"
                                BorderBrush="{Binding Path=BackStageColor,
                                                      RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}}"
                                Visibility="Collapsed">
                            <Border Background="{StaticResource ActiveDarkBackground}" />
                        </Border>
                        <StackPanel Margin="16,0,15,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                            <Image x:Name="iconImage"
                                   Width="16"
                                   Height="16"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   SnapsToDevicePixels="True"
                                   Source="{TemplateBinding Icon}" />
                            <tools_controls:RibbonAutomatableTextBlock x:Name="controlLabel"
                                       Margin="5,0,0,0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Text="{TemplateBinding Header}"
                                       TextTrimming="CharacterEllipsis"
                                       TextWrapping="NoWrap" />
                        </StackPanel>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="Icon" Value="{x:Null}">
                            <Setter TargetName="iconImage" Property="Visibility"  Value="Collapsed" />
                            <Setter TargetName="controlLabel" Property="Margin"  Value="3,0,0,0" />

                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsEnabled" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="border" Property="Visibility" Value="Visible" />

                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="iconImage" Property="Opacity" Value="0.5" />
                            <Setter TargetName="controlLabel" Property="Opacity" Value="0.5" />

                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Ribbon Minimize Button  -->

    <Style x:Key="RibbonToggleButtonStyle" TargetType="{x:Type tools_controls:RibbonToggleButton}">
        <Setter Property="Height" Value="22" />
        <Setter Property="Width" Value="29" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:RibbonToggleButton}">
                    <Grid>
                        <Border x:Name="border"
                                Width="29"
                                Height="22"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Stretch"
                                Background="Transparent">
                            <Grid>
                                <Path x:Name="path1"
                                      Width="7"
                                      Height="5"
                                      VerticalAlignment="Center"
                                      Data="M4.0209999,0 L5.313,0 5.313,1.3329999 6.6670001,1.3329999 6.6670001,2.667 7.9789999,2.667 7.9999998,2.667 7.9999998,3.9380001 9.3329999,3.9380001 9.3329999,6.6670001 6.6460001,6.6670001 6.6460001,5.313 5.3329999,5.313 5.3329999,3.9790001 5.313,3.9790001 5.313,4 4.0209999,4 4.0209999,3.9790001 4,3.9790001 4,5.313 2.6869999,5.313 2.6869999,6.6670001 0,6.6670001 0,3.9580001 &#10;1.333,3.9580001 1.333,2.667 1.3539999,2.667 2.6869999,2.667 2.6869999,1.3329999 4.0209999,1.3329999 z"
                                      Fill="#00000000"
                                      Stretch="Fill" />
                                <Path x:Name="path2"
                                      Width="10"
                                      Height="8"
                                      Data="M5.3329997,0 L6.6939998,0 6.6939998,1.3620001 7.9999998,1.3620001 7.9999998,2.667 12,2.667 12,1.3620001 13.361,1.3620001 13.361,9.3069999 12,9.3069999 12,8.0000002 7.9999998,8.0000002 7.9999998,9.3339999 6.6939998,9.3339999 6.6939998,10.641 5.3329997,10.641 5.3329997,6.6670001 0,6.6670001 0,3.9740001 5.3329997,3.9740001 z"
                                      Fill="#00000000"
                                      Stretch="Fill"
                                      Visibility="Collapsed" />
                            </Grid>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>


                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}}, Path=RibbonState}" Value="Normal">
                            <Setter TargetName="path2" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="path1" Property="Visibility" Value="Visible" />
                        </DataTrigger>



                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:Ribbon}}, Path=RibbonState}" Value="Adorner">
                            <Setter TargetName="path2" Property="Visibility" Value="Visible" />
                            <Setter TargetName="path1" Property="Visibility" Value="Collapsed" />
                        </DataTrigger>

                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="path2" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="path1" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border" Property="Background" Value="{DynamicResource ActiveBackgroundBrush}" />


                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsPressed" Value="False" />
                            </MultiTrigger.Conditions>

                            <Setter TargetName="border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
                            </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsKeyboardFocusWithin" Value="True" />
                                <Condition Property="IsPressed" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="path2" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="path1" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border" Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />

                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Ribbon ToggleButton Style -->

    <Style x:Key="Office2013RibbonToggleButtonStyle" TargetType="tools_controls:RibbonToggleButton">
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="SmallIcon" Value="/Syncfusion.Shared.WPF;component//Controls/ButtonControls/Images/WordArt16.png"/>
        <Setter Property="LargeIcon" Value="/Syncfusion.Shared.WPF;component//Controls/ButtonControls/Images/WordArt32.png"/>
        <Setter Property="Label" Value="RibbonToggleButton"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="HorizontalAlignment" Value="Center"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="MinHeight" Value="22"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="tools_controls:RibbonToggleButton">
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter Property="Border.Background" TargetName="ItemBorder" Value="{DynamicResource HoverBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="ItemBorder1" Value="{DynamicResource HoverBackgroundBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Border.Background" TargetName="ItemBorder" Value="{DynamicResource ActiveBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="ItemBorder1" Value="{DynamicResource ActiveBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="InnerBorder" Value="{DynamicResource ActiveBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="InnerBorder1" Value="{DynamicResource ActiveBackgroundBrush}"/>
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter Property="Border.Background" TargetName="ItemBorder" Value="{DynamicResource ActiveBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="ItemBorder1" Value="{DynamicResource ActiveBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="InnerBorder" Value="{DynamicResource ActiveBackgroundBrush}"/>
                            <Setter Property="Border.Background" TargetName="InnerBorder1" Value="{DynamicResource ActiveBackgroundBrush}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Border.Opacity" TargetName="ItemBorder" Value="0.5"/>
                            <Setter Property="Border.Opacity" TargetName="ItemBorder1" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                    <Grid>
                        <Border x:Name="ItemCheckedBorder" CornerRadius="1" Opacity="0"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                Background="Transparent" 
                                BorderBrush="Transparent"/>
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                MinHeight="22" Name="ItemBorder" SnapsToDevicePixels="True" CornerRadius="3">
                            <Border Background="Transparent" Margin="1,1,1,0" CornerRadius="2" x:Name="InnerBorder">
                                <Grid Margin="{TemplateBinding Padding}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Border Name="PART_ImageBorder" Grid.Column="0">
                                        <Image Margin="2" x:Name="smallImage" Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
						            Width="{Binding Path=IconWidth, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonToggleButton}}}" Height="{Binding Path=IconHeight,RelativeSource={RelativeSource AncestorType={x:Type tools_controls:RibbonToggleButton}}}"   
						            Source="{Binding Path=SmallIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"/>
                                    </Border>
                                    <AccessText Grid.Column="1" x:Name="PART_Text"
                                           Text="{TemplateBinding Label}" 
                                           Foreground="{TemplateBinding Foreground}"
                                           FontFamily="{TemplateBinding FontFamily}"
                                           FontSize="{TemplateBinding FontSize}"
                                           VerticalAlignment="{TemplateBinding VerticalAlignment}"                           
                                           HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                           Margin="2,0,4,0"/>
                                </Grid>
                            </Border>
                        </Border>
                        <Border Background="{TemplateBinding Background}" Visibility="Collapsed"
                                BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}"
                                MinHeight="22" Name="ItemBorder1" SnapsToDevicePixels="True" CornerRadius="3">
                            <Border Background="Transparent" Margin="1,1,1,0" CornerRadius="2" x:Name="InnerBorder1">
                                <StackPanel Margin="{TemplateBinding Padding}">
                                    <Border Name="PART_ImageBorderLarge">
                                        <Image Margin="2" Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
						            Width="26" Height="26"   x:Name="LargeImage"
						            Source="{Binding Path=LargeIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"/>
                                    </Border>
                                    <ItemsControl x:Name="PART_TextAreaLarge"
                                               VerticalAlignment="{TemplateBinding VerticalAlignment}"                           
                                               HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                               Margin="2,0,4,0"/>
                                </StackPanel>
                            </Border>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style BasedOn="{StaticResource Office2013RibbonToggleButtonStyle}" TargetType="tools_controls:RibbonToggleButton"/>

</ResourceDictionary>
