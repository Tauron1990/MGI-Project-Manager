<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"  
					xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
					xmlns:tools_controls="clr-namespace:Syncfusion.Windows.Tools.Controls;assembly=Syncfusion.Tools.WPF"
                    xmlns:shared="clr-namespace:Syncfusion.Windows.Shared;assembly=Syncfusion.Shared.WPF">
    <ResourceDictionary.MergedDictionaries>

</ResourceDictionary.MergedDictionaries>

<LinearGradientBrush x:Key="BackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FFEEEEF2" Offset="0" /><GradientStop Color="#FFEEEEF2" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="BorderBrush" Color="#FFCCCEDB" />
	<SolidColorBrush x:Key="ForegroundBrush" Color="#FF404040" />
	<SolidColorBrush x:Key="GlyphBrush" Color="#FF404040" />
<LinearGradientBrush x:Key="HeaderBackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FFEEEEF2" Offset="0" /><GradientStop Color="#FFEEEEF2" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="HeaderBorderBrush" Color="#FFCCCEDB" />
	<SolidColorBrush x:Key="HeaderForegroundBrush" Color="#FF404040" />
	<SolidColorBrush x:Key="HeaderGlyphBrush" Color="#FF404040" />
<LinearGradientBrush x:Key="HoverBackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FF7FBCE5" Offset="0" /><GradientStop Color="#FF7FBCE5" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="HoverBorderBrush" Color="#FF7FBCE5" />
	<SolidColorBrush x:Key="HoverForegroundBrush" Color="#FF404040" />
	<SolidColorBrush x:Key="HoverGlyphBrush" Color="#FF404040" />
<LinearGradientBrush x:Key="ActiveBackgroundBrush" StartPoint="0,0" EndPoint="1,1" ><GradientStop Color="#FF007ACC" Offset="0" /><GradientStop Color="#FF007ACC" Offset="1" /></LinearGradientBrush>
    <SolidColorBrush x:Key="ActiveBorderBrush" Color="#FF007ACC" />
	<SolidColorBrush x:Key="ActiveForegroundBrush" Color="#FFFFFFFF" />
	<SolidColorBrush x:Key="ActiveGlyphBrush" Color="#FFFFFFFF" />
	<SolidColorBrush x:Key="ContentBackgroundBrush" Color="#FFF5F5F5" />
	<SolidColorBrush x:Key="ContentBorderBrush" Color="#FFCCCEDB" />
	<SolidColorBrush x:Key="ContentForegroundBrush" Color="#FF1E1E1E" />
	<SolidColorBrush x:Key="ContentSelectionBrush" Color="#FFA5A5A5" />
	<SolidColorBrush x:Key="SelectionInActiveBrush" Color="#FF99C9EA" />
	<SolidColorBrush x:Key="ErrorBrush" Color="#FFFF0000" />
	<SolidColorBrush x:Key="ActiveLightBackground" Color="#FF99C9EA" />
	<SolidColorBrush x:Key="ActiveDarkBackground" Color="#FF003D66" />
	<SolidColorBrush x:Key="ContentAlternativeBackground" Color="#FFDCDCDC" />
	<SolidColorBrush x:Key="TickColor" Color="#FFBCBCBC" />
	<SolidColorBrush x:Key="RangeColor1" Color="#FF61A301" />	
	<SolidColorBrush x:Key="RangeColor2" Color="#FFF2E606" />	
	<SolidColorBrush x:Key="RangeColor3" Color="#FFFF0000" />
	<SolidColorBrush x:Key="LightBackgroundBrush" Color="#FFDDDDE5" />

    <!--Brushes-->
 
 <SolidColorBrush x:Key="ErrorBrush" Color="Red"/>
    <FontFamily x:Key="TreeViewFontFamily">Segoe UI</FontFamily>
    
    <!--Animation-->

    <DoubleAnimation x:Key="TreeViewItemAdv_ExpandAnimation"
                     Duration="0:0:0.5" />

    <DoubleAnimation x:Key="TreeViewItemAdv_FadeAnimation"
                     Duration="0:0:0.5" />

    <!-- Arrow-->
    <PathGeometry x:Key="TreeViewTreeArrow">
        <PathGeometry.Figures>
            <PathFigureCollection>
                <PathFigure IsFilled="True"
                            StartPoint="0 0"
                            IsClosed="True">
                    <PathFigure.Segments>
                        <PathSegmentCollection>
                            <LineSegment Point="0 6" />
                            <LineSegment Point="6 0" />
                        </PathSegmentCollection>
                    </PathFigure.Segments>
                </PathFigure>
            </PathFigureCollection>
        </PathGeometry.Figures>
    </PathGeometry>

    <DataTemplate x:Key="draggingContainerTemplate">
        <Grid x:Name="draggingStack">
            <Border BorderBrush="{StaticResource ActiveBorderBrush}" Background="{StaticResource SelectionInActiveBrush}" BorderThickness="1" HorizontalAlignment="Left" Margin="0" Width="50" Height="50" VerticalAlignment="Top" />
            <Border BorderBrush="{StaticResource ActiveBorderBrush}" Background="{StaticResource SelectionInActiveBrush}" BorderThickness="1" HorizontalAlignment="Left" Height="50" Margin="5,5,0,0" VerticalAlignment="Top" Width="50" />
            <Border BorderBrush="{StaticResource ActiveBorderBrush}" Background="{StaticResource SelectionInActiveBrush}" BorderThickness="1" HorizontalAlignment="Left" Height="50" Margin="10,10,0,0" VerticalAlignment="Top" Width="50">
                <TextBlock HorizontalAlignment="Center" Background="{StaticResource ContentBackgroundBrush}" TextAlignment="Center" VerticalAlignment="Center" Foreground="{StaticResource ContentForegroundBrush}" />
            </Border>
        </Grid>
    </DataTemplate>

    <!-- Default SortingArrowStyle for SortingArrows on column header   -->
    <Style TargetType="{x:Type Path}" x:Key="SortingArrowStyle">
        <Setter Property="Fill" Value="{StaticResource GlyphBrush}"></Setter>
        <Setter Property="Data" Value="M 5,10 L 15,10 L 10,5 L 5,10"></Setter>
        <Setter Property="StrokeThickness" Value="0"></Setter>
        <Setter Property="Stroke" Value="{StaticResource GlyphBrush}"></Setter>
    </Style>

    <PathGeometry x:Key="TouchTreeArrow">
        <PathGeometry.Figures>
            <PathFigureCollection>
                <PathFigure IsFilled="True"
                            StartPoint="0 0"
                            IsClosed="True">
                    <PathFigure.Segments>
                        <PathSegmentCollection>
                            <LineSegment Point="0 9" />
                            <LineSegment Point="9 0" />
                        </PathSegmentCollection>
                    </PathFigure.Segments>
                </PathFigure>
            </PathFigureCollection>
        </PathGeometry.Figures>
    </PathGeometry>
    <!-- Style for Expander -->
    <Style x:Key="TreeViewAdvExpanderBaseStyle" TargetType="{x:Type Expander}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Expander}">
                    <ToggleButton Name="Expander"
					  ClickMode="Press"
					  IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}">
                        <ToggleButton.Style>
                            <Style TargetType="{x:Type ToggleButton}">
                                <Setter Property="FrameworkElement.Focusable" Value="False" />
                                <Setter Property="FrameworkElement.Width" Value="16" />
                                <Setter Property="FrameworkElement.Height" Value="16" />
                                <Setter Property="FrameworkElement.Margin" Value="0,0,0,0" />
                                <Setter Property="Control.Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ToggleButton">
                                            <!--<Border Background="Transparent" Width="18"  Height="18">-->
                                            <Path Name="ExpandPath"
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Center"
                                                  Fill="{StaticResource GlyphBrush}"  Height="8" Width="8"
                                                  Stroke="{StaticResource GlyphBrush}" Data="M0,0 L0,6 L6,0 z" SnapsToDevicePixels="True">
                                                <Path.RenderTransform>
                                                    <RotateTransform Angle="135" CenterX="3" CenterY="3" />
                                                </Path.RenderTransform>
                                            </Path>
                                            <!--</Border>-->
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="true">
                                                    <Setter TargetName="ExpandPath" Property="Data" Value="{StaticResource TouchTreeArrow}" />
                                                    <Setter TargetName="ExpandPath" Property="Height"  Value="12" />
                                                    <Setter TargetName="ExpandPath" Property="Width"  Value="12" />
                                                    <Setter Property="FrameworkElement.Width" Value="24" />
                                                    <Setter Property="FrameworkElement.Height" Value="24" />
                                                    <Setter Property="FrameworkElement.Margin" Value="8,0,0,0" />
                                                </Trigger>
                                                <Trigger Property="ToggleButton.IsChecked" Value="True">
                                                    <Setter TargetName="ExpandPath" Property="UIElement.RenderTransform">
                                                        <Setter.Value>
                                                            <RotateTransform Angle="180" CenterX="3" CenterY="3" />
                                                        </Setter.Value>
                                                    </Setter>
                                                    <!--<Setter TargetName="ExpandPath" Property="Fill" Value="#FF333333" />
                                                    <Setter TargetName="ExpandPath" Property="Stroke" Value="#FF333333" />-->
                                                </Trigger>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding="{Binding Path=IsSelected,RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewItemAdv}}}" Value="true" />
                                                        <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch),RelativeSource={RelativeSource  AncestorType={x:Type tools_controls:TreeViewItemAdv}}}" Value="true" />
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter TargetName="ExpandPath" Property="Fill"  Value="{StaticResource ActiveGlyphBrush}" />
                                                    <Setter TargetName="ExpandPath" Property="Stroke"  Value="{StaticResource ActiveBorderBrush}" />
                                                </MultiDataTrigger>

                                                <MultiTrigger>
                                                    <MultiTrigger.Conditions>
                                                        <Condition Property="UIElement.IsMouseOver" Value="True" />
                                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                                                    </MultiTrigger.Conditions>
                                                </MultiTrigger>
                                                <MultiTrigger>
                                                    <MultiTrigger.Conditions>
                                                        <Condition Property="UIElement.IsMouseOver" Value="True" />
                                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                                                    </MultiTrigger.Conditions>
                                                    <Setter TargetName="ExpandPath" Property="Stroke" Value="{StaticResource HoverGlyphBrush}" />
                                                    <Setter TargetName="ExpandPath" Property="Fill" Value="{StaticResource HoverGlyphBrush}" />
                                                </MultiTrigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ToggleButton.Style>
                    </ToggleButton>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for TreeViewAdv -->
    <Style x:Key="MetroTreeViewAdvStyle" TargetType="{x:Type tools_controls:TreeViewAdv}">
        <Setter Property="SortingDirectionArrowStyle" Value="{StaticResource SortingArrowStyle}" />
        <Setter Property="Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource ContentBorderBrush}" />
        <Setter Property="Foreground" Value="{StaticResource  ContentForegroundBrush}" />
        <Setter Property="SelectedBackground" Value="{DynamicResource  ActiveBackgroundBrush}" />
        <Setter Property="SelectionUnfocussedBackcolor" Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="SelectedForeground" Value="{DynamicResource  ActiveForegroundBrush}" />
        <Setter Property="SelectedBorderBrush" Value="Transparent" />
        <Setter Property="MouseOverBackground" Value="{DynamicResource  HoverBackgroundBrush}" />
        <Setter Property="MouseOverForeground" Value="{DynamicResource  HoverForegroundBrush}" />
        <Setter Property="MouseOverBorderBrush" Value="{DynamicResource  HoverBorderBrush}" />
        <Setter Property="LineBrush" Value="{StaticResource BorderBrush}" />
        <Setter Property="FakeItemForeground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="BorderThickness" Value="1,1,1,1" />
        <Setter Property="Padding" Value="1,1,1,1" />
        <Setter Property="Focusable" Value="True" />
        <Setter Property="AllowDrop" Value="True" />
        <Setter Property="LineStrokeDashArray" Value="2" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="{x:Static ScrollBarVisibility.Auto}" />
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="{x:Static ScrollBarVisibility.Auto}" />
        <Setter Property="ScrollViewer.Focusable" Value="False" />
        <Setter Property="Control.VerticalContentAlignment" Value="{x:Static VerticalAlignment.Center}" />
        <Setter Property="KeyboardNavigation.TabNavigation" Value="Continue" />
        <Setter Property="KeyboardNavigation.DirectionalNavigation" Value="Contained" />
        <Setter Property="ExpanderStyle" Value="{StaticResource TreeViewAdvExpanderBaseStyle}" />
        <Setter Property="EditedItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBox Name="TreeViewItemAdvText"
                         KeyboardNavigation.IsTabStop="True"
 />
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <tools_controls:TreeViewAdvVirtualizingPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>

        <!--<Setter Property="LinePen">
            <Setter.Value>
                <Pen Brush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                     DashStyle="{x:Static DashStyles.Dot}"
                     Thickness="1"
                     DashCap="Square"
                     StartLineCap="Square"
                     EndLineCap="Square"
                     LineJoin="Miter" />
            </Setter.Value>
        </Setter>-->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:TreeViewAdv}">
                    <Border Name="PART_Border"
                        BorderBrush="{TemplateBinding BorderBrush}"
				        BorderThickness="{TemplateBinding Border.BorderThickness}"
                        CornerRadius="{TemplateBinding Border.CornerRadius}"
                        Margin="{TemplateBinding Border.BorderThickness}"
                        Padding="{TemplateBinding Border.Padding}"
                        Background="{TemplateBinding Background}">
                        <ScrollViewer Name="PART_ScrollViwer"
						  Focusable="{TemplateBinding ScrollViewer.Focusable}"
						  Background="{TemplateBinding Panel.Background}"
						  HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
						  VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
						  Padding="{TemplateBinding Control.Padding}"
						  CanContentScroll="True">
                            <ScrollViewer.Style>
                                <Style TargetType="ScrollViewer">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ScrollViewer">
                                                <Grid Background="{TemplateBinding Panel.Background}">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <ScrollViewer VerticalScrollBarVisibility="Disabled"
                                                                HorizontalScrollBarVisibility="Hidden">
                                                        <tools_controls:TreeViewHeaderRowPresenter
                                                                            Grid.Row="0"
                                                                            Grid.ColumnSpan="2" Height="0"
                                                                            Columns="{Binding Path=Columns, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                                    </ScrollViewer>
                                                    <ScrollContentPresenter Name="PART_ScrollContentPresenter"
                                                                Grid.Row="1"
                                                                Grid.Column="0"
                                                                Margin="{TemplateBinding Control.Padding}"
                                                                Content="{TemplateBinding ContentControl.Content}"
                                                                ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"
                                                                CanContentScroll="True"
                                                                SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"
                                                                KeyboardNavigation.DirectionalNavigation="Local" />
                                                    <ScrollBar Name="PART_VerticalScrollBar"
                                                               Grid.Column="1"
                                                               Grid.Row="0"
                                                               Grid.RowSpan="2"
                                                               Orientation="Vertical"
                                                               Minimum="0"
                                                               Maximum="{TemplateBinding ScrollableHeight}"
                                                               ViewportSize="{TemplateBinding ViewportHeight}"
                                                               Value="{TemplateBinding VerticalOffset}"
                                                               Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                                               Cursor="Arrow"
                                                               AutomationProperties.AutomationId="VerticalScrollBar" />
                                                    <ScrollBar Name="PART_HorizontalScrollBar"
                                                               Grid.Column="0"
                                                               Grid.Row="2"
                                                               Orientation="Horizontal"
                                                               Minimum="0"
                                                               Maximum="{TemplateBinding ScrollableWidth}"
                                                               ViewportSize="{TemplateBinding ViewportWidth}"
                                                               Value="{TemplateBinding HorizontalOffset}"
                                                               Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                                               Cursor="Arrow"
                                                               AutomationProperties.AutomationId="HorizontalScrollBar" />
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ScrollViewer.Style>
                            <ItemsPresenter Name="PART_ItemPresenter" VerticalAlignment="Top" />
                        </ScrollViewer>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="true">
                            <Setter Property="Padding" TargetName="PART_ScrollViwer" Value="0" />
                            <Setter Property="ShowRootLines" Value="False" />

                            <Setter Property="AnimationType" Value="None" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="ItemsControl.HasItems" Value="False" />
                                <Condition Property="FrameworkElement.Width" Value="NaN" />
                            </MultiTrigger.Conditions>
                            <Setter Property="FrameworkElement.MinWidth" Value="120" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="ItemsControl.HasItems" Value="False" />
                                <Condition Property="FrameworkElement.Height" Value="NaN" />
                            </MultiTrigger.Conditions>
                            <Setter Property="FrameworkElement.MinHeight" Value="95" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="MultiColumnEnable" Value="True">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:TreeViewAdv}">
                            <Border Name="PART_Border"
                                BorderBrush="{TemplateBinding Border.BorderBrush}"
				                BorderThickness="{TemplateBinding Border.BorderThickness}"
                                CornerRadius="{TemplateBinding Border.CornerRadius}"
                                Margin="{TemplateBinding Border.BorderThickness}"
                                Padding="{TemplateBinding Border.Padding}"
                                Background="{TemplateBinding Border.Background}">
                                <ScrollViewer Name="PART_ScrollViwer"
						              Focusable="False"
						              Background="{TemplateBinding Panel.Background}"
						              HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
						              VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
						              Padding="{TemplateBinding Control.Padding}"
						              CanContentScroll="True">
                                    <ScrollViewer.Style>
                                        <Style TargetType="ScrollViewer">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ScrollViewer">
                                                        <Grid Background="{TemplateBinding Panel.Background}">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto" />
                                                                <RowDefinition Height="*" />
                                                                <RowDefinition Height="Auto" />
                                                            </Grid.RowDefinitions>
                                                            <ScrollViewer VerticalScrollBarVisibility="Disabled"
                                                      HorizontalScrollBarVisibility="Hidden">
                                                                <tools_controls:TreeViewHeaderRowPresenter Name="PART_HeaderRowPresenter"
                                                                            Grid.Row="0"
                                                                            Grid.ColumnSpan="2"
                                                                            Columns="{Binding Path=Columns, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                                            </ScrollViewer>
                                                            <ScrollContentPresenter Name="PART_ScrollContentPresenter"
                                                                Grid.Row="1"
                                                                Grid.Column="0"
                                                                Margin="{TemplateBinding Control.Padding}"
                                                                Content="{TemplateBinding ContentControl.Content}"
                                                                ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"
                                                                CanContentScroll="True"
                                                                SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"
                                                                KeyboardNavigation.DirectionalNavigation="Local" />
                                                            <ScrollBar Name="PART_VerticalScrollBar"
                                                               Grid.Column="1"
                                                               Grid.Row="0"
                                                               Grid.RowSpan="2"
                                                               Minimum="0"
                                                               Maximum="{TemplateBinding ScrollableHeight}"
                                                               ViewportSize="{TemplateBinding ViewportHeight}"
                                                               Value="{TemplateBinding VerticalOffset}"
                                                               Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                                               Cursor="Arrow"
                                                               AutomationProperties.AutomationId="VerticalScrollBar" />
                                                            <ScrollBar Name="PART_HorizontalScrollBar"
                                                               Grid.Column="0"
                                                               Grid.Row="2"
                                                               Orientation="Horizontal"
                                                               Minimum="0"
                                                               Maximum="{TemplateBinding ScrollableWidth}"
                                                               ViewportSize="{TemplateBinding ViewportWidth}"
                                                               Value="{TemplateBinding HorizontalOffset}"
                                                               Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                                               Cursor="Arrow"
                                                               AutomationProperties.AutomationId="HorizontalScrollBar" />
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ScrollViewer.Style>
                                    <ItemsPresenter Name="PART_ItemPresenter" VerticalAlignment="Top" />
                                </ScrollViewer>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="true">
                                    <Setter Property="Padding" TargetName="PART_ScrollViwer" Value="0" />
                                    <Setter Property="ShowRootLines" Value="False" />

                                    <Setter Property="AnimationType" Value="None" />
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="ItemsControl.HasItems" Value="False" />
                                        <Condition Property="FrameworkElement.Width" Value="NaN" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="FrameworkElement.MinWidth" Value="120" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="ItemsControl.HasItems" Value="False" />
                                        <Condition Property="FrameworkElement.Height" Value="NaN" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="FrameworkElement.MinHeight" Value="95" />
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource MetroTreeViewAdvStyle}" TargetType="{x:Type tools_controls:TreeViewAdv}" />

        <!-- Style for TreeViewColumnHeader -->
    <Style TargetType="{x:Type tools_controls:TreeViewColumnHeader}">
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Background" Value="{StaticResource HeaderBackgroundBrush}" />
        <Setter Property="Control.HorizontalContentAlignment" Value="Center" />
        <Setter Property="Control.VerticalContentAlignment" Value="Center" />
        <Setter Property="FontFamily" Value="Segoe WP" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:TreeViewColumnHeader}">
                    <Grid Background="{TemplateBinding Panel.Background}" SnapsToDevicePixels="True">
                        <Border BorderThickness="0"  x:Name="Bd"

                    Background="{StaticResource HeaderBackgroundBrush}"
                    Margin="0">
                            <Border Name="PART_PressBorder"
                        Margin="1,0,1,0"
                        BorderThickness="0">
                                <Grid Margin="{TemplateBinding Padding}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter Name="HeaderContent"
                                  RecognizesAccessKey="True"
                                  Content="{TemplateBinding ContentControl.Content}"
                                  ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"
                                  Margin="0,0,0,1" TextElement.FontWeight="Bold"
                                  HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
                                  VerticalAlignment="{TemplateBinding Control.VerticalContentAlignment}"
                                  SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
                                    <Path x:Name="arrow" VerticalAlignment="Center"  Style="{Binding Path=SortingDirectionArrowStyle, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}" Visibility="Collapsed" Grid.Column="1"  Margin="0,0,5,6" />
                                </Grid>
                            </Border>
                        </Border>

                        <Canvas>
                            <Thumb Name="PART_HeaderGripper">
                                <Thumb.Style>
                                    <Style TargetType="Thumb">
                                        <Setter Property="Canvas.Right" Value="-9" />
                                        <Setter Property="FrameworkElement.Width" Value="18" />
                                        <Setter Property="FrameworkElement.Height">
                                            <Setter.Value>
                                                <Binding Path="ActualHeight" RelativeSource="{RelativeSource Mode=TemplatedParent}" />
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Control.Padding" Value="0,3,0,4" />
                                        <Setter Property="Panel.Background" Value="{StaticResource HeaderBackgroundBrush}" />
                                        <Setter Property="Control.Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Thumb">
                                                    <Border Padding="{TemplateBinding Control.Padding}" Background="{StaticResource HeaderBackgroundBrush}">
                                                        <DockPanel HorizontalAlignment="Center">
                                                            <Rectangle Fill="{StaticResource HeaderGlyphBrush}"  Width="1" />
                                                        </DockPanel>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Thumb.Style>
                            </Thumb>
                        </Canvas>
                        <Border BorderThickness="1,1,1,1" Name="HeaderPressBorder" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="true">
                            <Setter Property="FontSize" Value="18" />
                            <Setter Property="Padding" Value="2,9,2,9" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsPressedHeader" Value="True" />
                                <Condition Property="tools_controls:TreeViewHeaderRowPresenter.AllowsColumnReorder" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource  ActiveBorderBrush}" />
                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource  ActiveBackgroundBrush}" />
                            <Setter Property="TextBlock.Foreground" Value="{DynamicResource ActiveForegroundBrush}" TargetName="HeaderContent" />
                        </MultiTrigger>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter Property="Background" TargetName="PART_PressBorder" Value="{DynamicResource HoverBackgroundBrush}" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter Property="Background" TargetName="PART_PressBorder" Value="{DynamicResource  ActiveBackgroundBrush}" />
                            <Setter Property="TextBlock.Foreground" Value="{DynamicResource ActiveForegroundBrush}" TargetName="HeaderContent" />
                            <Setter TargetName="arrow" Property="Fill" Value="{DynamicResource ActiveGlyphBrush}"></Setter>
                        </Trigger>
                        <Trigger Property="FrameworkElement.Height" Value="NaN">
                            <Setter Property="FrameworkElement.MinHeight" Value="20" />
                        </Trigger>
                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="TextElement.Foreground">
                                <Setter.Value>
                                    <DynamicResource ResourceKey="{x:Static SystemColors.GrayTextBrushKey}" />
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="SortDirection" Value="Ascending" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="arrow" Property="Visibility" Value="Visible" />
                            <Setter TargetName="arrow" Property="Data" Value="M 0,10 L 15,10 L 8,1 L 0,10"></Setter>
                        </MultiTrigger>

                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="SortDirection" Value="Ascending" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="arrow" Property="Visibility" Value="Visible" />
                            <Setter TargetName="arrow" Property="Data" Value="M 5,10 L 15,10 L 10,5 L 5,10"></Setter>
                        </MultiTrigger>

                        <Trigger Property="SortDirection" Value="None">
                            <Setter TargetName="arrow" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="SortDirection" Value="Descending" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                            </MultiTrigger.Conditions>

                            <Setter TargetName="arrow" Property="Visibility" Value="Visible" />
                            <Setter TargetName="arrow" Property="Data" Value="M 5,5 L 10,10 L 15,5 L 5,5"></Setter>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="SortDirection" Value="Descending" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="arrow" Property="Data" Value="M 8,8 L 16,16 L 24,8 L 8,8"></Setter>
                            <Setter TargetName="arrow" Property="Visibility" Value="Visible" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for TreeViewItemAdv -->

    <Storyboard RepeatBehavior="Forever" x:Key="loadOnDemandStoryBoard">

        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)"
                                                                       Storyboard.TargetName="path">
            <LinearDoubleKeyFrame KeyTime="0" Value="0" />
            <LinearDoubleKeyFrame KeyTime="0:0:1" Value="360" />
        </DoubleAnimationUsingKeyFrames>
    </Storyboard>

    <Style x:Key="MetroTreeViewItemAdvStyle" TargetType="{x:Type tools_controls:TreeViewItemAdv}">
        <Setter Property="ExpandAnimation" Value="{StaticResource TreeViewItemAdv_ExpandAnimation}" />
        <Setter Property="FadeAnimation" Value="{StaticResource TreeViewItemAdv_FadeAnimation}" />
        <Setter Property="Panel.Background" Value="{StaticResource ContentBackgroundBrush}" />
        <Setter Property="Control.Padding" Value="2,0,2,0" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="KeyboardNavigation.DirectionalNavigation" Value="Local" />
        <Setter Property="Focusable" Value="True" />
        <Setter Property="KeyboardNavigation.IsTabStop" Value="False" />
        <Setter Property="KeyboardNavigation.TabNavigation" Value="None" />
        <Setter Property="Foreground" Value="{StaticResource ContentForegroundBrush}" />
        <Setter Property="FontFamily" Value="{DynamicResource TreeViewFontFamily}" />
        <Setter Property="FrameworkElement.FocusVisualStyle">
            <Setter.Value>
                <Style TargetType="IFrameworkInputElement">
                    <Setter Property="Control.Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <Border>
                                    <Rectangle Margin="0,0,0,0" Stroke="{StaticResource GlyphBrush}" StrokeDashArray="1 2" Opacity="0" StrokeThickness="5" />
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <tools_controls:TreeViewAdvVirtualizingPanel Name="PART_ItemsPanel" IsShowLine="{Binding Path=ShowRootLines, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="tools_controls:TreeViewItemAdv">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" Background="{StaticResource BackgroundBrush}" Height="2" Name="Part_TopDragLine" Visibility="Collapsed" />
                        <Grid Focusable="False" Background="{StaticResource ContentBackgroundBrush}" Grid.Row="1"
			            TextElement.Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Grid.RowSpan="2" Name="VertLineGrid">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <tools_controls:TreeRootLine Width="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                  Margin="0,0,0,0"
                                  Panel.ZIndex="0"
                                  Focusable="False" IsVerticalLine="True"
                                  Name="PART_VerticalLinePartOne" Grid.Row="0" SnapsToDevicePixels="True"
                                  LineBrush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                  LineStrokeThickness="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                  Visibility="Visible"
 />
                                <tools_controls:TreeRootLine Width="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                  Margin="0,0,0,0"
                                  Panel.ZIndex="0"
                                  Focusable="False"
                                  IsVerticalLine="True"
                                  Name="PART_VerticalLinePartTwo" Grid.Row="1" SnapsToDevicePixels="True"
                                  LineBrush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                  LineStrokeThickness="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                  Visibility="Visible"
 />
                            </Grid>
                            <Grid Name="HorLineGrid">
                                <tools_controls:TreeRootLine Height="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                              Width="13"
                              Panel.ZIndex="0"
                              Margin="9,0,-3,0"
                              Focusable="False"
                              HorizontalAlignment="Right"
                              IsVerticalLine="False"
                              Name="PART_HorizontalLine" Grid.Row="0" SnapsToDevicePixels="True"
                              LineBrush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                              LineStrokeThickness="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
 />
                            </Grid>
                            <tools_controls:BottomLine Name="BottomBorder"
                                 Grid.Column="0"
                                 Grid.Row="0"
                                 TargetItem="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                 Fill="{StaticResource ContentBackgroundBrush}"
                                 SnapsToDevicePixels="True"
                                 Margin="0,0,0,1" />

                            <tools_controls:SelectRectangle Name="PART_SelectRectangle"
                                 Grid.Column="0"
                                 Grid.Row="0"
                                 TargetItem="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                 Fill="{StaticResource ContentBackgroundBrush}"
                                 SnapsToDevicePixels="True"
                                 Margin="0,0,0,1" />
                            <Expander Name="PART_Expander"
                              Height="13"
					          Grid.Column="0"
                              Background="{Binding Path=Background, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}"
					          Grid.Row="0" Panel.ZIndex="100"
                              Margin="1,0,0,0"
					          HorizontalAlignment="Center"
					          Focusable="False"
					          IsExpanded="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
					          Style="{TemplateBinding tools_controls:TreeViewAdv.ExpanderStyle}" />

                            <Ellipse x:Name="path" Stretch="Fill" Grid.Row="0" Panel.ZIndex="100" HorizontalAlignment="Center"  VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5" Margin="1,0,0,0"   Grid.Column="0"  Width="12" Height="12" Visibility="Collapsed"
                                     StrokeThickness="2" Fill="{StaticResource GlyphBrush}" Stroke="{StaticResource GlyphBrush}"
>
                                <Ellipse.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform />
                                        <SkewTransform />
                                        <RotateTransform Angle="-180" />
                                        <TranslateTransform />
                                    </TransformGroup>
                                </Ellipse.RenderTransform>
                              <!--  <Ellipse.Stroke>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFEBF0F4" Offset="0.378" />
                                        <GradientStop Color="#FF119EDA" Offset="1" />
                                    </LinearGradientBrush>
                                </Ellipse.Stroke> -->
                            </Ellipse>

                            <!--<Path x:Name="path" Stretch="Fill" Fill="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"  Grid.Row="0" Panel.ZIndex="100"
                              Margin="1,0,0,0"   Grid.Column="0"  Width="12" Height="10" Visibility="Collapsed"
		                            Data="F1 M 393.948,266.865C 394.242,265.891 394.417,264.866 394.417,263.797C 394.417,257.906 389.642,253.13 383.751,253.13C 377.859,253.13 373.084,257.906 373.084,263.797C 373.084,267.029 374.527,269.918 376.796,271.874L 377.853,269.536C 376.41,268.053 375.517,266.031 375.517,263.797C 375.517,259.25 379.203,255.564 383.751,255.564C 388.299,255.564 391.984,259.25 391.984,263.797C 391.984,264.562 391.845,265.289 391.647,265.992L 388.376,264.753L 389.587,267.999L 390.799,271.247L 393.858,269.618L 396.917,267.989L 393.948,266.865 Z "
                                      HorizontalAlignment="Center"  VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5">
                                <Path.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform />
                                        <SkewTransform />
                                        <RotateTransform />
                                        <TranslateTransform />
                                    </TransformGroup>
                                </Path.RenderTransform>
                            </Path>-->

                            <Grid Grid.Column="1" Margin="3,0,0,0" Grid.Row="0" Panel.ZIndex="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Name="PART_CompleteHeader" Orientation="Horizontal">
                                    <StackPanel Name="PART_ImagePanel" Orientation="Horizontal">
                                        <Image Name="ExpanderImage"
						               Focusable="False"
						               Source="{TemplateBinding ExpandedImageSource}"
						               Stretch="{TemplateBinding ImageStretch}"
						               Width="{TemplateBinding ImageWidth}"
						               Height="{TemplateBinding ImageHeight}" Visibility="Collapsed"
 />

                                        <Image Name="CollapsedImage"
						               Focusable="False"
						               Source="{TemplateBinding CollapsedImageSource}"
						               Stretch="{TemplateBinding ImageStretch}"
						               Width="{TemplateBinding ImageWidth}"
						               Height="{TemplateBinding ImageHeight}"
 />
                                        <Image Name="LeftImage"
						               Focusable="False"
						               Margin="2,0,0,0"
						               Source="{TemplateBinding LeftImageSource}"
						               Stretch="{TemplateBinding ImageStretch}"
						               Width="{TemplateBinding ImageWidth}"
						               Height="{TemplateBinding ImageHeight}"
 />
                                    </StackPanel>

                                    <StackPanel Name="PART_ItemContent"
                                        VerticalAlignment="Center"
                                        Focusable="True"
                                        KeyboardNavigation.TabNavigation="Cycle">
                                        <Border Name="Bd"
                                        ToolTip="{TemplateBinding tools_controls:TreeViewItemAdv.Header}"
                                        ToolTipService.IsEnabled="False"
                                        ToolTipService.Placement="Center"
                                        ToolTipService.HorizontalOffset="4"
                                        ToolTipService.VerticalOffset="2"
                                        Background="{TemplateBinding Panel.Background}"
                                        TextElement.Foreground="{TemplateBinding Foreground}"
                                        BorderBrush="{TemplateBinding BorderBrush}" Margin="0,1,0,1"
                                        Padding="{TemplateBinding Padding}"
                                        CornerRadius="0"
                                        BorderThickness="1"
                                        SnapsToDevicePixels="True"
                                        MinHeight="19">
                                            <Grid>
                                                <ContentPresenter Name="PART_Header"
										  Visibility="Visible" Margin="{TemplateBinding Padding}"
										  HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
										  VerticalAlignment="Center"
										  ContentSource="Header"
										  Content="{TemplateBinding tools_controls:TreeViewItemAdv.Header}"
										  ContentTemplate="{TemplateBinding tools_controls:TreeViewItemAdv.HeaderTemplate}"
										  ContentTemplateSelector="{TemplateBinding tools_controls:TreeViewItemAdv.HeaderTemplateSelector}" />
                                                <ContentPresenter x:Name="LoadingContentPresenter"
                                                      HorizontalAlignment="Left"
                                                      Content="{TemplateBinding LoadingHeader}"
                                                      ContentTemplate="{TemplateBinding LoadingHeaderTemplate}" Visibility="Collapsed" />
                                            </Grid>
                                        </Border>

                                        <ContentPresenter Name="PART_EditHeader"
                                                      Visibility="Collapsed"
                                                      HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
                                                      VerticalAlignment="Center"
                                                      ContentSource="Header"
                                                      Content="{Binding Path=Header, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                                        ContentTemplate="{Binding Path=EditedItemTemplate, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}"
														ContentTemplateSelector="{Binding Path=EditedItemTemplateSelector, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}"
 />
                                    </StackPanel>

                                    <Image Name="RightImage"
                                       Focusable="False"
					                   Margin="3,0,3,0"
					                   Source="{TemplateBinding RightImageSource}"
                                       Stretch="{TemplateBinding ImageStretch}"
                                       Width="{TemplateBinding ImageWidth}"
                                       Height="{TemplateBinding ImageHeight}" />
                                </StackPanel>
                            </Grid>

                            <Grid Grid.Column="1" Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <ItemsPresenter Name="PART_ItemsHost" Visibility="Collapsed" />
                            </Grid>
                        </Grid>
                        <Border Grid.Row="2" Background="{StaticResource BackgroundBrush}" Height="2" Name="Part_BottomDragLine" Visibility="Collapsed" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="true">
                            <Setter Property="FontSize"  Value="18" />
                            <Setter Property="Padding" Value="12,5,12,5" />
                            <Setter Property="Fill" TargetName="BottomBorder" Value="{Binding Path=BorderBrush,RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter TargetName="PART_Expander" Property="Margin" Value="1,0,0,0" />
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.IsShowToolTip" Value="True">
                            <Setter Property="ToolTipService.IsEnabled" TargetName="Bd" Value="True" />
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.LeftImageSource" Value="{x:Null}">
                            <Setter TargetName="LeftImage" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.RightImageSource" Value="{x:Null}">
                            <Setter TargetName="RightImage" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="True">
                            <Setter TargetName="ExpanderImage" Property="Source" Value="{Binding Path=ExpandedImageSource, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="CollapsedImage" Property="Visibility"  Value="Collapsed" />
                            <Setter TargetName="ExpanderImage" Property="Visibility"  Value="Visible" />
                            <Setter TargetName="PART_ItemsHost" Property="Visibility"  Value="Visible" />
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="False">
                            <Setter TargetName="CollapsedImage" Property="Source" Value="{Binding Path=CollapsedImageSource, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ExpanderImage" Property="Visibility"  Value="Collapsed" />
                            <Setter TargetName="CollapsedImage" Property="Visibility"  Value="Visible" />
                            <Setter TargetName="PART_ItemsHost" Property="Visibility"  Value="Collapsed" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="True" />
                                <Condition Property="tools_controls:TreeViewItemAdv.ExpandedImageSource" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="ExpanderImage" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="LeftImage" Property="Margin" Value="0,0,2,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="False" />
                                <Condition Property="tools_controls:TreeViewItemAdv.CollapsedImageSource" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="CollapsedImage" Property="Visibility" Value="Collapsed" />
                            <Setter TargetName="LeftImage" Property="Margin" Value="0,0,2,0" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="True" />
                                <Condition Property="tools_controls:TreeViewItemAdv.ExpandedImageSource" Value="{x:Null}" />
                                <Condition Property="tools_controls:TreeViewItemAdv.LeftImageSource" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_ImagePanel" Property="Visibility" Value="Collapsed" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="False" />
                                <Condition Property="tools_controls:TreeViewItemAdv.CollapsedImageSource" Value="{x:Null}" />
                                <Condition Property="tools_controls:TreeViewItemAdv.LeftImageSource" Value="{x:Null}" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_ImagePanel" Property="Visibility" Value="Collapsed" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsEditable" Value="True" />
                                <Condition Property="tools_controls:TreeViewItemAdv.IsInEditMode" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility" TargetName="PART_Header" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="Bd" Value="Collapsed" />
                            <Setter Property="Visibility" TargetName="PART_EditHeader" Value="Visible" />
                        </MultiTrigger>
                        <Trigger Property="tools_controls:TreeViewAdv.ShowRootLines" Value="False">
                            <Setter Property="Visibility" TargetName="HorLineGrid" Value="Hidden" />
                            <Setter Property="Visibility" TargetName="VertLineGrid" Value="Hidden" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.HasItems" Value="False" />
                                <Condition Property="tools_controls:TreeViewItemAdv.IsLoadOnDemand" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Visibility" TargetName="PART_Expander" Value="Hidden" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HeaderedContentControl.HasHeader" Value="False" />
                                <Condition Property="FrameworkElement.Width" Value="NaN" />
                            </MultiTrigger.Conditions>
                            <Setter Property="FrameworkElement.MinWidth" TargetName="PART_Header" Value="75" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="HeaderedContentControl.HasHeader" Value="False" />
                                <Condition Property="FrameworkElement.Height" Value="NaN" />
                            </MultiTrigger.Conditions>
                            <Setter Property="FrameworkElement.MinHeight" TargetName="PART_Header" Value="19" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" SourceName="PART_CompleteHeader" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                            </MultiTrigger.Conditions>

                            <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=MouseOverBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=MouseOverForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="BorderBrush" TargetName="Bd" Value="{Binding Path=MouseOverBorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" SourceName="PART_CompleteHeader" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                            </MultiTrigger.Conditions>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Panel.Background" TargetName="Bd" Value="{DynamicResource ActiveBackgroundBrush}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{Binding Path=SelectedBorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Fill" TargetName="PART_SelectRectangle" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{Binding Path=SelectedBorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelectedFalse" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelectedFalse" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Fill" TargetName="PART_SelectRectangle" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsDragOver" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=MouseOverBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=MouseOverForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsDragOver" Value="True" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Fill" TargetName="PART_SelectRectangle" Value="{Binding Path=MouseOverBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=MouseOverForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelectionActive" Value="False" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                                <Condition Property="Selector.IsSelectionActive" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Bd" Property="Panel.Background" Value="{DynamicResource SelectionInActiveBrush}" />
                            <Setter TargetName="Bd" Property="Opacity" Value="0.75" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                <Condition Property="tools_controls:TreeViewItemAdv.IsSelectionActive" Value="False" />
                                <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                                <Condition Property="Selector.IsSelectionActive" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_SelectRectangle" Property="Fill" Value="{Binding Path=SelectionUnfocussedBackcolor, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                            <Setter TargetName="Bd" Property="Opacity" Value="0.75" />
                            <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                        </MultiTrigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.IsDraging" Value="True">
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=MouseOverForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                        </Trigger>
                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <!--<Setter Property="Fill" TargetName="path" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />-->
                            <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            <Setter Property="Opacity" TargetName="RightImage" Value="0.7" />
                            <Setter Property="Opacity" TargetName="LeftImage" Value="0.7" />
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.IsLoadOnDemand" Value="True">
                            <Setter Property="Visibility" TargetName="PART_Expander" Value="Visible" />
                        </Trigger>

                        <Trigger Property="tools_controls:TreeViewItemAdv.IsLoading" Value="True">
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_Expander" />
                            <Setter Property="Visibility" Value="Visible" TargetName="LoadingContentPresenter" />
                            <Setter Property="Visibility" Value="Collapsed" TargetName="PART_Header" />
                            <Setter Property="Visibility" Value="Visible" TargetName="path" />
                            <Trigger.EnterActions>
                                <BeginStoryboard x:Name="beginLoadOnDemandStoryBoard" Storyboard="{StaticResource loadOnDemandStoryBoard}">
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                        </Trigger>
                        <Trigger Property="tools_controls:TreeViewItemAdv.IsLoading" Value="False">
                            <Trigger.ExitActions>
                                <StopStoryboard BeginStoryboardName="beginLoadOnDemandStoryBoard" />
                            </Trigger.ExitActions>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>

            <Trigger Property="MultiColumnEnable" Value="True">
                <Setter Property="Control.Padding" Value="0,0,0,0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools_controls:TreeViewItemAdv}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Border Grid.Row="0" Background="{StaticResource BackgroundBrush}" Height="2" Name="Part_TopDragLine" Visibility="Collapsed" />
                                <Grid Focusable="False" Background="{StaticResource ContentBackgroundBrush}" Grid.Row="1"
			                    TextElement.Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <Grid Grid.Row="0" Grid.RowSpan="2" Name="VertLineGrid">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"></RowDefinition>
                                            <RowDefinition Height="*"></RowDefinition>
                                        </Grid.RowDefinitions>

                                        <tools_controls:TreeRootLine Width="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          Margin="0,0,0,0"
                                          Panel.ZIndex="0"
                                          Focusable="False" IsVerticalLine="True"
                                          Name="PART_VerticalLinePartOne" Grid.Row="0" SnapsToDevicePixels="True"
                                          LineBrush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          LineStrokeThickness="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          Visibility="Visible"
 />
                                        <tools_controls:TreeRootLine Width="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          Margin="0,0,0,0"
                                          Panel.ZIndex="0"
                                          Focusable="False"
                                          IsVerticalLine="True"
                                          Name="PART_VerticalLinePartTwo" Grid.Row="1" SnapsToDevicePixels="True"
                                          LineBrush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          LineStrokeThickness="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          Visibility="Visible"
 />
                                    </Grid>
                                    <Grid Name="HorLineGrid">

                                        <tools_controls:TreeRootLine Height="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          Width="13"
                                          Panel.ZIndex="0"
                                          Margin="9,0,-3,0"
                                          Focusable="False"
                                          HorizontalAlignment="Right"
                                          IsVerticalLine="False"
                                          Name="PART_HorizontalLine" Grid.Row="0" SnapsToDevicePixels="True"
                                          LineBrush="{Binding Path=LineBrush, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"

                                          LineStrokeThickness="{Binding Path=LineStrokeThickness, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}"
                                          Visibility="Visible"
 />
                                    </Grid>
                                    <tools_controls:BottomLine Name="BottomBorder"
                                 Grid.Column="0"
                                 Grid.Row="0"
                                 TargetItem="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                 Fill="{StaticResource ContentBackgroundBrush}"
                                 SnapsToDevicePixels="True"
                                 Margin="0,0,0,1" />

                                    <tools_controls:SelectRectangle Name="PART_SelectRectangle"
                                 Grid.Column="0"
                                 Grid.Row="0"
                                 TargetItem="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                 Fill="{StaticResource ContentBackgroundBrush}"
                                 SnapsToDevicePixels="True"
                                 Margin="0,0,0,1" />
                                    <Expander Name="PART_Expander"
					                  Grid.Column="0" Panel.ZIndex="100"
					                  Grid.Row="0"
                                      Margin="0"
					                  HorizontalAlignment="Center"
                                      Background="{Binding Path=Background, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}"
					                  Focusable="False"
					                  IsExpanded="{Binding Path=IsExpanded, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
					                  Style="{TemplateBinding tools_controls:TreeViewAdv.ExpanderStyle}" />

                                    <Grid Grid.Column="1" Grid.Row="0" Panel.ZIndex="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Name="PART_CompleteHeader" Orientation="Horizontal">
                                            <StackPanel Name="PART_ImagePanel" Margin="5,0,1,0" Orientation="Horizontal">
                                                <Image Name="ExpanderImage"
						               Focusable="False"
						               Source="{TemplateBinding ExpandedImageSource}"
						               Stretch="{TemplateBinding ImageStretch}"
						               Width="{TemplateBinding ImageWidth}"
						               Height="{TemplateBinding ImageHeight}" Visibility="Collapsed"
 />

                                                <Image Name="CollapsedImage"
						               Focusable="False"
						               Source="{TemplateBinding CollapsedImageSource}"
						               Stretch="{TemplateBinding ImageStretch}"
						               Width="{TemplateBinding ImageWidth}"
						               Height="{TemplateBinding ImageHeight}"
 />

                                                <Image Name="LeftImage"
						                           Focusable="False"
						                           Margin="2,0,0,0"
						                           Source="{TemplateBinding LeftImageSource}"
						                           Stretch="{TemplateBinding ImageStretch}"
						                           Width="{TemplateBinding ImageWidth}"
						                           Height="{TemplateBinding ImageHeight}"
 />
                                            </StackPanel>

                                            <Border Name="Bd"
                                            ToolTip="{TemplateBinding tools_controls:TreeViewItemAdv.Header}"
                                            ToolTipService.IsEnabled="False"
                                            ToolTipService.Placement="Center"
                                            ToolTipService.HorizontalOffset="4"
                                            ToolTipService.VerticalOffset="2"
                                            BorderBrush="{Binding Path=BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                            Background="{Binding Path=Background, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                            Padding="{Binding Path=Padding, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                            TextElement.Foreground="{TemplateBinding Foreground}"
                                            BorderThickness="0"
                                            SnapsToDevicePixels="True"
                                            MinHeight="19" CornerRadius="0"
                                            ClipToBounds="True">
                                                <StackPanel VerticalAlignment="Center"
                                                Focusable="True"
                                                KeyboardNavigation.TabNavigation="Cycle"
                                                Margin="1.5,0,-5,0">
                                                    <ContentControl Name="PART_Header"
                                                                    ContentTemplate="{Binding Path=HeaderTemplate, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                                                    ContentTemplateSelector="{Binding Path=HeaderTemplateSelector, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}">
                                                        <ContentControl.Content>
                                                            <tools_controls:TreeViewRowPresenter Name="PART_RowPresenter"
                                                              Margin="-1,1,1,1"
                                                              Content="{TemplateBinding tools_controls:TreeViewItemAdv.Header}"
                                                              Columns="{Binding Path=WrappedColumns, RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}">
                                                            </tools_controls:TreeViewRowPresenter>
                                                        </ContentControl.Content>
                                                    </ContentControl>

                                                    <ContentPresenter Name="PART_EditHeader"
                                                      Visibility="Collapsed"
                                                      HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
                                                      VerticalAlignment="Center"
                                                      ContentSource="Header"
                                                      Content="{Binding Path=Header, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewItemAdv}}}"
                                                        ContentTemplate="{Binding Path=EditedItemTemplate, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}"
														ContentTemplateSelector="{Binding Path=EditedItemTemplateSelector, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}"
 />
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Grid>

                                    <Grid Grid.Column="1" Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <ItemsPresenter Name="PART_ItemsHost" Visibility="Collapsed" />
                                    </Grid>
                                </Grid>
                                <Border Grid.Row="2" Background="{StaticResource BackgroundBrush}" Height="2" Name="Part_BottomDragLine" Visibility="Collapsed" />
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="true">
                                    <Setter Property="FontSize"  Value="18" />
                                    <Setter Property="Padding" Value="12,9.5,12,9.5" />
                                    <Setter Property="Fill" TargetName="BottomBorder" Value="{Binding Path=BorderBrush,RelativeSource={RelativeSource AncestorType={x:Type tools_controls:TreeViewAdv}}}" />

                                </Trigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.LeftImageSource" Value="{x:Null}">
                                    <Setter TargetName="LeftImage" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="True">
                                    <Setter TargetName="ExpanderImage" Property="Source" Value="{Binding Path=ExpandedImageSource, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter TargetName="CollapsedImage" Property="Visibility"  Value="Collapsed" />
                                    <Setter TargetName="ExpanderImage" Property="Visibility"  Value="Visible" />
                                    <Setter TargetName="PART_ItemsHost" Property="Visibility"  Value="Visible" />
                                </Trigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="False">
                                    <Setter TargetName="CollapsedImage" Property="Source" Value="{Binding Path=CollapsedImageSource, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter TargetName="ExpanderImage" Property="Visibility"  Value="Collapsed" />
                                    <Setter TargetName="CollapsedImage" Property="Visibility"  Value="Visible" />
                                    <Setter TargetName="PART_ItemsHost" Property="Visibility"  Value="Collapsed" />
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="True" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.ExpandedImageSource" Value="{x:Null}" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="ExpanderImage" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="LeftImage" Property="Margin" Value="0,0,2,0" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="False" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.CollapsedImageSource" Value="{x:Null}" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="CollapsedImage" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="LeftImage" Property="Margin" Value="0,0,2,0" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="True" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.ExpandedImageSource" Value="{x:Null}" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.LeftImageSource" Value="{x:Null}" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_ImagePanel" Property="Visibility" Value="Collapsed" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsExpanded" Value="False" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.CollapsedImageSource" Value="{x:Null}" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.LeftImageSource" Value="{x:Null}" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_ImagePanel" Property="Visibility" Value="Collapsed" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsEditable" Value="True" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsInEditMode" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Visibility" TargetName="PART_Header" Value="Collapsed" />
                                    <Setter Property="Visibility" TargetName="PART_EditHeader" Value="Visible" />
                                </MultiTrigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.IsShowToolTip" Value="True">
                                    <Setter Property="ToolTipService.IsEnabled" TargetName="Bd" Value="True" />
                                </Trigger>
                                <Trigger Property="tools_controls:TreeViewAdv.ShowRootLines" Value="False">
                                    <Setter Property="Visibility" TargetName="HorLineGrid" Value="Hidden" />
                                    <Setter Property="Visibility" TargetName="VertLineGrid" Value="Hidden" />
                                </Trigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.HasItems" Value="False">
                                    <Setter Property="Visibility" TargetName="PART_Expander" Value="Hidden" />
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" SourceName="PART_Header" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                                    </MultiTrigger.Conditions>

                                    <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=MouseOverBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=MouseOverForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="BorderBrush" TargetName="Bd" Value="{Binding Path=MouseOverBorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" SourceName="PART_Header" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                                    </MultiTrigger.Conditions>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{Binding Path=SelectedBorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />-->
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Fill" TargetName="PART_SelectRectangle" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{Binding Path=SelectedBorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />-->
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelectedFalse" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                                    </MultiTrigger.Conditions>

                                    <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelectedFalse" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                                    </MultiTrigger.Conditions>

                                    <Setter Property="Fill" TargetName="PART_SelectRectangle" Value="{Binding Path=SelectedBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                                </MultiTrigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.IsDragOver" Value="True">
                                    <Setter Property="Panel.Background" TargetName="Bd" Value="{Binding Path=MouseOverBackground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=MouseOverForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="false" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelectionActive" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="Bd" Property="Panel.Background" Value="{Binding Path=SelectionUnfocussedBackcolor, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter TargetName="Bd" Property="Opacity" Value="0.75" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelected" Value="True" />
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="true" />
                                        <Condition Property="tools_controls:TreeViewItemAdv.IsSelectionActive" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_SelectRectangle" Property="Fill" Value="{Binding Path=SelectionUnfocussedBackcolor, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                    <Setter TargetName="Bd" Property="Opacity" Value="0.75" />
                                    <!--<Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Metro_TreeViewAdv_SelectedBorderBrush}" />-->
                                </MultiTrigger>
                                <Trigger Property="tools_controls:TreeViewItemAdv.IsDraging" Value="True">
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{Binding Path=SelectedForeground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewAdv}}}" />
                                </Trigger>
                                <Trigger Property="UIElement.IsEnabled" Value="False">
                                    <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource MetroTreeViewItemAdvStyle}" TargetType="{x:Type tools_controls:TreeViewItemAdv}" />

    <!-- Style for DragMarker -->
    <Style x:Key="{x:Type tools_controls:TreeViewItemAdvDragMarkerAdornerrInternalControl}" TargetType="{x:Type tools_controls:TreeViewItemAdvDragMarkerAdornerrInternalControl}">
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools_controls:TreeViewItemAdvDragMarkerAdornerrInternalControl}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Rectangle Grid.Column="0"
                               Height="2"
                               Fill="{StaticResource GlyphBrush}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for ColumnHeader drag marker -->
    <Style x:Key="{x:Type tools_controls:TreeViewRowDragMarkerTemplatedAdornerInternalControl}" TargetType="{x:Type tools_controls:TreeViewRowDragMarkerTemplatedAdornerInternalControl}">
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate
                     TargetType="{x:Type tools_controls:TreeViewRowDragMarkerTemplatedAdornerInternalControl}">
                    <Grid>
                        <Rectangle Grid.Column="0"
                       Width="2"
                       Fill="{StaticResource HeaderGlyphBrush}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for ColumnHeader header marker -->
    <Style x:Key="{x:Type tools_controls:TreeViewColumnHeaderTemplatedAdornerInternalControl}" TargetType="{x:Type tools_controls:TreeViewColumnHeaderTemplatedAdornerInternalControl}">
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="SnapsToDevicePixels" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate
                     TargetType="{x:Type tools_controls:TreeViewColumnHeaderTemplatedAdornerInternalControl}">
                    <Grid>
                        <Border Grid.Column="0"
                            BorderThickness="1"
                            Background="{StaticResource HeaderBackgroundBrush}"
                            BorderBrush="{StaticResource HeaderBorderBrush}">
                            <TextBlock HorizontalAlignment="Center"
                           Text="{Binding Path=Header, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools_controls:TreeViewColumn}}}" />
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
